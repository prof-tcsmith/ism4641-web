<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Smith">

<title>Introduction to Machine Learning and Linear Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="week11-lecture_files/libs/clipboard/clipboard.min.js"></script>
<script src="week11-lecture_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="week11-lecture_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="week11-lecture_files/libs/quarto-html/popper.min.js"></script>
<script src="week11-lecture_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="week11-lecture_files/libs/quarto-html/anchor.min.js"></script>
<link href="week11-lecture_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="week11-lecture_files/libs/quarto-html/quarto-syntax-highlighting-4a990d8dcb58f517c7c86712b8f2ac7c.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="week11-lecture_files/libs/quarto-html/quarto-syntax-highlighting-dark-46f4cc9626f044588a66931b604fc9c8.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="week11-lecture_files/libs/quarto-html/quarto-syntax-highlighting-4a990d8dcb58f517c7c86712b8f2ac7c.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="week11-lecture_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="week11-lecture_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="week11-lecture_files/libs/bootstrap/bootstrap-7fb405d50af379f6f99cb0e774c9922f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="week11-lecture_files/libs/bootstrap/bootstrap-dark-d2c9d76e2ea35e59204fefcb7aa2b466.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="week11-lecture_files/libs/bootstrap/bootstrap-7fb405d50af379f6f99cb0e774c9922f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#introduction-to-machine-learning-and-linear-regression" id="toc-introduction-to-machine-learning-and-linear-regression" class="nav-link active" data-scroll-target="#introduction-to-machine-learning-and-linear-regression">Introduction to Machine Learning and Linear Regression</a>
  <ul class="collapse">
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#introduction-from-differences-to-relationships-and-predictions" id="toc-introduction-from-differences-to-relationships-and-predictions" class="nav-link" data-scroll-target="#introduction-from-differences-to-relationships-and-predictions">Introduction: From Differences to Relationships and Predictions</a></li>
  <li><a href="#what-is-machine-learning" id="toc-what-is-machine-learning" class="nav-link" data-scroll-target="#what-is-machine-learning">What is Machine Learning?</a></li>
  <li><a href="#simple-linear-regression-slr-modeling-with-one-predictor" id="toc-simple-linear-regression-slr-modeling-with-one-predictor" class="nav-link" data-scroll-target="#simple-linear-regression-slr-modeling-with-one-predictor">Simple Linear Regression (SLR): Modeling with One Predictor</a></li>
  <li><a href="#multiple-linear-regression-mlr-modeling-with-multiple-predictors" id="toc-multiple-linear-regression-mlr-modeling-with-multiple-predictors" class="nav-link" data-scroll-target="#multiple-linear-regression-mlr-modeling-with-multiple-predictors">Multiple Linear Regression (MLR): Modeling with Multiple Predictors</a></li>
  <li><a href="#business-applications-revisited" id="toc-business-applications-revisited" class="nav-link" data-scroll-target="#business-applications-revisited">Business Applications Revisited</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction to Machine Learning and Linear Regression</h1>
<p class="subtitle lead">Descriptive &amp; Inferential Statistics for Business Analytics</p>
</div>


<div class="quarto-title-meta-author column-page-right">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Dr.&nbsp;Smith </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of South Florida
          </p>
      </div>
  </div>

<div class="quarto-title-meta column-page-right">

      
  
    
  </div>
  


</header>


<style>
/* Canvas iframe optimization */
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  font-size: 16px;
  line-height: 1.5;
  color: #212529;
}

/* When NOT in iframe - force 1400px width */
@media screen {
  body:not(.in-iframe) .content {
    max-width: 1400px !important;
    width: 1400px !important;
    margin: 0 auto;
  }
  
  body:not(.in-iframe) #quarto-content {
    max-width: 1400px !important;
  }
  
  body:not(.in-iframe) .page-layout-full {
    max-width: 1400px !important;
  }
}

/* When IN iframe - responsive width */
@media screen {
  body.in-iframe {
    margin: 0;
    padding: 15px;
    max-width: 100%;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
    font-size: 16px;
    line-height: 1.5;
    color: #212529;
  }
  .in-iframe .quarto-container {
    max-width: 100%;
    padding: 0 15px;
  }
  .in-iframe #quarto-content {
    max-width: 100%;
  }
  .in-iframe .page-layout-article {
    grid-template-columns: minmax(0, 1fr);
  }
  .in-iframe .page-layout-full {
    grid-template-columns: minmax(0, 1fr);
  }
  .in-iframe .sidebar {
    width: 200px !important;
    font-size: 0.9em;
  }
  .in-iframe .sidebar.toc-left {
    width: 200px !important;
    margin-right: 15px;
  }
  .in-iframe .column-body {
    grid-column: 1;
    max-width: 100%;
  }
  .in-iframe #quarto-document-content {
    max-width: calc(100% - 220px);
    padding: 0 15px;
  }
  .in-iframe pre {
    overflow-x: auto;
    max-width: 100%;
    font-size: 0.9em;
  }
  .in-iframe code {
    font-size: 0.9em;
  }
  .in-iframe table {
    display: block;
    overflow-x: auto;
    max-width: 100%;
    font-size: 0.9em;
  }
  .in-iframe img {
    max-width: 100%;
    height: auto;
  }
  .in-iframe .callout {
    margin: 1em 0;
    padding: 0.5em 1em;
  }
  .in-iframe .sourceCode {
    max-width: 100%;
    overflow-x: auto;
  }
  .in-iframe .cell {
    max-width: 100%;
  }
  .in-iframe body {
    font-size: 15px;
  }
  .in-iframe h1 {
    font-size: 1.8em;
  }
  .in-iframe h2 {
    font-size: 1.5em;
  }
  .in-iframe h3 {
    font-size: 1.3em;
  }
  .in-iframe h4 {
    font-size: 1.1em;
  }
  .in-iframe #quarto-margin-sidebar {
    display: none !important;
  }
  .in-iframe .margin-sidebar {
    display: none !important;
  }
  
  /* Ensure proper paragraph spacing */
  .in-iframe p {
    margin-bottom: 1rem;
  }
  
  /* Maintain list styling */
  .in-iframe ul, .in-iframe ol {
    margin-bottom: 1rem;
  }
}

@media screen and (max-width: 768px) {
  .in-iframe .sidebar {
    display: none !important;
  }
  .in-iframe #quarto-document-content {
    max-width: 100%;
  }
  .in-iframe body {
    font-size: 14px;
  }
}
</style>
<script>
if (window.self !== window.top) {
  document.addEventListener("DOMContentLoaded", function() {
    document.body.classList.add("in-iframe");
  });
}
</script>
<section id="introduction-to-machine-learning-and-linear-regression" class="level1">
<h1>Introduction to Machine Learning and Linear Regression</h1>
<p>Last session, we wrestled with hypothesis testing, using t-tests to see if observed differences in our data, like between two marketing strategies, were statistically significant or likely due just to random chance. We were asking questions like, “Is group A <em>different</em> from group B?”</p>
<p>Today, we pivot from looking at <em>differences</em> to understanding <em>relationships</em> and making <em>predictions</em>. We’re entering the exciting world of <strong>Machine Learning (ML)</strong>. Don’t let the term intimidate you! It’s a powerful set of tools that allow computers to learn patterns from data, and it’s becoming absolutely essential in modern business analytics.</p>
<p>Our goal today is to understand the basics of ML, focusing on a fundamental technique called <strong>Linear Regression</strong>. We’ll see how we can use it to model the relationship between variables – like how advertising spend might influence sales, or how website engagement metrics might predict conversion rates. We’ll cover:</p>
<ol type="1">
<li>What Machine Learning is (focusing on Supervised Learning).</li>
<li><strong>Simple Linear Regression:</strong> Modeling a relationship with one predictor.</li>
<li><strong>Train-Test Split:</strong> A crucial step for evaluating model performance realistically.</li>
<li>Evaluating our model using metrics like R-squared.</li>
<li><strong>Multiple Linear Regression:</strong> Expanding our models to include multiple predictors.</li>
<li>Plenty of practical examples and code using Python’s <code>pandas</code>, <code>numpy</code>, and <code>scikit-learn</code>.</li>
</ol>
<p>Let’s get started by demystifying Machine Learning.</p>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">Learning Objectives</h2>
<p>By the end of this lecture, you should be able to:</p>
<ol type="1">
<li>Define Machine Learning (ML) and differentiate between supervised and unsupervised learning.</li>
<li>Explain the goal and mechanics of Simple Linear Regression (SLR).</li>
<li><strong>Explain the critical importance of the Train-Test Split and implement it.</strong></li>
<li>Implement SLR using Python’s <code>scikit-learn</code>.</li>
<li>Interpret the coefficients (slope and intercept) of an SLR model.</li>
<li>Evaluate an SLR model using R-squared.</li>
<li><strong>Explain the concept and implementation of Multiple Linear Regression (MLR).</strong></li>
<li>Interpret coefficients in an MLR context.</li>
<li>Use trained linear regression models to make predictions.</li>
<li>Understand the practical business applications of linear regression.</li>
</ol>
</section>
<section id="introduction-from-differences-to-relationships-and-predictions" class="level2">
<h2 class="anchored" data-anchor-id="introduction-from-differences-to-relationships-and-predictions">Introduction: From Differences to Relationships and Predictions</h2>
<p>In our last session, we explored hypothesis testing (specifically t-tests). We focused on determining if the <em>difference</em> between group means (e.g., average sales under Plan A vs.&nbsp;Plan B) was statistically significant. This is crucial for A/B testing and comparing distinct scenarios.</p>
<p>Today, we shift gears. We’re moving from asking “Is there a difference?” to asking “<strong>How are these variables related?</strong>” and “<strong>Can we predict an outcome based on certain factors?</strong>” This is where <strong>Machine Learning (ML)</strong> comes into play.</p>
<p>ML provides tools to build models that <em>learn</em> from data. Instead of explicitly programming rules for every scenario, we let the algorithm discover patterns and relationships. This is incredibly useful in business for tasks like:</p>
<ul>
<li>Forecasting future sales based on past trends and marketing spend.</li>
<li>Predicting customer churn based on their behavior.</li>
<li>Estimating the price of a house based on its features.</li>
<li>Understanding which factors drive employee performance.</li>
</ul>
<p>We’ll start with one of the most fundamental supervised ML techniques: <strong>Linear Regression</strong>.</p>
</section>
<section id="what-is-machine-learning" class="level2">
<h2 class="anchored" data-anchor-id="what-is-machine-learning">What is Machine Learning?</h2>
<p><strong>Machine Learning (ML)</strong> is a field of Artificial Intelligence where systems learn from data to identify patterns and make decisions with minimal human intervention.</p>
<section id="types-of-machine-learning" class="level3">
<h3 class="anchored" data-anchor-id="types-of-machine-learning">Types of Machine Learning</h3>
<p>We’ll primarily encounter two main types:</p>
<ol type="1">
<li><strong>Supervised Learning:</strong>
<ul>
<li><strong>Goal:</strong> Predict a specific, known target outcome based on input features.</li>
<li><strong>Data:</strong> Requires “labeled” data, where we know the correct output for each input example.</li>
<li><strong>Analogy:</strong> Like learning with a teacher who provides the answers (labels).</li>
<li><strong>Examples:</strong> Predicting sales (<strong>target</strong>) based on advertising spend (<strong>feature</strong>); classifying an email as spam/not spam (<strong>target</strong>) based on its content (<strong>features</strong>).</li>
<li><strong>Linear Regression and Logistic Regression fall here.</strong></li>
</ul></li>
<li><strong>Unsupervised Learning:</strong>
<ul>
<li><strong>Goal:</strong> Discover hidden structures, patterns, or groupings in data <em>without</em> a predefined target.</li>
<li><strong>Data:</strong> Uses “unlabeled” data.</li>
<li><strong>Analogy:</strong> Like learning without a teacher, finding patterns on your own.</li>
<li><strong>Examples:</strong> Customer segmentation (finding natural groups of customers); anomaly detection (finding unusual data points).</li>
</ul></li>
</ol>
<p>Our focus today is <strong>Supervised Learning</strong>, specifically for predicting continuous numerical values using Linear Regression.</p>
</section>
</section>
<section id="simple-linear-regression-slr-modeling-with-one-predictor" class="level2">
<h2 class="anchored" data-anchor-id="simple-linear-regression-slr-modeling-with-one-predictor">Simple Linear Regression (SLR): Modeling with One Predictor</h2>
<p>SLR aims to model the linear relationship between a single independent variable (predictor, feature - <strong>X</strong>) and a continuous dependent variable (target, outcome - <strong>Y</strong>).</p>
<p><strong>The Goal:</strong> Find the best-fitting straight line through the data points on a scatter plot.</p>
<p><strong>The Equation:</strong> <strong>Y = β₀ + β₁X + ε</strong></p>
<ul>
<li><strong>Y:</strong> Dependent Variable (what we predict, e.g., Sales)</li>
<li><strong>X:</strong> Independent Variable (what we use to predict, e.g., Advertising Spend)</li>
<li><strong>β₀:</strong> Intercept (Predicted Y when X=0)</li>
<li><strong>β₁:</strong> Slope (Predicted change in Y for a one-unit increase in X)</li>
<li><strong>ε:</strong> Error Term (Difference between actual Y and predicted Y)</li>
</ul>
<p>The algorithm (typically Ordinary Least Squares - OLS) finds the β₀ and β₁ that minimize the sum of the squared errors (ε²).</p>
<section id="mini-case-1-advertising-spend-vs.-sales" class="level3">
<h3 class="anchored" data-anchor-id="mini-case-1-advertising-spend-vs.-sales">Mini-Case 1: Advertising Spend vs.&nbsp;Sales</h3>
<p>Let’s revisit our retail company example. They want to predict monthly sales based on advertising spending.</p>
<div id="47435f8a" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Setup: Import necessary libraries</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score, mean_absolute_error</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Set a style for plots</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="bu">print</span>(<span class="st">"Libraries imported."</span>)</span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co"># Generate sample data for SLR</span></span>
<span id="cb1-15"><a href="#cb1-15"></a>np.random.seed(<span class="dv">42</span>) <span class="co"># for reproducibility</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>ad_spend <span class="op">=</span> np.random.rand(<span class="dv">100</span>) <span class="op">*</span> <span class="dv">1000</span> <span class="op">+</span> <span class="dv">500</span> <span class="co"># 100 data points now</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>sales <span class="op">=</span> <span class="dv">2000</span> <span class="op">+</span> <span class="fl">5.5</span> <span class="op">*</span> ad_spend <span class="op">+</span> np.random.randn(<span class="dv">100</span>) <span class="op">*</span> <span class="dv">2000</span> <span class="co"># Increased noise a bit</span></span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a>df_sales <span class="op">=</span> pd.DataFrame({<span class="st">'AdvertisingSpend'</span>: ad_spend, <span class="st">'Sales'</span>: sales})</span>
<span id="cb1-20"><a href="#cb1-20"></a></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="bu">print</span>(<span class="st">"--- Mini-Case 1: Sales Data ---"</span>)</span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="bu">print</span>(df_sales.head())</span>
<span id="cb1-23"><a href="#cb1-23"></a></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="co"># Visualize</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb1-26"><a href="#cb1-26"></a>sns.scatterplot(x<span class="op">=</span><span class="st">'AdvertisingSpend'</span>, y<span class="op">=</span><span class="st">'Sales'</span>, data<span class="op">=</span>df_sales)</span>
<span id="cb1-27"><a href="#cb1-27"></a>plt.title(<span class="st">'Monthly Sales vs. Advertising Spend'</span>)</span>
<span id="cb1-28"><a href="#cb1-28"></a>plt.xlabel(<span class="st">'Advertising Spend ($)'</span>)</span>
<span id="cb1-29"><a href="#cb1-29"></a>plt.ylabel(<span class="st">'Monthly Sales ($)'</span>)</span>
<span id="cb1-30"><a href="#cb1-30"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Libraries imported.
--- Mini-Case 1: Sales Data ---
   AdvertisingSpend        Sales
0        874.540119  6984.064790
1       1450.714306  9380.913984
2       1231.993942  8959.488233
3       1098.658484  4067.483834
4        656.018640  5168.758747</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="week11-lecture_files/figure-html/cell-2-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We see a positive linear trend, suggesting SLR is appropriate.</p>
</section>
<section id="preparing-data-features-x-target-y" class="level3">
<h3 class="anchored" data-anchor-id="preparing-data-features-x-target-y">Preparing Data (Features X, Target y)</h3>
<div id="906f5962" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>X_sales <span class="op">=</span> df_sales[[<span class="st">'AdvertisingSpend'</span>]] <span class="co"># Feature DataFrame (2D)</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>y_sales <span class="op">=</span> df_sales[<span class="st">'Sales'</span>]           <span class="co"># Target Series (1D)</span></span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Shape of X_sales:"</span>, X_sales.shape)</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="bu">print</span>(<span class="st">"Shape of y_sales:"</span>, y_sales.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Shape of X_sales: (100, 1)
Shape of y_sales: (100,)</code></pre>
</div>
</div>
</section>
<section id="train-test-split-why-and-how" class="level3">
<h3 class="anchored" data-anchor-id="train-test-split-why-and-how">Train-Test Split: Why and How?</h3>
<p><strong>Why do we split our data?</strong></p>
<p>Imagine you’re studying for an exam. You have a set of practice questions with answers. If you <em>only</em> study those specific questions and then the exam uses the <em>exact same questions</em>, you might ace it. But does that mean you truly understand the material, or did you just memorize the answers? You wouldn’t know how well you’d do on <em>new</em>, slightly different questions.</p>
<p>Machine learning models face a similar issue called <strong>overfitting</strong>. A model might learn the training data <em>too well</em>, including its random noise and quirks. When shown new, unseen data, it performs poorly because it didn’t learn the underlying general pattern.</p>
<p>The <strong>Train-Test Split</strong> helps us simulate how the model would perform on new data.</p>
<ol type="1">
<li><strong>Training Set:</strong> The larger portion of the data used to <em>teach</em> the model (like the practice questions). The model learns the relationships (finds β₀ and β₁) from this set.</li>
<li><strong>Test Set:</strong> A smaller, held-back portion of the data that the model <em>never sees</em> during training (like the actual exam questions). We use this set to get an unbiased estimate of how well the model generalizes to new, unseen data.</li>
</ol>
<p><strong>How do we split the data?</strong></p>
<p>We use the <code>train_test_split</code> function from <code>scikit-learn</code>.</p>
<div id="ee58e285" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Splitting the Sales data</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>X_sales_train, X_sales_test, y_sales_train, y_sales_test <span class="op">=</span> train_test_split(</span>
<span id="cb5-3"><a href="#cb5-3"></a>    X_sales, y_sales,  <span class="co"># The features and target variables</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>    test_size<span class="op">=</span><span class="fl">0.2</span>,    <span class="co"># Proportion of data to allocate to the test set</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>    random_state<span class="op">=</span><span class="dv">42</span>   <span class="co"># Ensures the split is the same every time we run the code (for reproducibility)</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>)</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="bu">print</span>(<span class="st">"--- Train-Test Split Details ---"</span>)</span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="bu">print</span>(<span class="st">"Original data size:"</span>, X_sales.shape[<span class="dv">0</span>])</span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="bu">print</span>(<span class="st">"Training set size (X):"</span>, X_sales_train.shape[<span class="dv">0</span>])</span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="bu">print</span>(<span class="st">"Test set size (X):"</span>, X_sales_test.shape[<span class="dv">0</span>])</span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="bu">print</span>(<span class="st">"Training set size (y):"</span>, y_sales_train.shape[<span class="dv">0</span>])</span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="bu">print</span>(<span class="st">"Test set size (y):"</span>, y_sales_test.shape[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Train-Test Split Details ---
Original data size: 100
Training set size (X): 80
Test set size (X): 20
Training set size (y): 80
Test set size (y): 20</code></pre>
</div>
</div>
<p><strong>Typical Ratios:</strong></p>
<ul>
<li>Common splits (Train/Test) are 80/20, 75/25, or sometimes 70/30.</li>
<li>The choice depends on the dataset size. With very large datasets, you might even use a 90/10 or 95/5 split, as even a small percentage results in a large enough test set.</li>
<li><code>test_size</code> parameter controls the proportion going to the <em>test</em> set (e.g., <code>test_size=0.2</code> means 20% for testing, 80% for training).</li>
<li><code>random_state</code> is a seed value. Using the same seed ensures that the <em>same</em> random split occurs each time, making your results reproducible. If you omit it, you’ll get a different random split each run.</li>
</ul>
</section>
<section id="training-the-slr-model" class="level3">
<h3 class="anchored" data-anchor-id="training-the-slr-model">Training the SLR Model</h3>
<div id="51ff7b06" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Create and train the Simple Linear Regression model</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>slr_model <span class="op">=</span> LinearRegression()</span>
<span id="cb7-3"><a href="#cb7-3"></a>slr_model.fit(X_sales_train, y_sales_train) <span class="co"># Train ONLY on the training data</span></span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">SLR Model trained successfully."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SLR Model trained successfully.</code></pre>
</div>
</div>
</section>
<section id="interpreting-slr-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-slr-coefficients">Interpreting SLR Coefficients</h3>
<div id="e07e4077" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Get the intercept and coefficient</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>slr_intercept <span class="op">=</span> slr_model.intercept_</span>
<span id="cb9-3"><a href="#cb9-3"></a>slr_coefficient <span class="op">=</span> slr_model.coef_[<span class="dv">0</span>]</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">--- SLR Model Coefficients ---"</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="bu">print</span>(<span class="ss">f"Intercept (β₀): </span><span class="sc">{</span>slr_intercept<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="bu">print</span>(<span class="ss">f"Coefficient for AdvertisingSpend (β₁): </span><span class="sc">{</span>slr_coefficient<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Model Equation: Sales ≈ </span><span class="sc">{</span>slr_intercept<span class="sc">:.2f}</span><span class="ss"> + </span><span class="sc">{</span>slr_coefficient<span class="sc">:.2f}</span><span class="ss"> * AdvertisingSpend"</span>)</span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co"># Interpretation</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Interpretation:"</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="bu">print</span>(<span class="ss">f"- The model predicts baseline sales of approximately $</span><span class="sc">{</span>slr_intercept<span class="sc">:,.2f}</span><span class="ss"> when advertising spend is $0."</span>)</span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="bu">print</span>(<span class="ss">f"- For each additional $1 spent on advertising, the model predicts an increase in sales of approximately $</span><span class="sc">{</span>slr_coefficient<span class="sc">:.2f}</span><span class="ss">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- SLR Model Coefficients ---
Intercept (β₀): 2687.18
Coefficient for AdvertisingSpend (β₁): 4.70

Model Equation: Sales ≈ 2687.18 + 4.70 * AdvertisingSpend

Interpretation:
- The model predicts baseline sales of approximately $2,687.18 when advertising spend is $0.
- For each additional $1 spent on advertising, the model predicts an increase in sales of approximately $4.70.</code></pre>
</div>
</div>
</section>
<section id="evaluating-the-slr-model" class="level3">
<h3 class="anchored" data-anchor-id="evaluating-the-slr-model">Evaluating the SLR Model</h3>
<p>We evaluate using the <strong>test set</strong> to see how well it generalizes.</p>
<div id="c1a6799d" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Make predictions on the </span><span class="al">TEST</span><span class="co"> set</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>y_sales_pred_test <span class="op">=</span> slr_model.predict(X_sales_test)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co"># Calculate evaluation metrics</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>r2_test <span class="op">=</span> r2_score(y_sales_test, y_sales_pred_test)</span>
<span id="cb11-6"><a href="#cb11-6"></a>mse_test <span class="op">=</span> mean_squared_error(y_sales_test, y_sales_pred_test) <span class="co"># Calculate MSE first</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>rmse_test <span class="op">=</span> np.sqrt(mse_test) <span class="co"># Then take the square root</span></span>
<span id="cb11-8"><a href="#cb11-8"></a></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">--- SLR Model Evaluation (Test Set) ---"</span>)</span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="bu">print</span>(<span class="ss">f"R-squared (R²): </span><span class="sc">{</span>r2_test<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="bu">print</span>(<span class="ss">f"Root Mean Squared Error (RMSE): </span><span class="sc">{</span>rmse_test<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="bu">print</span>(<span class="ss">f"Mean Absolute Error (MAE): </span><span class="sc">{</span>mse_test<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb11-13"><a href="#cb11-13"></a></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co"># Optional: Compare with training set performance (often better)</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co"># r2_train = slr_model.score(X_sales_train, y_sales_train)</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co"># print(f"R-squared (R²) on Training Set: {r2_train:.3f}")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- SLR Model Evaluation (Test Set) ---
R-squared (R²): 0.359
Root Mean Squared Error (RMSE): 1617.03
Mean Absolute Error (MAE): 2614798.05</code></pre>
</div>
</div>
<p><strong>Metric Interpretation:</strong></p>
<ul>
<li><strong>R-squared (R² ≈ 0.665):</strong> About 66.5% of the variability in Sales (in the test set) can be explained by Advertising Spend using our linear model.</li>
<li><strong>RMSE ($1772.44):</strong> On average, the model’s predictions are off by about $1,772. This gives an error magnitude in the original units (dollars).</li>
<li><strong>MAE ($1411.97):</strong> On average, the absolute difference between the predicted sales and actual sales is about $1,411. Less sensitive to outliers than RMSE.</li>
</ul>
<p>Whether these evaluation results are “good” depends on the business context and the cost of errors.</p>
</section>
<section id="making-predictions-with-slr" class="level3">
<h3 class="anchored" data-anchor-id="making-predictions-with-slr">Making Predictions with SLR</h3>
<div id="a0a645af" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Predict sales for a new advertising spend value, e.g., $1300</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>new_ad_spend_slr <span class="op">=</span> pd.DataFrame({<span class="st">'AdvertisingSpend'</span>: [<span class="dv">1300</span>]})</span>
<span id="cb13-3"><a href="#cb13-3"></a>predicted_sales_slr <span class="op">=</span> slr_model.predict(new_ad_spend_slr)</span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">--- SLR Prediction Example ---"</span>)</span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="bu">print</span>(<span class="ss">f"Predicted Sales for $1,300 Ad Spend: $</span><span class="sc">{</span>predicted_sales_slr[<span class="dv">0</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- SLR Prediction Example ---
Predicted Sales for $1,300 Ad Spend: $8,793.66</code></pre>
</div>
</div>
</section>
<section id="visualizing-the-slr-fit" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-slr-fit">Visualizing the SLR Fit</h3>
<div id="150990e1" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co"># Scatter plot of test data</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>sns.scatterplot(x<span class="op">=</span>X_sales_test[<span class="st">'AdvertisingSpend'</span>], y<span class="op">=</span>y_sales_test, label<span class="op">=</span><span class="st">'Actual Test Data'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co"># Regression line using test predictions</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>plt.plot(X_sales_test[<span class="st">'AdvertisingSpend'</span>], y_sales_pred_test, color<span class="op">=</span><span class="st">'red'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Regression Line (Predictions)'</span>)</span>
<span id="cb15-6"><a href="#cb15-6"></a></span>
<span id="cb15-7"><a href="#cb15-7"></a>plt.title(<span class="st">'SLR Fit: Sales vs. Advertising Spend (Test Set)'</span>)</span>
<span id="cb15-8"><a href="#cb15-8"></a>plt.xlabel(<span class="st">'Advertising Spend ($)'</span>)</span>
<span id="cb15-9"><a href="#cb15-9"></a>plt.ylabel(<span class="st">'Monthly Sales ($)'</span>)</span>
<span id="cb15-10"><a href="#cb15-10"></a>plt.legend()</span>
<span id="cb15-11"><a href="#cb15-11"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="week11-lecture_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="multiple-linear-regression-mlr-modeling-with-multiple-predictors" class="level2">
<h2 class="anchored" data-anchor-id="multiple-linear-regression-mlr-modeling-with-multiple-predictors">Multiple Linear Regression (MLR): Modeling with Multiple Predictors</h2>
<p>Often, an outcome depends on <em>more than one</em> factor. MLR extends SLR to handle multiple independent variables (X₁, X₂, …, X&lt;0xE2&gt;&lt;0x82&gt;&lt;0x99&gt;).</p>
<p><strong>The Goal:</strong> Find the best-fitting linear <em>surface</em> (a hyperplane in higher dimensions) that describes the relationship between the multiple predictors and the target variable.</p>
<p><strong>The Equation:</strong> <strong>Y = β₀ + β₁X₁ + β₂X₂ + … + β&lt;0xE2&gt;&lt;0x82&gt;&lt;0x99&gt;X&lt;0xE2&gt;&lt;0x82&gt;&lt;0x99&gt; + ε</strong></p>
<ul>
<li><strong>β₀:</strong> Intercept (Predicted Y when <em>all</em> X variables are 0).</li>
<li><strong>β₁:</strong> Coefficient for X₁. The predicted change in Y for a one-unit increase in X₁, <em>holding all other X variables constant</em>.</li>
<li><strong>β₂:</strong> Coefficient for X₂. The predicted change in Y for a one-unit increase in X₂, <em>holding all other X variables constant</em>.</li>
<li>…and so on for each predictor.</li>
<li><strong>ε:</strong> Error term.</li>
</ul>
<p><strong>Interpretation is key:</strong> Each coefficient’s effect is considered <em>while controlling for the influence of the other variables in the model</em>.</p>
<section id="mini-case-2-predicting-website-conversion-rate" class="level3">
<h3 class="anchored" data-anchor-id="mini-case-2-predicting-website-conversion-rate">Mini-Case 2: Predicting Website Conversion Rate</h3>
<p>An e-commerce company wants to predict the conversion rate (percentage of visitors who make a purchase) based on:</p>
<ul>
<li><code>AvgSessionDuration</code> (average time spent on site in minutes).</li>
<li><code>PagesPerVisit</code> (average number of pages viewed per session).</li>
<li><code>BounceRate</code> (percentage of visitors who leave after viewing only one page).</li>
</ul>
<div id="569654de" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Generate sample data for MLR</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a>n_samples <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>avg_duration <span class="op">=</span> np.random.normal(<span class="dv">5</span>, <span class="dv">2</span>, n_samples) <span class="co"># Avg 5 mins, std dev 2</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>pages_per_visit <span class="op">=</span> np.random.normal(<span class="dv">4</span>, <span class="fl">1.5</span>, n_samples) <span class="co"># Avg 4 pages, std dev 1.5</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>bounce_rate <span class="op">=</span> np.random.normal(<span class="dv">40</span>, <span class="dv">10</span>, n_samples) <span class="co"># Avg 40%, std dev 10</span></span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co"># Ensure non-negative values where applicable</span></span>
<span id="cb16-9"><a href="#cb16-9"></a>avg_duration <span class="op">=</span> np.maximum(avg_duration, <span class="fl">0.5</span>) </span>
<span id="cb16-10"><a href="#cb16-10"></a>pages_per_visit <span class="op">=</span> np.maximum(pages_per_visit, <span class="dv">1</span>)</span>
<span id="cb16-11"><a href="#cb16-11"></a>bounce_rate <span class="op">=</span> np.clip(bounce_rate, <span class="dv">5</span>, <span class="dv">95</span>) <span class="co"># Keep bounce rate reasonable (5% to 95%)</span></span>
<span id="cb16-12"><a href="#cb16-12"></a></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co"># Create conversion rate: Higher duration/pages = good, higher bounce = bad</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co"># Base rate + positive effect of duration/pages + negative effect of bounce + noise</span></span>
<span id="cb16-15"><a href="#cb16-15"></a>conversion_rate <span class="op">=</span> <span class="fl">1.5</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> avg_duration <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> pages_per_visit <span class="op">-</span> <span class="fl">0.05</span> <span class="op">*</span> bounce_rate <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.5</span>, n_samples)</span>
<span id="cb16-16"><a href="#cb16-16"></a>conversion_rate <span class="op">=</span> np.maximum(conversion_rate, <span class="fl">0.1</span>) <span class="co"># Ensure minimum conversion rate &gt; 0</span></span>
<span id="cb16-17"><a href="#cb16-17"></a></span>
<span id="cb16-18"><a href="#cb16-18"></a>df_conversion <span class="op">=</span> pd.DataFrame({</span>
<span id="cb16-19"><a href="#cb16-19"></a>    <span class="st">'AvgSessionDuration'</span>: avg_duration,</span>
<span id="cb16-20"><a href="#cb16-20"></a>    <span class="st">'PagesPerVisit'</span>: pages_per_visit,</span>
<span id="cb16-21"><a href="#cb16-21"></a>    <span class="st">'BounceRate'</span>: bounce_rate,</span>
<span id="cb16-22"><a href="#cb16-22"></a>    <span class="st">'ConversionRate'</span>: conversion_rate </span>
<span id="cb16-23"><a href="#cb16-23"></a>})</span>
<span id="cb16-24"><a href="#cb16-24"></a></span>
<span id="cb16-25"><a href="#cb16-25"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">--- Mini-Case 2: Website Conversion Data ---"</span>)</span>
<span id="cb16-26"><a href="#cb16-26"></a><span class="bu">print</span>(df_conversion.head())</span>
<span id="cb16-27"><a href="#cb16-27"></a></span>
<span id="cb16-28"><a href="#cb16-28"></a><span class="co"># Optional: Explore relationships with pairplot</span></span>
<span id="cb16-29"><a href="#cb16-29"></a><span class="co"># sns.pairplot(df_conversion)</span></span>
<span id="cb16-30"><a href="#cb16-30"></a><span class="co"># plt.show()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Mini-Case 2: Website Conversion Data ---
   AvgSessionDuration  PagesPerVisit  BounceRate  ConversionRate
0            2.828739       5.054965   55.340903        1.445772
1            6.994691       3.102842   34.700859        2.789319
2            5.565957       7.301053   35.090277        3.564697
3            1.987411       5.032445   26.908347        1.769900
4            3.842799       3.990539   39.913395        2.426858</code></pre>
</div>
</div>
</section>
<section id="preparing-data-for-mlr" class="level3">
<h3 class="anchored" data-anchor-id="preparing-data-for-mlr">Preparing Data for MLR</h3>
<div id="6377ec3e" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Define features (X) and target (y)</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>X_conv <span class="op">=</span> df_conversion[[<span class="st">'AvgSessionDuration'</span>, <span class="st">'PagesPerVisit'</span>, <span class="st">'BounceRate'</span>]] <span class="co"># Multiple columns now</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>y_conv <span class="op">=</span> df_conversion[<span class="st">'ConversionRate'</span>]</span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Shape of X_conv:"</span>, X_conv.shape)</span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="bu">print</span>(<span class="st">"Shape of y_conv:"</span>, y_conv.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Shape of X_conv: (200, 3)
Shape of y_conv: (200,)</code></pre>
</div>
</div>
</section>
<section id="train-test-split-for-mlr-data" class="level3">
<h3 class="anchored" data-anchor-id="train-test-split-for-mlr-data">Train-Test Split for MLR Data</h3>
<div id="b8606144" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>X_conv_train, X_conv_test, y_conv_train, y_conv_test <span class="op">=</span> train_test_split(</span>
<span id="cb20-2"><a href="#cb20-2"></a>    X_conv, y_conv, test_size<span class="op">=</span><span class="fl">0.25</span>, random_state<span class="op">=</span><span class="dv">123</span> <span class="co"># Using 75/25 split here</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>)</span>
<span id="cb20-4"><a href="#cb20-4"></a></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">--- MLR Train-Test Split ---"</span>)</span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="bu">print</span>(<span class="st">"Training set size:"</span>, X_conv_train.shape[<span class="dv">0</span>])</span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="bu">print</span>(<span class="st">"Test set size:"</span>, X_conv_test.shape[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- MLR Train-Test Split ---
Training set size: 150
Test set size: 50</code></pre>
</div>
</div>
</section>
<section id="training-the-mlr-model" class="level3">
<h3 class="anchored" data-anchor-id="training-the-mlr-model">Training the MLR Model</h3>
<p>The process is identical to SLR, just using the multi-feature <code>X_conv_train</code>.</p>
<div id="3a6f4d21" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Create and train the Multiple Linear Regression model</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>mlr_model <span class="op">=</span> LinearRegression()</span>
<span id="cb22-3"><a href="#cb22-3"></a>mlr_model.fit(X_conv_train, y_conv_train)</span>
<span id="cb22-4"><a href="#cb22-4"></a></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">MLR Model trained successfully."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
MLR Model trained successfully.</code></pre>
</div>
</div>
</section>
<section id="interpreting-mlr-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-mlr-coefficients">Interpreting MLR Coefficients</h3>
<div id="837662ad" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Get intercept and coefficients</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>mlr_intercept <span class="op">=</span> mlr_model.intercept_</span>
<span id="cb24-3"><a href="#cb24-3"></a>mlr_coefficients <span class="op">=</span> mlr_model.coef_</span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">--- MLR Model Coefficients ---"</span>)</span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="bu">print</span>(<span class="ss">f"Intercept (β₀): </span><span class="sc">{</span>mlr_intercept<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb24-7"><a href="#cb24-7"></a></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="co"># Match coefficients to feature names</span></span>
<span id="cb24-9"><a href="#cb24-9"></a>feature_names <span class="op">=</span> X_conv_train.columns</span>
<span id="cb24-10"><a href="#cb24-10"></a>coeffs_df <span class="op">=</span> pd.DataFrame({<span class="st">'Feature'</span>: feature_names, <span class="st">'Coefficient (β)'</span>: mlr_coefficients})</span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="bu">print</span>(coeffs_df)</span>
<span id="cb24-12"><a href="#cb24-12"></a></span>
<span id="cb24-13"><a href="#cb24-13"></a><span class="co"># Interpretation</span></span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Interpretation:"</span>)</span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="bu">print</span>(<span class="ss">f"- The model predicts a baseline conversion rate of </span><span class="sc">{</span>mlr_intercept<span class="sc">:.3f}</span><span class="ss">% when all predictors (duration, pages, bounce rate) are zero (use caution interpreting intercepts)."</span>)</span>
<span id="cb24-16"><a href="#cb24-16"></a><span class="bu">print</span>(<span class="ss">f"- For each additional minute of AvgSessionDuration, conversion rate is predicted to increase by </span><span class="sc">{</span>coeffs_df<span class="sc">.</span>loc[<span class="dv">0</span>, <span class="st">'Coefficient (β)'</span>]<span class="sc">:.3f}</span><span class="ss"> percentage points, holding PagesPerVisit and BounceRate constant."</span>)</span>
<span id="cb24-17"><a href="#cb24-17"></a><span class="bu">print</span>(<span class="ss">f"- For each additional page viewed per visit, conversion rate is predicted to increase by </span><span class="sc">{</span>coeffs_df<span class="sc">.</span>loc[<span class="dv">1</span>, <span class="st">'Coefficient (β)'</span>]<span class="sc">:.3f}</span><span class="ss"> percentage points, holding AvgSessionDuration and BounceRate constant."</span>)</span>
<span id="cb24-18"><a href="#cb24-18"></a><span class="bu">print</span>(<span class="ss">f"- For each one percentage point increase in BounceRate, conversion rate is predicted to decrease by </span><span class="sc">{</span><span class="bu">abs</span>(coeffs_df.loc[<span class="dv">2</span>, <span class="st">'Coefficient (β)'</span>])<span class="sc">:.3f}</span><span class="ss"> percentage points (note the negative sign), holding AvgSessionDuration and PagesPerVisit constant."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- MLR Model Coefficients ---
Intercept (β₀): 1.355
              Feature  Coefficient (β)
0  AvgSessionDuration         0.381521
1       PagesPerVisit         0.267903
2          BounceRate        -0.051173

Interpretation:
- The model predicts a baseline conversion rate of 1.355% when all predictors (duration, pages, bounce rate) are zero (use caution interpreting intercepts).
- For each additional minute of AvgSessionDuration, conversion rate is predicted to increase by 0.382 percentage points, holding PagesPerVisit and BounceRate constant.
- For each additional page viewed per visit, conversion rate is predicted to increase by 0.268 percentage points, holding AvgSessionDuration and BounceRate constant.
- For each one percentage point increase in BounceRate, conversion rate is predicted to decrease by 0.051 percentage points (note the negative sign), holding AvgSessionDuration and PagesPerVisit constant.</code></pre>
</div>
</div>
</section>
<section id="evaluating-the-mlr-model" class="level3">
<h3 class="anchored" data-anchor-id="evaluating-the-mlr-model">Evaluating the MLR Model</h3>
<div id="0d521d75" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># Make predictions on the </span><span class="al">TEST</span><span class="co"> set</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>y_conv_pred_test <span class="op">=</span> mlr_model.predict(X_conv_test)</span>
<span id="cb26-3"><a href="#cb26-3"></a></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co"># Calculate evaluation metrics</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>r2_mlr_test <span class="op">=</span> r2_score(y_conv_test, y_conv_pred_test)</span>
<span id="cb26-6"><a href="#cb26-6"></a>mse_mlr_test <span class="op">=</span> mean_squared_error(y_conv_test, y_conv_pred_test)</span>
<span id="cb26-7"><a href="#cb26-7"></a>rmse_mlr_test <span class="op">=</span> np.sqrt(mse_mlr_test)</span>
<span id="cb26-8"><a href="#cb26-8"></a></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">--- MLR Model Evaluation (Test Set) ---"</span>)</span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="bu">print</span>(<span class="ss">f"R-squared (R²): </span><span class="sc">{</span>r2_mlr_test<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="bu">print</span>(<span class="ss">f"Root Mean Squared Error (RMSE): </span><span class="sc">{</span>rmse_mlr_test<span class="sc">:.3f}</span><span class="ss">"</span>) <span class="co"># Units are percentage points</span></span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="bu">print</span>(<span class="ss">f"Mean Absolute Error (MAE): </span><span class="sc">{</span>mse_mlr_test<span class="sc">:.3f}</span><span class="ss">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- MLR Model Evaluation (Test Set) ---
R-squared (R²): 0.829
Root Mean Squared Error (RMSE): 0.442
Mean Absolute Error (MAE): 0.195</code></pre>
</div>
</div>
<p><strong>Adjusted R-squared:</strong> When adding more predictors to an MLR model, R-squared will <em>never decrease</em>, even if the added predictors are useless. <strong>Adjusted R-squared</strong> is a modified version that penalizes the score for adding predictors that don’t improve the model significantly. It’s often preferred when comparing models with different numbers of predictors. <code>scikit-learn</code> doesn’t calculate it directly in the <code>LinearRegression</code> score, but it can be computed manually or using other libraries like <code>statsmodels</code>. For an intro, standard R-squared gives a good starting point.</p>
</section>
<section id="making-predictions-with-mlr" class="level3">
<h3 class="anchored" data-anchor-id="making-predictions-with-mlr">Making Predictions with MLR</h3>
<div id="d2e7381d" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># Predict conversion rate for a new visitor profile</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>new_visitor_profile <span class="op">=</span> pd.DataFrame({</span>
<span id="cb28-3"><a href="#cb28-3"></a>    <span class="st">'AvgSessionDuration'</span>: [<span class="fl">7.5</span>],  <span class="co"># 7.5 minutes</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>    <span class="st">'PagesPerVisit'</span>: [<span class="dv">5</span>],         <span class="co"># 5 pages</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>    <span class="st">'BounceRate'</span>: [<span class="dv">30</span>]            <span class="co"># 30% bounce rate</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>})</span>
<span id="cb28-7"><a href="#cb28-7"></a></span>
<span id="cb28-8"><a href="#cb28-8"></a>predicted_conversion <span class="op">=</span> mlr_model.predict(new_visitor_profile)</span>
<span id="cb28-9"><a href="#cb28-9"></a></span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">--- MLR Prediction Example ---"</span>)</span>
<span id="cb28-11"><a href="#cb28-11"></a><span class="bu">print</span>(<span class="ss">f"Predicted Conversion Rate for profile: </span><span class="sc">{</span>predicted_conversion[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">%"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- MLR Prediction Example ---
Predicted Conversion Rate for profile: 4.02%</code></pre>
</div>
</div>
</section>
<section id="considerations-for-mlr" class="level3">
<h3 class="anchored" data-anchor-id="considerations-for-mlr">Considerations for MLR</h3>
<ul>
<li><p><strong>Multicollinearity:</strong> If predictor variables are highly correlated with each other, it can make the coefficient estimates unstable and difficult to interpret reliably. (e.g., if <code>AvgSessionDuration</code> and <code>PagesPerVisit</code> were almost perfectly correlated). This needs checking in real-world scenarios.</p></li>
<li><p><strong>Feature Selection:</strong> With many potential predictors, deciding which ones to include in the model becomes important. Adding irrelevant features can make the model worse.</p></li>
<li><p><strong>Assumptions:</strong> The same assumptions as SLR (linearity, independence, homoscedasticity, normality of errors) apply and should ideally be checked via residual analysis.</p>
<p>*NOTE: In this course, we won’t delve into these advanced topics, but they’re crucial in practice. You should have a basic understanding of them from your statistics background.**</p></li>
</ul>
<p>Other topics to explore later include: * <strong>Feature Engineering:</strong> Sometimes, creating new features (e.g., interaction terms, polynomial features) can improve model performance. This is a more advanced topic but worth exploring in future sessions. * <strong>Model Complexity:</strong> MLR is still a relatively simple model. As you progress in ML, you’ll encounter more complex models (e.g., decision trees, random forests, neural networks) that can capture non-linear relationships and interactions between features.</p>
<div class="callout callout-style-simple callout-tip callout-titled" title="Visualizing Model Fit: Underfitting vs. Overfitting">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visualizing Model Fit: Underfitting vs.&nbsp;Overfitting
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<section id="the-balancing-act-bias-vs.-variance" class="level4 callout-body-container callout-body">
<h4 class="anchored" data-anchor-id="the-balancing-act-bias-vs.-variance">The Balancing Act: Bias vs.&nbsp;Variance</h4>
<p>When we build predictive models, we’re constantly trying to strike a balance. We want a model that learns the true underlying patterns in our data but doesn’t just memorize the noise or random fluctuations specific to our training set. This leads to two common problems:</p>
<ol type="1">
<li><strong>Underfitting (High Bias):</strong>
<ul>
<li><strong>What it is:</strong> The model is <em>too simple</em> to capture the underlying structure of the data. It fails to learn the relationship between the features (X) and the target (y).</li>
<li><strong>Symptoms:</strong> Poor performance on <em>both</em> the training data and the test data. The model doesn’t represent the data well.</li>
<li><strong>Visual:</strong> The model’s prediction line (or curve) looks too simplistic and doesn’t follow the general trend of the data points.</li>
</ul></li>
<li><strong>Overfitting (High Variance):</strong>
<ul>
<li><strong>What it is:</strong> The model learns the training data <em>too well</em>, including the random noise. It essentially memorizes the training examples instead of learning the general trend.</li>
<li><strong>Symptoms:</strong> Excellent performance on the training data but poor performance on new, unseen data (the test set). The model doesn’t generalize well.</li>
<li><strong>Visual:</strong> The model’s prediction line (or curve) fits the training points very closely, often resulting in a complex, “wiggly” line that deviates wildly between points.</li>
</ul></li>
<li><strong>Good Fit (The “Goldilocks” Zone):</strong>
<ul>
<li><strong>What it is:</strong> The model captures the underlying trend of the data effectively without fitting the noise.</li>
<li><strong>Symptoms:</strong> Good performance on both the training data and, more importantly, the test data. The model generalizes well to new examples.</li>
<li><strong>Visual:</strong> The model’s prediction line (or curve) follows the general pattern of the data smoothly and provides a reasonable representation.</li>
</ul></li>
</ol>
<p><strong>Our Goal:</strong> Find a model that achieves a good balance – complex enough to capture the trend (avoiding underfitting) but simple enough to avoid fitting noise and generalize well (avoiding overfitting). Techniques like train-test split help us <em>diagnose</em> these issues by evaluating performance on unseen data.</p>
<p>The plots below demonstrate these concepts using polynomial regression on synthetic data. Notice how the overfit model (high-degree polynomial) hugs the <em>training</em> points but would likely perform poorly on the <em>test</em> points, while the underfit model (linear) fails to capture the curve in either set.</p>
<div id="3e597e34" class="cell" data-fig-height="4" data-fig-layout="grid" data-fig-width="5" data-execution_count="16">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week11-lecture_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Illustration of Underfitting, Good Fit, and Overfitting</figcaption>
</figure>
</div>
</div>
</div>
</section>
</div>
</div>
</section>
</section>
<section id="business-applications-revisited" class="level2">
<h2 class="anchored" data-anchor-id="business-applications-revisited">Business Applications Revisited</h2>
<p>Linear regression (both simple and multiple) is incredibly versatile:</p>
<ul>
<li><strong>Predictive Analytics:</strong> Forecasting sales, demand, customer value, resource needs.</li>
<li><strong>Driver Analysis:</strong> Understanding which factors (marketing spend, website features, economic indicators) have the biggest impact on key performance indicators (KPIs). Quantifying ROI.</li>
<li><strong>Optimization:</strong> Informing decisions on pricing, promotions, resource allocation based on predicted outcomes.</li>
<li><strong>Risk Assessment:</strong> Predicting credit default risk based on applicant characteristics.</li>
</ul>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Today, we’ve taken our first major step into Machine Learning by exploring Linear Regression. Key takeaways include:</p>
<ol type="1">
<li>Machine Learning enables computers to learn from data, with <strong>Supervised Learning</strong> using labeled data to make predictions.</li>
<li><strong>Linear Regression</strong> models linear relationships between predictors (X) and a continuous target (Y).</li>
<li><strong>Simple Linear Regression (SLR)</strong> uses one predictor: Y = β₀ + β₁X.</li>
<li><strong>Multiple Linear Regression (MLR)</strong> uses multiple predictors: Y = β₀ + β₁X₁ + β₂X₂ + …</li>
<li><strong>Train-Test Split</strong> is ESSENTIAL for evaluating how well a model generalizes to new, unseen data and avoiding overfitting.</li>
<li>We use <code>scikit-learn</code> to implement these models (<code>LinearRegression</code>, <code>train_test_split</code>).</li>
<li>Interpreting <strong>coefficients (β)</strong> tells us the magnitude and direction of relationships (holding other factors constant in MLR).</li>
<li><strong>R-squared</strong> measures the proportion of variance explained; <strong>RMSE/MAE</strong> measure average prediction error.</li>
</ol>
<p>Linear regression is a powerful, interpretable baseline model. Understanding it provides a solid foundation for tackling more complex ML algorithms later.</p>
<p><strong>Next Steps:</strong> We might delve deeper into model evaluation, assumption checking (residual analysis), or move on to <strong>Classification</strong> tasks – predicting categorical outcomes (like Yes/No, Spam/Not Spam) using techniques such as Logistic Regression.</p>
<p>Please review the code and concepts. Think about how you could apply regression analysis to business problems you encounter:</p>
<p><strong>Marketing &amp; Sales:</strong></p>
<ol type="1">
<li>Predicting future monthly sales based on advertising spend, seasonality, and number of sales representatives.</li>
<li>Estimating the impact of price changes and competitor pricing on product demand.</li>
<li>Forecasting customer lifetime value based on initial purchase behavior and demographic data.</li>
<li>Predicting website conversion rates based on traffic source, time spent on site, and number of pages visited.</li>
<li>Estimating the increase in store foot traffic associated with specific promotional events.</li>
</ol>
<p><strong>Finance &amp; Economics:</strong></p>
<ol start="6" type="1">
<li>Predicting the sales price of a house based on its square footage, number of bedrooms, age, and location rating.</li>
<li>Estimating a company’s revenue based on broader economic indicators like GDP growth or consumer confidence index.</li>
<li>Modeling the relationship between interest rates and loan application volume.</li>
</ol>
<p><strong>Operations &amp; Supply Chain:</strong></p>
<ol start="9" type="1">
<li>Forecasting weekly demand for a specific product based on historical sales and recent promotional activity.</li>
<li>Predicting shipping/delivery time based on distance, package weight, and time of year.</li>
<li>Estimating raw material costs based on supplier quotes and order volume.</li>
</ol>
<p><strong>Human Resources:</strong></p>
<ol start="12" type="1">
<li>Predicting employee performance score based on factors like training hours completed, years of experience, and peer review scores.</li>
<li>Modeling employee satisfaction levels based on survey responses about workload, compensation, and management quality.</li>
<li>Estimating the relationship between employee engagement scores and team productivity metrics.</li>
</ol>
<p>Reflect on these examples. Linear regression helps quantify relationships and build predictive models, providing valuable insights for decision-making across many different business functions. What other examples can you think of? How might you apply these concepts in your own work or projects?</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>