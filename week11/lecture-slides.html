<!DOCTYPE html>
<html lang="en"><head>
<script src="Week11-lecture-slides_files/libs/clipboard/clipboard.min.js"></script>
<script src="Week11-lecture-slides_files/libs/quarto-html/tabby.min.js"></script>
<script src="Week11-lecture-slides_files/libs/quarto-html/popper.min.js"></script>
<script src="Week11-lecture-slides_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Week11-lecture-slides_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Week11-lecture-slides_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Week11-lecture-slides_files/libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.31">

  <meta name="author" content="Dr.&nbsp;Tim Smith">
  <meta name="dcterms.date" content="2025-04-12">
  <title>ISM4641: Python for Business Analytics</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Week11-lecture-slides_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Week11-lecture-slides_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Week11-lecture-slides_files/libs/revealjs/dist/theme/quarto-f563837468303362081e247dddd440d0.css">
  <link rel="stylesheet" href="../reveal-scroll.css">
  <link href="Week11-lecture-slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Week11-lecture-slides_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Week11-lecture-slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Week11-lecture-slides_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="Week11-lecture-slides_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="Week11-lecture-slides_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">ISM4641: Python for Business Analytics</h1>
  <p class="subtitle">Week 11: Linear Regression for Predictive Analytics</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Tim Smith 
</div>
</div>
</div>

  <p class="date">April 12, 2025</p>
</section>
<section>
<section id="welcome-to-week-11" class="title-slide slide level1 smaller center">
<h1>Welcome to Week 11!</h1>

</section>
<section id="from-statistics-to-machine-learning" class="slide level2">
<h2>From Statistics to Machine Learning</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="why-predictive-analytics">Why Predictive Analytics?</h3>
<ul>
<li><strong>Forecast Future Performance</strong>: Predict sales, costs, customer behavior</li>
<li><strong>Optimize Business Decisions</strong>: Data-driven resource allocation</li>
<li><strong>Identify Key Drivers</strong>: Understand what impacts business outcomes</li>
<li><strong>Quantify Relationships</strong>: Measure cause-and-effect relationships</li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="what-well-master">What We’ll Master</h3>
<ul>
<li><strong>Simple Linear Regression</strong>: Single predictor models</li>
<li><strong>Multiple Linear Regression</strong>: Multi-factor predictions</li>
<li><strong>Model Evaluation</strong>: R², RMSE, MAE metrics</li>
<li><strong>Train-Test Split</strong>: Proper model validation</li>
<li><strong>Scikit-learn</strong>: Professional ML library</li>
</ul>
</div></div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Linear Regression bridges descriptive statistics and predictive machine learning!</p>
</div>
</div>
</div>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="part-1-simple-linear-regression" class="title-slide slide level1 smaller center">
<h1>Part 1: Simple Linear Regression</h1>

</section>
<section id="understanding-the-relationship" class="slide level2">
<h2>Understanding the Relationship</h2>
<div id="0b91b135" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href=""></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href=""></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb1-6"><a href=""></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-7"><a href=""></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, mean_absolute_error, r2_score</span>
<span id="cb1-8"><a href=""></a><span class="im">import</span> warnings</span>
<span id="cb1-9"><a href=""></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb1-10"><a href=""></a></span>
<span id="cb1-11"><a href=""></a><span class="co"># Set professional plotting style</span></span>
<span id="cb1-12"><a href=""></a>plt.style.use(<span class="st">'default'</span>)</span>
<span id="cb1-13"><a href=""></a>sns.set_palette(<span class="st">"husl"</span>)</span>
<span id="cb1-14"><a href=""></a></span>
<span id="cb1-15"><a href=""></a><span class="bu">print</span>(<span class="st">"SIMPLE LINEAR REGRESSION"</span>)</span>
<span id="cb1-16"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">30</span>)</span>
<span id="cb1-17"><a href=""></a></span>
<span id="cb1-18"><a href=""></a><span class="co"># Business scenario: Marketing spend vs Sales revenue</span></span>
<span id="cb1-19"><a href=""></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb1-20"><a href=""></a>n_observations <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb1-21"><a href=""></a></span>
<span id="cb1-22"><a href=""></a><span class="co"># Generate realistic marketing spend data</span></span>
<span id="cb1-23"><a href=""></a>marketing_spend <span class="op">=</span> np.random.uniform(<span class="dv">50000</span>, <span class="dv">500000</span>, n_observations)</span>
<span id="cb1-24"><a href=""></a></span>
<span id="cb1-25"><a href=""></a><span class="co"># Create realistic relationship: Sales = Base + 3.2 * Marketing + noise</span></span>
<span id="cb1-26"><a href=""></a>base_sales <span class="op">=</span> <span class="dv">200000</span></span>
<span id="cb1-27"><a href=""></a>marketing_coefficient <span class="op">=</span> <span class="fl">3.2</span></span>
<span id="cb1-28"><a href=""></a>noise <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">80000</span>, n_observations)</span>
<span id="cb1-29"><a href=""></a>sales_revenue <span class="op">=</span> base_sales <span class="op">+</span> marketing_coefficient <span class="op">*</span> marketing_spend <span class="op">+</span> noise</span>
<span id="cb1-30"><a href=""></a></span>
<span id="cb1-31"><a href=""></a><span class="co"># Ensure positive values</span></span>
<span id="cb1-32"><a href=""></a>sales_revenue <span class="op">=</span> np.<span class="bu">abs</span>(sales_revenue)</span>
<span id="cb1-33"><a href=""></a></span>
<span id="cb1-34"><a href=""></a><span class="co"># Create DataFrame</span></span>
<span id="cb1-35"><a href=""></a>marketing_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb1-36"><a href=""></a>    <span class="st">'Marketing_Spend'</span>: marketing_spend,</span>
<span id="cb1-37"><a href=""></a>    <span class="st">'Sales_Revenue'</span>: sales_revenue</span>
<span id="cb1-38"><a href=""></a>})</span>
<span id="cb1-39"><a href=""></a></span>
<span id="cb1-40"><a href=""></a><span class="bu">print</span>(<span class="st">"Business Scenario: Marketing ROI Analysis"</span>)</span>
<span id="cb1-41"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">40</span>)</span>
<span id="cb1-42"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Dataset: </span><span class="sc">{</span><span class="bu">len</span>(marketing_data)<span class="sc">}</span><span class="ss"> observations"</span>)</span>
<span id="cb1-43"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Marketing Spend Range: $</span><span class="sc">{</span>marketing_spend<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:,.0f}</span><span class="ss"> - $</span><span class="sc">{</span>marketing_spend<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb1-44"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Sales Revenue Range: $</span><span class="sc">{</span>sales_revenue<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:,.0f}</span><span class="ss"> - $</span><span class="sc">{</span>sales_revenue<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb1-45"><a href=""></a></span>
<span id="cb1-46"><a href=""></a><span class="co"># Exploratory analysis</span></span>
<span id="cb1-47"><a href=""></a>correlation <span class="op">=</span> marketing_data[<span class="st">'Marketing_Spend'</span>].corr(marketing_data[<span class="st">'Sales_Revenue'</span>])</span>
<span id="cb1-48"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Correlation: </span><span class="sc">{</span>correlation<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb1-49"><a href=""></a></span>
<span id="cb1-50"><a href=""></a><span class="co"># Train-test split</span></span>
<span id="cb1-51"><a href=""></a>X <span class="op">=</span> marketing_data[[<span class="st">'Marketing_Spend'</span>]]  <span class="co"># Note: 2D array for sklearn</span></span>
<span id="cb1-52"><a href=""></a>y <span class="op">=</span> marketing_data[<span class="st">'Sales_Revenue'</span>]</span>
<span id="cb1-53"><a href=""></a></span>
<span id="cb1-54"><a href=""></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.25</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb1-55"><a href=""></a></span>
<span id="cb1-56"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Train-Test Split:"</span>)</span>
<span id="cb1-57"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Training set: </span><span class="sc">{</span><span class="bu">len</span>(X_train)<span class="sc">}</span><span class="ss"> observations"</span>)</span>
<span id="cb1-58"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Test set: </span><span class="sc">{</span><span class="bu">len</span>(X_test)<span class="sc">}</span><span class="ss"> observations"</span>)</span>
<span id="cb1-59"><a href=""></a></span>
<span id="cb1-60"><a href=""></a><span class="co"># Create and train the model</span></span>
<span id="cb1-61"><a href=""></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb1-62"><a href=""></a>model.fit(X_train, y_train)</span>
<span id="cb1-63"><a href=""></a></span>
<span id="cb1-64"><a href=""></a><span class="co"># Extract coefficients</span></span>
<span id="cb1-65"><a href=""></a>intercept <span class="op">=</span> model.intercept_</span>
<span id="cb1-66"><a href=""></a>slope <span class="op">=</span> model.coef_[<span class="dv">0</span>]</span>
<span id="cb1-67"><a href=""></a></span>
<span id="cb1-68"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Model Coefficients:"</span>)</span>
<span id="cb1-69"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Intercept (β₀): $</span><span class="sc">{</span>intercept<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb1-70"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Slope (β₁): </span><span class="sc">{</span>slope<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb1-71"><a href=""></a></span>
<span id="cb1-72"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Business Interpretation:"</span>)</span>
<span id="cb1-73"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  • Base sales (when marketing spend = $0): $</span><span class="sc">{</span>intercept<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb1-74"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  • For every additional $1,000 in marketing spend:"</span>)</span>
<span id="cb1-75"><a href=""></a><span class="bu">print</span>(<span class="ss">f"    Sales increase by $</span><span class="sc">{</span>slope<span class="op">*</span><span class="dv">1000</span><span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb1-76"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  • Marketing ROI: </span><span class="sc">{</span>slope<span class="sc">:.2f}</span><span class="ss">x ($</span><span class="sc">{</span>slope<span class="sc">:.2f}</span><span class="ss"> revenue per $1 spent)"</span>)</span>
<span id="cb1-77"><a href=""></a></span>
<span id="cb1-78"><a href=""></a><span class="co"># Make predictions</span></span>
<span id="cb1-79"><a href=""></a>y_train_pred <span class="op">=</span> model.predict(X_train)</span>
<span id="cb1-80"><a href=""></a>y_test_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb1-81"><a href=""></a></span>
<span id="cb1-82"><a href=""></a><span class="co"># Calculate performance metrics</span></span>
<span id="cb1-83"><a href=""></a>train_r2 <span class="op">=</span> r2_score(y_train, y_train_pred)</span>
<span id="cb1-84"><a href=""></a>test_r2 <span class="op">=</span> r2_score(y_test, y_test_pred)</span>
<span id="cb1-85"><a href=""></a>train_rmse <span class="op">=</span> np.sqrt(mean_squared_error(y_train, y_train_pred))</span>
<span id="cb1-86"><a href=""></a>test_rmse <span class="op">=</span> np.sqrt(mean_squared_error(y_test, y_test_pred))</span>
<span id="cb1-87"><a href=""></a>train_mae <span class="op">=</span> mean_absolute_error(y_train, y_train_pred)</span>
<span id="cb1-88"><a href=""></a>test_mae <span class="op">=</span> mean_absolute_error(y_test, y_test_pred)</span>
<span id="cb1-89"><a href=""></a></span>
<span id="cb1-90"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Model Performance:"</span>)</span>
<span id="cb1-91"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Training R²: </span><span class="sc">{</span>train_r2<span class="sc">:.3f}</span><span class="ss"> (</span><span class="sc">{</span>train_r2<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% variance explained)"</span>)</span>
<span id="cb1-92"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Test R²: </span><span class="sc">{</span>test_r2<span class="sc">:.3f}</span><span class="ss"> (</span><span class="sc">{</span>test_r2<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% variance explained)"</span>)</span>
<span id="cb1-93"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Training RMSE: $</span><span class="sc">{</span>train_rmse<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb1-94"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Test RMSE: $</span><span class="sc">{</span>test_rmse<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb1-95"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Test MAE: $</span><span class="sc">{</span>test_mae<span class="sc">:,.2f}</span><span class="ss"> (average prediction error)"</span>)</span>
<span id="cb1-96"><a href=""></a></span>
<span id="cb1-97"><a href=""></a><span class="co"># Visualize the regression</span></span>
<span id="cb1-98"><a href=""></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">12</span>))</span>
<span id="cb1-99"><a href=""></a></span>
<span id="cb1-100"><a href=""></a><span class="co"># 1. Scatter plot with regression line</span></span>
<span id="cb1-101"><a href=""></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb1-102"><a href=""></a>ax1.scatter(X_train, y_train, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'blue'</span>, s<span class="op">=</span><span class="dv">50</span>, label<span class="op">=</span><span class="st">'Training Data'</span>)</span>
<span id="cb1-103"><a href=""></a>ax1.scatter(X_test, y_test, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'red'</span>, s<span class="op">=</span><span class="dv">50</span>, label<span class="op">=</span><span class="st">'Test Data'</span>)</span>
<span id="cb1-104"><a href=""></a></span>
<span id="cb1-105"><a href=""></a><span class="co"># Regression line</span></span>
<span id="cb1-106"><a href=""></a>x_range <span class="op">=</span> np.linspace(X.<span class="bu">min</span>().values[<span class="dv">0</span>], X.<span class="bu">max</span>().values[<span class="dv">0</span>], <span class="dv">100</span>)</span>
<span id="cb1-107"><a href=""></a>y_pred_line <span class="op">=</span> model.predict(x_range.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1-108"><a href=""></a>ax1.plot(x_range, y_pred_line, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Regression Line'</span>)</span>
<span id="cb1-109"><a href=""></a></span>
<span id="cb1-110"><a href=""></a>ax1.set_xlabel(<span class="st">'Marketing Spend ($)'</span>)</span>
<span id="cb1-111"><a href=""></a>ax1.set_ylabel(<span class="st">'Sales Revenue ($)'</span>)</span>
<span id="cb1-112"><a href=""></a>ax1.set_title(<span class="ss">f'Marketing Spend vs Sales Revenue</span><span class="ch">\n</span><span class="ss">R² = </span><span class="sc">{</span>test_r2<span class="sc">:.3f}</span><span class="ss">'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb1-113"><a href=""></a>ax1.legend()</span>
<span id="cb1-114"><a href=""></a>ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb1-115"><a href=""></a></span>
<span id="cb1-116"><a href=""></a><span class="co"># Format axes</span></span>
<span id="cb1-117"><a href=""></a>ax1.xaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="op">/</span><span class="dv">1000</span><span class="sc">:.0f}</span><span class="ss">K'</span>))</span>
<span id="cb1-118"><a href=""></a>ax1.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M'</span>))</span>
<span id="cb1-119"><a href=""></a></span>
<span id="cb1-120"><a href=""></a><span class="co"># 2. Residuals plot</span></span>
<span id="cb1-121"><a href=""></a>ax2 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb1-122"><a href=""></a>residuals_test <span class="op">=</span> y_test <span class="op">-</span> y_test_pred</span>
<span id="cb1-123"><a href=""></a>ax2.scatter(y_test_pred, residuals_test, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb1-124"><a href=""></a>ax2.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb1-125"><a href=""></a>ax2.set_xlabel(<span class="st">'Predicted Sales ($)'</span>)</span>
<span id="cb1-126"><a href=""></a>ax2.set_ylabel(<span class="st">'Residuals ($)'</span>)</span>
<span id="cb1-127"><a href=""></a>ax2.set_title(<span class="st">'Residuals Plot (Test Data)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb1-128"><a href=""></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb1-129"><a href=""></a></span>
<span id="cb1-130"><a href=""></a><span class="co"># 3. Predicted vs Actual</span></span>
<span id="cb1-131"><a href=""></a>ax3 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb1-132"><a href=""></a>ax3.scatter(y_test, y_test_pred, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'red'</span>, s<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb1-133"><a href=""></a><span class="co"># Perfect prediction line</span></span>
<span id="cb1-134"><a href=""></a>min_val <span class="op">=</span> <span class="bu">min</span>(y_test.<span class="bu">min</span>(), y_test_pred.<span class="bu">min</span>())</span>
<span id="cb1-135"><a href=""></a>max_val <span class="op">=</span> <span class="bu">max</span>(y_test.<span class="bu">max</span>(), y_test_pred.<span class="bu">max</span>())</span>
<span id="cb1-136"><a href=""></a>ax3.plot([min_val, max_val], [min_val, max_val], <span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Perfect Prediction'</span>)</span>
<span id="cb1-137"><a href=""></a></span>
<span id="cb1-138"><a href=""></a>ax3.set_xlabel(<span class="st">'Actual Sales ($)'</span>)</span>
<span id="cb1-139"><a href=""></a>ax3.set_ylabel(<span class="st">'Predicted Sales ($)'</span>)</span>
<span id="cb1-140"><a href=""></a>ax3.set_title(<span class="st">'Predicted vs Actual (Test Data)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb1-141"><a href=""></a>ax3.legend()</span>
<span id="cb1-142"><a href=""></a>ax3.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb1-143"><a href=""></a></span>
<span id="cb1-144"><a href=""></a><span class="co"># 4. Distribution of residuals</span></span>
<span id="cb1-145"><a href=""></a>ax4 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb1-146"><a href=""></a>ax4.hist(residuals_test, bins<span class="op">=</span><span class="dv">15</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'lightblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb1-147"><a href=""></a>ax4.axvline(residuals_test.mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb1-148"><a href=""></a>           label<span class="op">=</span><span class="ss">f'Mean: $</span><span class="sc">{</span>residuals_test<span class="sc">.</span>mean()<span class="sc">:,.0f}</span><span class="ss">'</span>)</span>
<span id="cb1-149"><a href=""></a>ax4.set_xlabel(<span class="st">'Residuals ($)'</span>)</span>
<span id="cb1-150"><a href=""></a>ax4.set_ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb1-151"><a href=""></a>ax4.set_title(<span class="st">'Distribution of Residuals'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb1-152"><a href=""></a>ax4.legend()</span>
<span id="cb1-153"><a href=""></a>ax4.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb1-154"><a href=""></a></span>
<span id="cb1-155"><a href=""></a>plt.tight_layout()</span>
<span id="cb1-156"><a href=""></a>plt.show()</span>
<span id="cb1-157"><a href=""></a></span>
<span id="cb1-158"><a href=""></a><span class="co"># Business predictions</span></span>
<span id="cb1-159"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">BUSINESS PREDICTIONS:"</span>)</span>
<span id="cb1-160"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">25</span>)</span>
<span id="cb1-161"><a href=""></a></span>
<span id="cb1-162"><a href=""></a><span class="co"># Prediction scenarios</span></span>
<span id="cb1-163"><a href=""></a>scenarios <span class="op">=</span> [<span class="dv">100000</span>, <span class="dv">250000</span>, <span class="dv">400000</span>]</span>
<span id="cb1-164"><a href=""></a><span class="cf">for</span> spend <span class="kw">in</span> scenarios:</span>
<span id="cb1-165"><a href=""></a>    predicted_sales <span class="op">=</span> model.predict([[spend]])[<span class="dv">0</span>]</span>
<span id="cb1-166"><a href=""></a>    roi <span class="op">=</span> predicted_sales <span class="op">/</span> spend</span>
<span id="cb1-167"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  Marketing Spend: $</span><span class="sc">{</span>spend<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb1-168"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  Predicted Sales: $</span><span class="sc">{</span>predicted_sales<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb1-169"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  Expected ROI: </span><span class="sc">{</span>roi<span class="sc">:.2f}</span><span class="ss">x"</span>)</span>
<span id="cb1-170"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  Profit (assuming 20% margin): $</span><span class="sc">{</span>(predicted_sales <span class="op">*</span> <span class="fl">0.2</span> <span class="op">-</span> spend)<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb1-171"><a href=""></a>    <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SIMPLE LINEAR REGRESSION
==============================
Business Scenario: Marketing ROI Analysis
========================================
Dataset: 100 observations
Marketing Spend Range: $52,485 - $494,099
Sales Revenue Range: $351,573 - $1,843,663
Correlation: 0.985

Train-Test Split:
  Training set: 75 observations
  Test set: 25 observations

Model Coefficients:
  Intercept (β₀): $218,376.42
  Slope (β₁): 3.103

Business Interpretation:
  • Base sales (when marketing spend = $0): $218,376.42
  • For every additional $1,000 in marketing spend:
    Sales increase by $3,102.53
  • Marketing ROI: 3.10x ($3.10 revenue per $1 spent)

Model Performance:
  Training R²: 0.966 (96.6% variance explained)
  Test R²: 0.980 (98.0% variance explained)
  Training RMSE: $73,798.77
  Test RMSE: $67,269.54
  Test MAE: $51,040.81 (average prediction error)</code></pre>
</div>

<div class="cell-output cell-output-stdout">
<pre><code>
BUSINESS PREDICTIONS:
=========================
  Marketing Spend: $100,000
  Predicted Sales: $528,630
  Expected ROI: 5.29x
  Profit (assuming 20% margin): $5,726

  Marketing Spend: $250,000
  Predicted Sales: $994,010
  Expected ROI: 3.98x
  Profit (assuming 20% margin): $-51,198

  Marketing Spend: $400,000
  Predicted Sales: $1,459,389
  Expected ROI: 3.65x
  Profit (assuming 20% margin): $-108,122
</code></pre>
</div>
</div>
<img data-src="Week11-lecture-slides_files/figure-revealjs/cell-2-output-2.png" class="r-stretch"></section>
<section class="slide level2">

</section></section>
<section>
<section id="part-2-multiple-linear-regression" class="title-slide slide level1 smaller center">
<h1>Part 2: Multiple Linear Regression</h1>

</section>
<section id="multi-factor-business-predictions" class="slide level2">
<h2>Multi-Factor Business Predictions</h2>
<div id="baa375d9" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href=""></a><span class="bu">print</span>(<span class="st">"MULTIPLE LINEAR REGRESSION"</span>)</span>
<span id="cb4-2"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">35</span>)</span>
<span id="cb4-3"><a href=""></a></span>
<span id="cb4-4"><a href=""></a><span class="co"># Enhanced business scenario with multiple predictors</span></span>
<span id="cb4-5"><a href=""></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb4-6"><a href=""></a>n_companies <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb4-7"><a href=""></a></span>
<span id="cb4-8"><a href=""></a><span class="co"># Generate multiple business factors</span></span>
<span id="cb4-9"><a href=""></a>marketing_spend <span class="op">=</span> np.random.uniform(<span class="dv">50000</span>, <span class="dv">500000</span>, n_companies)</span>
<span id="cb4-10"><a href=""></a>num_employees <span class="op">=</span> np.random.uniform(<span class="dv">50</span>, <span class="dv">1000</span>, n_companies)</span>
<span id="cb4-11"><a href=""></a>years_in_business <span class="op">=</span> np.random.uniform(<span class="dv">1</span>, <span class="dv">25</span>, n_companies)</span>
<span id="cb4-12"><a href=""></a>customer_satisfaction <span class="op">=</span> np.random.uniform(<span class="fl">2.5</span>, <span class="fl">5.0</span>, n_companies)</span>
<span id="cb4-13"><a href=""></a>market_competition <span class="op">=</span> np.random.uniform(<span class="dv">1</span>, <span class="dv">10</span>, n_companies)  <span class="co"># 1=low, 10=high competition</span></span>
<span id="cb4-14"><a href=""></a></span>
<span id="cb4-15"><a href=""></a><span class="co"># Create realistic revenue model with multiple factors</span></span>
<span id="cb4-16"><a href=""></a>base_revenue <span class="op">=</span> <span class="dv">300000</span></span>
<span id="cb4-17"><a href=""></a>revenue <span class="op">=</span> (base_revenue <span class="op">+</span> </span>
<span id="cb4-18"><a href=""></a>          marketing_spend <span class="op">*</span> <span class="fl">2.8</span> <span class="op">+</span>          <span class="co"># Marketing effect</span></span>
<span id="cb4-19"><a href=""></a>          num_employees <span class="op">*</span> <span class="dv">800</span> <span class="op">+</span>            <span class="co"># Scale effect</span></span>
<span id="cb4-20"><a href=""></a>          years_in_business <span class="op">*</span> <span class="dv">15000</span> <span class="op">+</span>      <span class="co"># Experience effect</span></span>
<span id="cb4-21"><a href=""></a>          customer_satisfaction <span class="op">*</span> <span class="dv">120000</span> <span class="op">+</span> <span class="co"># Satisfaction premium</span></span>
<span id="cb4-22"><a href=""></a>          market_competition <span class="op">*</span> (<span class="op">-</span><span class="dv">25000</span>) <span class="op">+</span>  <span class="co"># Competition penalty</span></span>
<span id="cb4-23"><a href=""></a>          np.random.normal(<span class="dv">0</span>, <span class="dv">150000</span>, n_companies))  <span class="co"># Random noise</span></span>
<span id="cb4-24"><a href=""></a></span>
<span id="cb4-25"><a href=""></a><span class="co"># Ensure positive revenues</span></span>
<span id="cb4-26"><a href=""></a>revenue <span class="op">=</span> np.<span class="bu">abs</span>(revenue)</span>
<span id="cb4-27"><a href=""></a></span>
<span id="cb4-28"><a href=""></a><span class="co"># Create comprehensive business dataset</span></span>
<span id="cb4-29"><a href=""></a>business_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb4-30"><a href=""></a>    <span class="st">'Marketing_Spend'</span>: marketing_spend,</span>
<span id="cb4-31"><a href=""></a>    <span class="st">'Num_Employees'</span>: num_employees,</span>
<span id="cb4-32"><a href=""></a>    <span class="st">'Years_in_Business'</span>: years_in_business,</span>
<span id="cb4-33"><a href=""></a>    <span class="st">'Customer_Satisfaction'</span>: customer_satisfaction,</span>
<span id="cb4-34"><a href=""></a>    <span class="st">'Market_Competition'</span>: market_competition,</span>
<span id="cb4-35"><a href=""></a>    <span class="st">'Annual_Revenue'</span>: revenue</span>
<span id="cb4-36"><a href=""></a>})</span>
<span id="cb4-37"><a href=""></a></span>
<span id="cb4-38"><a href=""></a><span class="bu">print</span>(<span class="st">"Enhanced Business Dataset:"</span>)</span>
<span id="cb4-39"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">30</span>)</span>
<span id="cb4-40"><a href=""></a><span class="bu">print</span>(business_data.describe().<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb4-41"><a href=""></a></span>
<span id="cb4-42"><a href=""></a><span class="co"># Correlation analysis</span></span>
<span id="cb4-43"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Correlation with Revenue:"</span>)</span>
<span id="cb4-44"><a href=""></a>correlations <span class="op">=</span> business_data.corr()[<span class="st">'Annual_Revenue'</span>].sort_values(key<span class="op">=</span><span class="bu">abs</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb4-45"><a href=""></a><span class="cf">for</span> variable, corr <span class="kw">in</span> correlations.items():</span>
<span id="cb4-46"><a href=""></a>    <span class="cf">if</span> variable <span class="op">!=</span> <span class="st">'Annual_Revenue'</span>:</span>
<span id="cb4-47"><a href=""></a>        <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>corr<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb4-48"><a href=""></a></span>
<span id="cb4-49"><a href=""></a><span class="co"># Prepare features and target</span></span>
<span id="cb4-50"><a href=""></a>feature_columns <span class="op">=</span> [<span class="st">'Marketing_Spend'</span>, <span class="st">'Num_Employees'</span>, <span class="st">'Years_in_Business'</span>, </span>
<span id="cb4-51"><a href=""></a>                  <span class="st">'Customer_Satisfaction'</span>, <span class="st">'Market_Competition'</span>]</span>
<span id="cb4-52"><a href=""></a>X <span class="op">=</span> business_data[feature_columns]</span>
<span id="cb4-53"><a href=""></a>y <span class="op">=</span> business_data[<span class="st">'Annual_Revenue'</span>]</span>
<span id="cb4-54"><a href=""></a></span>
<span id="cb4-55"><a href=""></a><span class="co"># Train-test split</span></span>
<span id="cb4-56"><a href=""></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.25</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb4-57"><a href=""></a></span>
<span id="cb4-58"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Multiple Regression Model:"</span>)</span>
<span id="cb4-59"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Features: </span><span class="sc">{</span><span class="bu">len</span>(feature_columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-60"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Training samples: </span><span class="sc">{</span><span class="bu">len</span>(X_train)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-61"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Test samples: </span><span class="sc">{</span><span class="bu">len</span>(X_test)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-62"><a href=""></a></span>
<span id="cb4-63"><a href=""></a><span class="co"># Train multiple linear regression model</span></span>
<span id="cb4-64"><a href=""></a>mlr_model <span class="op">=</span> LinearRegression()</span>
<span id="cb4-65"><a href=""></a>mlr_model.fit(X_train, y_train)</span>
<span id="cb4-66"><a href=""></a></span>
<span id="cb4-67"><a href=""></a><span class="co"># Extract coefficients</span></span>
<span id="cb4-68"><a href=""></a>intercept_mlr <span class="op">=</span> mlr_model.intercept_</span>
<span id="cb4-69"><a href=""></a>coefficients <span class="op">=</span> mlr_model.coef_</span>
<span id="cb4-70"><a href=""></a></span>
<span id="cb4-71"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Model Coefficients:"</span>)</span>
<span id="cb4-72"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Intercept: $</span><span class="sc">{</span>intercept_mlr<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb4-73"><a href=""></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Feature Coefficients (holding other variables constant):"</span>)</span>
<span id="cb4-74"><a href=""></a><span class="cf">for</span> feature, coef <span class="kw">in</span> <span class="bu">zip</span>(feature_columns, coefficients):</span>
<span id="cb4-75"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>coef<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb4-76"><a href=""></a></span>
<span id="cb4-77"><a href=""></a><span class="co"># Detailed business interpretation</span></span>
<span id="cb4-78"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Business Interpretation:"</span>)</span>
<span id="cb4-79"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">25</span>)</span>
<span id="cb4-80"><a href=""></a>interpretations <span class="op">=</span> {</span>
<span id="cb4-81"><a href=""></a>    <span class="st">'Marketing_Spend'</span>: <span class="ss">f"Each additional $1,000 in marketing → $</span><span class="sc">{</span>coefficients[<span class="dv">0</span>]<span class="op">*</span><span class="dv">1000</span><span class="sc">:,.0f}</span><span class="ss"> more revenue"</span>,</span>
<span id="cb4-82"><a href=""></a>    <span class="st">'Num_Employees'</span>: <span class="ss">f"Each additional employee → $</span><span class="sc">{</span>coefficients[<span class="dv">1</span>]<span class="sc">:,.0f}</span><span class="ss"> more revenue"</span>,</span>
<span id="cb4-83"><a href=""></a>    <span class="st">'Years_in_Business'</span>: <span class="ss">f"Each additional year in business → $</span><span class="sc">{</span>coefficients[<span class="dv">2</span>]<span class="sc">:,.0f}</span><span class="ss"> more revenue"</span>,</span>
<span id="cb4-84"><a href=""></a>    <span class="st">'Customer_Satisfaction'</span>: <span class="ss">f"Each 1-point satisfaction increase → $</span><span class="sc">{</span>coefficients[<span class="dv">3</span>]<span class="sc">:,.0f}</span><span class="ss"> more revenue"</span>,</span>
<span id="cb4-85"><a href=""></a>    <span class="st">'Market_Competition'</span>: <span class="ss">f"Each competition level increase → $</span><span class="sc">{</span>coefficients[<span class="dv">4</span>]<span class="sc">:,.0f}</span><span class="ss"> revenue impact"</span></span>
<span id="cb4-86"><a href=""></a>}</span>
<span id="cb4-87"><a href=""></a></span>
<span id="cb4-88"><a href=""></a><span class="cf">for</span> feature, interpretation <span class="kw">in</span> interpretations.items():</span>
<span id="cb4-89"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  • </span><span class="sc">{</span>interpretation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-90"><a href=""></a></span>
<span id="cb4-91"><a href=""></a><span class="co"># Model predictions and evaluation</span></span>
<span id="cb4-92"><a href=""></a>y_train_pred_mlr <span class="op">=</span> mlr_model.predict(X_train)</span>
<span id="cb4-93"><a href=""></a>y_test_pred_mlr <span class="op">=</span> mlr_model.predict(X_test)</span>
<span id="cb4-94"><a href=""></a></span>
<span id="cb4-95"><a href=""></a><span class="co"># Performance metrics</span></span>
<span id="cb4-96"><a href=""></a>train_r2_mlr <span class="op">=</span> r2_score(y_train, y_train_pred_mlr)</span>
<span id="cb4-97"><a href=""></a>test_r2_mlr <span class="op">=</span> r2_score(y_test, y_test_pred_mlr)</span>
<span id="cb4-98"><a href=""></a>train_rmse_mlr <span class="op">=</span> np.sqrt(mean_squared_error(y_train, y_train_pred_mlr))</span>
<span id="cb4-99"><a href=""></a>test_rmse_mlr <span class="op">=</span> np.sqrt(mean_squared_error(y_test, y_test_pred_mlr))</span>
<span id="cb4-100"><a href=""></a>test_mae_mlr <span class="op">=</span> mean_absolute_error(y_test, y_test_pred_mlr)</span>
<span id="cb4-101"><a href=""></a></span>
<span id="cb4-102"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Multiple Regression Performance:"</span>)</span>
<span id="cb4-103"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Training R²: </span><span class="sc">{</span>train_r2_mlr<span class="sc">:.3f}</span><span class="ss"> (</span><span class="sc">{</span>train_r2_mlr<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% variance explained)"</span>)</span>
<span id="cb4-104"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Test R²: </span><span class="sc">{</span>test_r2_mlr<span class="sc">:.3f}</span><span class="ss"> (</span><span class="sc">{</span>test_r2_mlr<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% variance explained)"</span>)</span>
<span id="cb4-105"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Test RMSE: $</span><span class="sc">{</span>test_rmse_mlr<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb4-106"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Test MAE: $</span><span class="sc">{</span>test_mae_mlr<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb4-107"><a href=""></a></span>
<span id="cb4-108"><a href=""></a><span class="co"># Compare with simple regression (using only marketing spend)</span></span>
<span id="cb4-109"><a href=""></a>X_simple <span class="op">=</span> X_train[[<span class="st">'Marketing_Spend'</span>]]</span>
<span id="cb4-110"><a href=""></a>X_test_simple <span class="op">=</span> X_test[[<span class="st">'Marketing_Spend'</span>]]</span>
<span id="cb4-111"><a href=""></a></span>
<span id="cb4-112"><a href=""></a>simple_model <span class="op">=</span> LinearRegression()</span>
<span id="cb4-113"><a href=""></a>simple_model.fit(X_simple, y_train)</span>
<span id="cb4-114"><a href=""></a>y_test_pred_simple <span class="op">=</span> simple_model.predict(X_test_simple)</span>
<span id="cb4-115"><a href=""></a>test_r2_simple <span class="op">=</span> r2_score(y_test, y_test_pred_simple)</span>
<span id="cb4-116"><a href=""></a></span>
<span id="cb4-117"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Model Comparison:"</span>)</span>
<span id="cb4-118"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Simple Regression R²: </span><span class="sc">{</span>test_r2_simple<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb4-119"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Multiple Regression R²: </span><span class="sc">{</span>test_r2_mlr<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb4-120"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Improvement: </span><span class="sc">{</span>test_r2_mlr <span class="op">-</span> test_r2_simple<span class="sc">:.3f}</span><span class="ss"> (</span><span class="sc">{</span>((test_r2_mlr<span class="op">/</span>test_r2_simple)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% better)"</span>)</span>
<span id="cb4-121"><a href=""></a></span>
<span id="cb4-122"><a href=""></a><span class="co"># Comprehensive visualization</span></span>
<span id="cb4-123"><a href=""></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">12</span>))</span>
<span id="cb4-124"><a href=""></a></span>
<span id="cb4-125"><a href=""></a><span class="co"># 1. Feature importance (coefficient magnitudes)</span></span>
<span id="cb4-126"><a href=""></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb4-127"><a href=""></a>coef_abs <span class="op">=</span> np.<span class="bu">abs</span>(coefficients)</span>
<span id="cb4-128"><a href=""></a>colors <span class="op">=</span> [<span class="st">'green'</span> <span class="cf">if</span> coef <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">'red'</span> <span class="cf">for</span> coef <span class="kw">in</span> coefficients]</span>
<span id="cb4-129"><a href=""></a>bars <span class="op">=</span> ax1.barh(<span class="bu">range</span>(<span class="bu">len</span>(feature_columns)), coef_abs, color<span class="op">=</span>colors, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb4-130"><a href=""></a>ax1.set_yticks(<span class="bu">range</span>(<span class="bu">len</span>(feature_columns)))</span>
<span id="cb4-131"><a href=""></a>ax1.set_yticklabels([col.replace(<span class="st">'_'</span>, <span class="st">' '</span>) <span class="cf">for</span> col <span class="kw">in</span> feature_columns])</span>
<span id="cb4-132"><a href=""></a>ax1.set_xlabel(<span class="st">'Absolute Coefficient Value'</span>)</span>
<span id="cb4-133"><a href=""></a>ax1.set_title(<span class="st">'Feature Importance</span><span class="ch">\n</span><span class="st">(Green=Positive, Red=Negative)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb4-134"><a href=""></a>ax1.grid(axis<span class="op">=</span><span class="st">'x'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb4-135"><a href=""></a></span>
<span id="cb4-136"><a href=""></a><span class="co"># 2. Predicted vs Actual (Multiple Regression)</span></span>
<span id="cb4-137"><a href=""></a>ax2 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb4-138"><a href=""></a>ax2.scatter(y_test, y_test_pred_mlr, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'blue'</span>, s<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb4-139"><a href=""></a>min_val <span class="op">=</span> <span class="bu">min</span>(y_test.<span class="bu">min</span>(), y_test_pred_mlr.<span class="bu">min</span>())</span>
<span id="cb4-140"><a href=""></a>max_val <span class="op">=</span> <span class="bu">max</span>(y_test.<span class="bu">max</span>(), y_test_pred_mlr.<span class="bu">max</span>())</span>
<span id="cb4-141"><a href=""></a>ax2.plot([min_val, max_val], [min_val, max_val], <span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Perfect Prediction'</span>)</span>
<span id="cb4-142"><a href=""></a>ax2.set_xlabel(<span class="st">'Actual Revenue ($)'</span>)</span>
<span id="cb4-143"><a href=""></a>ax2.set_ylabel(<span class="st">'Predicted Revenue ($)'</span>)</span>
<span id="cb4-144"><a href=""></a>ax2.set_title(<span class="ss">f'Multiple Regression</span><span class="ch">\n</span><span class="ss">R² = </span><span class="sc">{</span>test_r2_mlr<span class="sc">:.3f}</span><span class="ss">'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb4-145"><a href=""></a>ax2.legend()</span>
<span id="cb4-146"><a href=""></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb4-147"><a href=""></a></span>
<span id="cb4-148"><a href=""></a><span class="co"># 3. Residuals vs Fitted</span></span>
<span id="cb4-149"><a href=""></a>ax3 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">2</span>]</span>
<span id="cb4-150"><a href=""></a>residuals_mlr <span class="op">=</span> y_test <span class="op">-</span> y_test_pred_mlr</span>
<span id="cb4-151"><a href=""></a>ax3.scatter(y_test_pred_mlr, residuals_mlr, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb4-152"><a href=""></a>ax3.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb4-153"><a href=""></a>ax3.set_xlabel(<span class="st">'Fitted Values ($)'</span>)</span>
<span id="cb4-154"><a href=""></a>ax3.set_ylabel(<span class="st">'Residuals ($)'</span>)</span>
<span id="cb4-155"><a href=""></a>ax3.set_title(<span class="st">'Residuals vs Fitted Values'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb4-156"><a href=""></a>ax3.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb4-157"><a href=""></a></span>
<span id="cb4-158"><a href=""></a><span class="co"># 4. Feature correlation heatmap</span></span>
<span id="cb4-159"><a href=""></a>ax4 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb4-160"><a href=""></a>feature_corr <span class="op">=</span> business_data[feature_columns <span class="op">+</span> [<span class="st">'Annual_Revenue'</span>]].corr()</span>
<span id="cb4-161"><a href=""></a>im <span class="op">=</span> ax4.imshow(feature_corr, cmap<span class="op">=</span><span class="st">'RdBu_r'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-162"><a href=""></a>ax4.set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(feature_corr.columns)))</span>
<span id="cb4-163"><a href=""></a>ax4.set_yticks(<span class="bu">range</span>(<span class="bu">len</span>(feature_corr.columns)))</span>
<span id="cb4-164"><a href=""></a>ax4.set_xticklabels([col.replace(<span class="st">'_'</span>, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>) <span class="cf">for</span> col <span class="kw">in</span> feature_corr.columns], rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb4-165"><a href=""></a>ax4.set_yticklabels([col.replace(<span class="st">'_'</span>, <span class="st">' '</span>) <span class="cf">for</span> col <span class="kw">in</span> feature_corr.columns])</span>
<span id="cb4-166"><a href=""></a></span>
<span id="cb4-167"><a href=""></a><span class="co"># Add correlation values</span></span>
<span id="cb4-168"><a href=""></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(feature_corr.columns)):</span>
<span id="cb4-169"><a href=""></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(feature_corr.columns)):</span>
<span id="cb4-170"><a href=""></a>        ax4.text(j, i, <span class="ss">f'</span><span class="sc">{</span>feature_corr<span class="sc">.</span>iloc[i, j]<span class="sc">:.2f}</span><span class="ss">'</span>,</span>
<span id="cb4-171"><a href=""></a>                ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb4-172"><a href=""></a>                color<span class="op">=</span><span class="st">'white'</span> <span class="cf">if</span> <span class="bu">abs</span>(feature_corr.iloc[i, j]) <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'black'</span>)</span>
<span id="cb4-173"><a href=""></a></span>
<span id="cb4-174"><a href=""></a>ax4.set_title(<span class="st">'Feature Correlation Matrix'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb4-175"><a href=""></a></span>
<span id="cb4-176"><a href=""></a><span class="co"># 5. Model comparison</span></span>
<span id="cb4-177"><a href=""></a>ax5 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb4-178"><a href=""></a>model_names <span class="op">=</span> [<span class="st">'Simple</span><span class="ch">\n</span><span class="st">(Marketing Only)'</span>, <span class="st">'Multiple</span><span class="ch">\n</span><span class="st">(All Features)'</span>]</span>
<span id="cb4-179"><a href=""></a>r2_values <span class="op">=</span> [test_r2_simple, test_r2_mlr]</span>
<span id="cb4-180"><a href=""></a>bars <span class="op">=</span> ax5.bar(model_names, r2_values, color<span class="op">=</span>[<span class="st">'lightblue'</span>, <span class="st">'darkblue'</span>], alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb4-181"><a href=""></a></span>
<span id="cb4-182"><a href=""></a><span class="co"># Add value labels</span></span>
<span id="cb4-183"><a href=""></a><span class="cf">for</span> bar, value <span class="kw">in</span> <span class="bu">zip</span>(bars, r2_values):</span>
<span id="cb4-184"><a href=""></a>    height <span class="op">=</span> bar.get_height()</span>
<span id="cb4-185"><a href=""></a>    ax5.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="fl">2.</span>, height <span class="op">+</span> <span class="fl">0.01</span>,</span>
<span id="cb4-186"><a href=""></a>             <span class="ss">f'</span><span class="sc">{</span>value<span class="sc">:.3f}</span><span class="ss">'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb4-187"><a href=""></a></span>
<span id="cb4-188"><a href=""></a>ax5.set_ylabel(<span class="st">'R² Score'</span>)</span>
<span id="cb4-189"><a href=""></a>ax5.set_title(<span class="st">'Model Performance Comparison'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb4-190"><a href=""></a>ax5.set_ylim(<span class="dv">0</span>, <span class="bu">max</span>(r2_values) <span class="op">+</span> <span class="fl">0.1</span>)</span>
<span id="cb4-191"><a href=""></a>ax5.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb4-192"><a href=""></a></span>
<span id="cb4-193"><a href=""></a><span class="co"># 6. Distribution of residuals</span></span>
<span id="cb4-194"><a href=""></a>ax6 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb4-195"><a href=""></a>ax6.hist(residuals_mlr, bins<span class="op">=</span><span class="dv">20</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'lightgreen'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb4-196"><a href=""></a>ax6.axvline(residuals_mlr.mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb4-197"><a href=""></a>           label<span class="op">=</span><span class="ss">f'Mean: $</span><span class="sc">{</span>residuals_mlr<span class="sc">.</span>mean()<span class="sc">:,.0f}</span><span class="ss">'</span>)</span>
<span id="cb4-198"><a href=""></a>ax6.set_xlabel(<span class="st">'Residuals ($)'</span>)</span>
<span id="cb4-199"><a href=""></a>ax6.set_ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb4-200"><a href=""></a>ax6.set_title(<span class="st">'Residual Distribution'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb4-201"><a href=""></a>ax6.legend()</span>
<span id="cb4-202"><a href=""></a>ax6.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb4-203"><a href=""></a></span>
<span id="cb4-204"><a href=""></a>plt.tight_layout()</span>
<span id="cb4-205"><a href=""></a>plt.show()</span>
<span id="cb4-206"><a href=""></a></span>
<span id="cb4-207"><a href=""></a><span class="co"># Business scenario predictions</span></span>
<span id="cb4-208"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">BUSINESS SCENARIO PREDICTIONS:"</span>)</span>
<span id="cb4-209"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">40</span>)</span>
<span id="cb4-210"><a href=""></a></span>
<span id="cb4-211"><a href=""></a>scenarios <span class="op">=</span> [</span>
<span id="cb4-212"><a href=""></a>    {<span class="st">'name'</span>: <span class="st">'Small Startup'</span>, <span class="st">'Marketing_Spend'</span>: <span class="dv">75000</span>, <span class="st">'Num_Employees'</span>: <span class="dv">25</span>, </span>
<span id="cb4-213"><a href=""></a>     <span class="st">'Years_in_Business'</span>: <span class="dv">2</span>, <span class="st">'Customer_Satisfaction'</span>: <span class="fl">4.2</span>, <span class="st">'Market_Competition'</span>: <span class="dv">7</span>},</span>
<span id="cb4-214"><a href=""></a>    {<span class="st">'name'</span>: <span class="st">'Established Company'</span>, <span class="st">'Marketing_Spend'</span>: <span class="dv">300000</span>, <span class="st">'Num_Employees'</span>: <span class="dv">200</span>, </span>
<span id="cb4-215"><a href=""></a>     <span class="st">'Years_in_Business'</span>: <span class="dv">12</span>, <span class="st">'Customer_Satisfaction'</span>: <span class="fl">3.8</span>, <span class="st">'Market_Competition'</span>: <span class="dv">5</span>},</span>
<span id="cb4-216"><a href=""></a>    {<span class="st">'name'</span>: <span class="st">'Market Leader'</span>, <span class="st">'Marketing_Spend'</span>: <span class="dv">450000</span>, <span class="st">'Num_Employees'</span>: <span class="dv">500</span>, </span>
<span id="cb4-217"><a href=""></a>     <span class="st">'Years_in_Business'</span>: <span class="dv">20</span>, <span class="st">'Customer_Satisfaction'</span>: <span class="fl">4.5</span>, <span class="st">'Market_Competition'</span>: <span class="dv">3</span>}</span>
<span id="cb4-218"><a href=""></a>]</span>
<span id="cb4-219"><a href=""></a></span>
<span id="cb4-220"><a href=""></a><span class="cf">for</span> scenario <span class="kw">in</span> scenarios:</span>
<span id="cb4-221"><a href=""></a>    scenario_data <span class="op">=</span> pd.DataFrame([scenario])</span>
<span id="cb4-222"><a href=""></a>    scenario_features <span class="op">=</span> scenario_data[feature_columns]</span>
<span id="cb4-223"><a href=""></a>    predicted_revenue <span class="op">=</span> mlr_model.predict(scenario_features)[<span class="dv">0</span>]</span>
<span id="cb4-224"><a href=""></a>    </span>
<span id="cb4-225"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>scenario[<span class="st">'name'</span>]<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb4-226"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  Marketing Spend: $</span><span class="sc">{</span>scenario[<span class="st">'Marketing_Spend'</span>]<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb4-227"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  Employees: </span><span class="sc">{</span>scenario[<span class="st">'Num_Employees'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-228"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  Years in Business: </span><span class="sc">{</span>scenario[<span class="st">'Years_in_Business'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-229"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  Customer Satisfaction: </span><span class="sc">{</span>scenario[<span class="st">'Customer_Satisfaction'</span>]<span class="sc">:.1f}</span><span class="ss">"</span>)</span>
<span id="cb4-230"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  Market Competition: </span><span class="sc">{</span>scenario[<span class="st">'Market_Competition'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-231"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  → Predicted Revenue: $</span><span class="sc">{</span>predicted_revenue<span class="sc">:,.0f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MULTIPLE LINEAR REGRESSION
===================================
Enhanced Business Dataset:
==============================
       Marketing_Spend  Num_Employees  Years_in_Business  \
count           200.00         200.00             200.00   
mean         267802.80         529.16              13.50   
std          132701.14         278.35               7.38   
min           52484.95          54.81               1.26   
25%          152862.09         298.39               7.13   
50%          272518.81         564.56              13.61   
75%          390586.83         755.09              20.47   
max          494099.12         990.98              24.99   

       Customer_Satisfaction  Market_Competition  Annual_Revenue  
count                 200.00              200.00          200.00  
mean                    3.70                5.17      2010499.26  
std                     0.70                2.57       457446.28  
min                     2.55                1.04       984048.93  
25%                     3.09                2.88      1661873.66  
50%                     3.67                4.99      2013970.72  
75%                     4.31                7.21      2332656.93  
max                     4.97                9.97      3056096.45  

Correlation with Revenue:
  Marketing_Spend: 0.731
  Num_Employees: 0.466
  Years_in_Business: 0.202
  Market_Competition: -0.201
  Customer_Satisfaction: 0.184

Multiple Regression Model:
  Features: 5
  Training samples: 150
  Test samples: 50

Model Coefficients:
  Intercept: $373,351.41

Feature Coefficients (holding other variables constant):
  Marketing_Spend: 2.65
  Num_Employees: 805.25
  Years_in_Business: 16917.59
  Customer_Satisfaction: 117487.82
  Market_Competition: -30040.29

Business Interpretation:
=========================
  • Each additional $1,000 in marketing → $2,646 more revenue
  • Each additional employee → $805 more revenue
  • Each additional year in business → $16,918 more revenue
  • Each 1-point satisfaction increase → $117,488 more revenue
  • Each competition level increase → $-30,040 revenue impact

Multiple Regression Performance:
  Training R²: 0.911 (91.1% variance explained)
  Test R²: 0.902 (90.2% variance explained)
  Test RMSE: $141,261.60
  Test MAE: $107,316.93

Model Comparison:
  Simple Regression R²: 0.463
  Multiple Regression R²: 0.902
  Improvement: 0.439 (94.8% better)</code></pre>
</div>

<div class="cell-output cell-output-stdout">
<pre><code>
BUSINESS SCENARIO PREDICTIONS:
========================================

Small Startup:
  Marketing Spend: $75,000
  Employees: 25
  Years in Business: 2
  Customer Satisfaction: 4.2
  Market Competition: 7
  → Predicted Revenue: $908,920

Established Company:
  Marketing Spend: $300,000
  Employees: 200
  Years in Business: 12
  Customer Satisfaction: 3.8
  Market Competition: 5
  → Predicted Revenue: $1,827,407

Market Leader:
  Marketing Spend: $450,000
  Employees: 500
  Years in Business: 20
  Customer Satisfaction: 4.5
  Market Competition: 3
  → Predicted Revenue: $2,743,515</code></pre>
</div>
</div>
<img data-src="Week11-lecture-slides_files/figure-revealjs/cell-3-output-2.png" class="r-stretch"></section>
<section class="slide level2">

</section></section>
<section>
<section id="part-3-model-evaluation-and-validation" class="title-slide slide level1 smaller center">
<h1>Part 3: Model Evaluation and Validation</h1>

</section>
<section id="assessing-predictive-performance" class="slide level2">
<h2>Assessing Predictive Performance</h2>
<div id="358b0104" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href=""></a><span class="bu">print</span>(<span class="st">"COMPREHENSIVE MODEL EVALUATION"</span>)</span>
<span id="cb7-2"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">40</span>)</span>
<span id="cb7-3"><a href=""></a></span>
<span id="cb7-4"><a href=""></a><span class="co"># Advanced model evaluation techniques</span></span>
<span id="cb7-5"><a href=""></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb7-6"><a href=""></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb7-7"><a href=""></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb7-8"><a href=""></a></span>
<span id="cb7-9"><a href=""></a><span class="co"># Create evaluation framework</span></span>
<span id="cb7-10"><a href=""></a>evaluation_results <span class="op">=</span> {}</span>
<span id="cb7-11"><a href=""></a></span>
<span id="cb7-12"><a href=""></a><span class="co"># 1. Cross-validation for robust evaluation</span></span>
<span id="cb7-13"><a href=""></a><span class="bu">print</span>(<span class="st">"1. CROSS-VALIDATION ANALYSIS:"</span>)</span>
<span id="cb7-14"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">35</span>)</span>
<span id="cb7-15"><a href=""></a></span>
<span id="cb7-16"><a href=""></a><span class="co"># Create pipeline with standardization</span></span>
<span id="cb7-17"><a href=""></a>pipeline <span class="op">=</span> Pipeline([</span>
<span id="cb7-18"><a href=""></a>    (<span class="st">'scaler'</span>, StandardScaler()),</span>
<span id="cb7-19"><a href=""></a>    (<span class="st">'model'</span>, LinearRegression())</span>
<span id="cb7-20"><a href=""></a>])</span>
<span id="cb7-21"><a href=""></a></span>
<span id="cb7-22"><a href=""></a><span class="co"># 5-fold cross-validation</span></span>
<span id="cb7-23"><a href=""></a>cv_scores <span class="op">=</span> cross_val_score(pipeline, X, y, cv<span class="op">=</span><span class="dv">5</span>, scoring<span class="op">=</span><span class="st">'r2'</span>)</span>
<span id="cb7-24"><a href=""></a>cv_rmse_scores <span class="op">=</span> <span class="op">-</span>cross_val_score(pipeline, X, y, cv<span class="op">=</span><span class="dv">5</span>, scoring<span class="op">=</span><span class="st">'neg_root_mean_squared_error'</span>)</span>
<span id="cb7-25"><a href=""></a></span>
<span id="cb7-26"><a href=""></a><span class="bu">print</span>(<span class="ss">f"5-Fold Cross-Validation Results:"</span>)</span>
<span id="cb7-27"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  R² Scores: </span><span class="sc">{</span>cv_scores<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-28"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Mean R²: </span><span class="sc">{</span>cv_scores<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss"> (±</span><span class="sc">{</span>cv_scores<span class="sc">.</span>std()<span class="sc">:.3f}</span><span class="ss">)"</span>)</span>
<span id="cb7-29"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  RMSE Scores: $</span><span class="sc">{</span>cv_rmse_scores<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-30"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Mean RMSE: $</span><span class="sc">{</span>cv_rmse_scores<span class="sc">.</span>mean()<span class="sc">:,.0f}</span><span class="ss"> (±$</span><span class="sc">{</span>cv_rmse_scores<span class="sc">.</span>std()<span class="sc">:,.0f}</span><span class="ss">)"</span>)</span>
<span id="cb7-31"><a href=""></a></span>
<span id="cb7-32"><a href=""></a><span class="co"># 2. Feature importance analysis</span></span>
<span id="cb7-33"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">2. FEATURE IMPORTANCE ANALYSIS:"</span>)</span>
<span id="cb7-34"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">38</span>)</span>
<span id="cb7-35"><a href=""></a></span>
<span id="cb7-36"><a href=""></a><span class="co"># Standardize features to compare coefficients fairly</span></span>
<span id="cb7-37"><a href=""></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb7-38"><a href=""></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb7-39"><a href=""></a>standardized_model <span class="op">=</span> LinearRegression()</span>
<span id="cb7-40"><a href=""></a>standardized_model.fit(X_scaled, y)</span>
<span id="cb7-41"><a href=""></a></span>
<span id="cb7-42"><a href=""></a><span class="co"># Standardized coefficients show relative importance</span></span>
<span id="cb7-43"><a href=""></a>std_coefficients <span class="op">=</span> standardized_model.coef_</span>
<span id="cb7-44"><a href=""></a>feature_importance <span class="op">=</span> pd.DataFrame({</span>
<span id="cb7-45"><a href=""></a>    <span class="st">'Feature'</span>: feature_columns,</span>
<span id="cb7-46"><a href=""></a>    <span class="st">'Coefficient'</span>: coefficients,</span>
<span id="cb7-47"><a href=""></a>    <span class="st">'Std_Coefficient'</span>: std_coefficients,</span>
<span id="cb7-48"><a href=""></a>    <span class="st">'Abs_Std_Coef'</span>: np.<span class="bu">abs</span>(std_coefficients)</span>
<span id="cb7-49"><a href=""></a>}).sort_values(<span class="st">'Abs_Std_Coef'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb7-50"><a href=""></a></span>
<span id="cb7-51"><a href=""></a><span class="bu">print</span>(<span class="st">"Feature Importance Ranking (by standardized coefficients):"</span>)</span>
<span id="cb7-52"><a href=""></a><span class="cf">for</span> i, (_, row) <span class="kw">in</span> <span class="bu">enumerate</span>(feature_importance.iterrows(), <span class="dv">1</span>):</span>
<span id="cb7-53"><a href=""></a>    direction <span class="op">=</span> <span class="st">"increases"</span> <span class="cf">if</span> row[<span class="st">'Std_Coefficient'</span>] <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">"decreases"</span></span>
<span id="cb7-54"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">. </span><span class="sc">{</span>row[<span class="st">'Feature'</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> revenue (impact: </span><span class="sc">{</span>row[<span class="st">'Abs_Std_Coef'</span>]<span class="sc">:.3f}</span><span class="ss">)"</span>)</span>
<span id="cb7-55"><a href=""></a></span>
<span id="cb7-56"><a href=""></a><span class="co"># 3. Prediction intervals</span></span>
<span id="cb7-57"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">3. PREDICTION INTERVALS:"</span>)</span>
<span id="cb7-58"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">28</span>)</span>
<span id="cb7-59"><a href=""></a></span>
<span id="cb7-60"><a href=""></a><span class="co"># Calculate prediction intervals for new observations</span></span>
<span id="cb7-61"><a href=""></a><span class="kw">def</span> prediction_interval(model, X_new, X_train, y_train, confidence<span class="op">=</span><span class="fl">0.95</span>):</span>
<span id="cb7-62"><a href=""></a>    <span class="co">"""Calculate prediction intervals for new observations."""</span></span>
<span id="cb7-63"><a href=""></a>    <span class="co"># Predictions</span></span>
<span id="cb7-64"><a href=""></a>    y_pred <span class="op">=</span> model.predict(X_new)</span>
<span id="cb7-65"><a href=""></a>    </span>
<span id="cb7-66"><a href=""></a>    <span class="co"># Calculate residual standard error</span></span>
<span id="cb7-67"><a href=""></a>    y_train_pred <span class="op">=</span> model.predict(X_train)</span>
<span id="cb7-68"><a href=""></a>    residuals <span class="op">=</span> y_train <span class="op">-</span> y_train_pred</span>
<span id="cb7-69"><a href=""></a>    residual_se <span class="op">=</span> np.sqrt(np.<span class="bu">sum</span>(residuals<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> (<span class="bu">len</span>(y_train) <span class="op">-</span> X_train.shape[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb7-70"><a href=""></a>    </span>
<span id="cb7-71"><a href=""></a>    <span class="co"># Standard error of prediction</span></span>
<span id="cb7-72"><a href=""></a>    <span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb7-73"><a href=""></a>    t_critical <span class="op">=</span> stats.t.ppf((<span class="dv">1</span> <span class="op">+</span> confidence) <span class="op">/</span> <span class="dv">2</span>, <span class="bu">len</span>(y_train) <span class="op">-</span> X_train.shape[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb7-74"><a href=""></a>    </span>
<span id="cb7-75"><a href=""></a>    <span class="co"># Simplified prediction interval (assumes homoscedasticity)</span></span>
<span id="cb7-76"><a href=""></a>    margin_error <span class="op">=</span> t_critical <span class="op">*</span> residual_se <span class="op">*</span> np.sqrt(<span class="dv">1</span> <span class="op">+</span> <span class="dv">1</span><span class="op">/</span><span class="bu">len</span>(y_train))</span>
<span id="cb7-77"><a href=""></a>    </span>
<span id="cb7-78"><a href=""></a>    lower_bound <span class="op">=</span> y_pred <span class="op">-</span> margin_error</span>
<span id="cb7-79"><a href=""></a>    upper_bound <span class="op">=</span> y_pred <span class="op">+</span> margin_error</span>
<span id="cb7-80"><a href=""></a>    </span>
<span id="cb7-81"><a href=""></a>    <span class="cf">return</span> y_pred, lower_bound, upper_bound</span>
<span id="cb7-82"><a href=""></a></span>
<span id="cb7-83"><a href=""></a><span class="co"># Example prediction with intervals</span></span>
<span id="cb7-84"><a href=""></a>example_company <span class="op">=</span> pd.DataFrame({</span>
<span id="cb7-85"><a href=""></a>    <span class="st">'Marketing_Spend'</span>: [<span class="dv">200000</span>],</span>
<span id="cb7-86"><a href=""></a>    <span class="st">'Num_Employees'</span>: [<span class="dv">150</span>],</span>
<span id="cb7-87"><a href=""></a>    <span class="st">'Years_in_Business'</span>: [<span class="dv">8</span>],</span>
<span id="cb7-88"><a href=""></a>    <span class="st">'Customer_Satisfaction'</span>: [<span class="fl">4.0</span>],</span>
<span id="cb7-89"><a href=""></a>    <span class="st">'Market_Competition'</span>: [<span class="dv">5</span>]</span>
<span id="cb7-90"><a href=""></a>})</span>
<span id="cb7-91"><a href=""></a></span>
<span id="cb7-92"><a href=""></a>pred, lower, upper <span class="op">=</span> prediction_interval(mlr_model, example_company, X_train, y_train)</span>
<span id="cb7-93"><a href=""></a></span>
<span id="cb7-94"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Example Company Prediction:"</span>)</span>
<span id="cb7-95"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Point Estimate: $</span><span class="sc">{</span>pred[<span class="dv">0</span>]<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb7-96"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  95% Prediction Interval: [$</span><span class="sc">{</span>lower[<span class="dv">0</span>]<span class="sc">:,.0f}</span><span class="ss">, $</span><span class="sc">{</span>upper[<span class="dv">0</span>]<span class="sc">:,.0f}</span><span class="ss">]"</span>)</span>
<span id="cb7-97"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Interval Width: $</span><span class="sc">{</span>upper[<span class="dv">0</span>] <span class="op">-</span> lower[<span class="dv">0</span>]<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb7-98"><a href=""></a></span>
<span id="cb7-99"><a href=""></a><span class="co"># 4. Residual analysis for model assumptions</span></span>
<span id="cb7-100"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">4. MODEL ASSUMPTIONS CHECK:"</span>)</span>
<span id="cb7-101"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">32</span>)</span>
<span id="cb7-102"><a href=""></a></span>
<span id="cb7-103"><a href=""></a><span class="co"># Calculate residuals</span></span>
<span id="cb7-104"><a href=""></a>residuals <span class="op">=</span> y_test <span class="op">-</span> y_test_pred_mlr</span>
<span id="cb7-105"><a href=""></a></span>
<span id="cb7-106"><a href=""></a><span class="co"># Normality test</span></span>
<span id="cb7-107"><a href=""></a><span class="im">from</span> scipy.stats <span class="im">import</span> shapiro, jarque_bera</span>
<span id="cb7-108"><a href=""></a>shapiro_stat, shapiro_p <span class="op">=</span> shapiro(residuals)</span>
<span id="cb7-109"><a href=""></a>jb_stat, jb_p <span class="op">=</span> jarque_bera(residuals)</span>
<span id="cb7-110"><a href=""></a></span>
<span id="cb7-111"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Normality Tests:"</span>)</span>
<span id="cb7-112"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Shapiro-Wilk p-value: </span><span class="sc">{</span>shapiro_p<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb7-113"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Jarque-Bera p-value: </span><span class="sc">{</span>jb_p<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb7-114"><a href=""></a></span>
<span id="cb7-115"><a href=""></a><span class="cf">if</span> shapiro_p <span class="op">&gt;</span> <span class="fl">0.05</span> <span class="kw">and</span> jb_p <span class="op">&gt;</span> <span class="fl">0.05</span>:</span>
<span id="cb7-116"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  → Residuals appear normally distributed ✓"</span>)</span>
<span id="cb7-117"><a href=""></a><span class="cf">else</span>:</span>
<span id="cb7-118"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  → Residuals may not be normally distributed ⚠"</span>)</span>
<span id="cb7-119"><a href=""></a></span>
<span id="cb7-120"><a href=""></a><span class="co"># Homoscedasticity check</span></span>
<span id="cb7-121"><a href=""></a>correlation_resid_fitted <span class="op">=</span> np.corrcoef(y_test_pred_mlr, np.<span class="bu">abs</span>(residuals))[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb7-122"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Homoscedasticity Check:"</span>)</span>
<span id="cb7-123"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Correlation(|residuals|, fitted): </span><span class="sc">{</span>correlation_resid_fitted<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb7-124"><a href=""></a></span>
<span id="cb7-125"><a href=""></a><span class="cf">if</span> <span class="bu">abs</span>(correlation_resid_fitted) <span class="op">&lt;</span> <span class="fl">0.3</span>:</span>
<span id="cb7-126"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  → Constant variance assumption appears satisfied ✓"</span>)</span>
<span id="cb7-127"><a href=""></a><span class="cf">else</span>:</span>
<span id="cb7-128"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  → Potential heteroscedasticity detected ⚠"</span>)</span>
<span id="cb7-129"><a href=""></a></span>
<span id="cb7-130"><a href=""></a><span class="co"># 5. Model comparison summary</span></span>
<span id="cb7-131"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">5. MODEL COMPARISON SUMMARY:"</span>)</span>
<span id="cb7-132"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">35</span>)</span>
<span id="cb7-133"><a href=""></a></span>
<span id="cb7-134"><a href=""></a>models <span class="op">=</span> {</span>
<span id="cb7-135"><a href=""></a>    <span class="st">'Simple Linear Regression'</span>: {</span>
<span id="cb7-136"><a href=""></a>        <span class="st">'R²'</span>: test_r2_simple,</span>
<span id="cb7-137"><a href=""></a>        <span class="st">'Features'</span>: <span class="dv">1</span>,</span>
<span id="cb7-138"><a href=""></a>        <span class="st">'Complexity'</span>: <span class="st">'Low'</span>,</span>
<span id="cb7-139"><a href=""></a>        <span class="st">'Interpretability'</span>: <span class="st">'High'</span></span>
<span id="cb7-140"><a href=""></a>    },</span>
<span id="cb7-141"><a href=""></a>    <span class="st">'Multiple Linear Regression'</span>: {</span>
<span id="cb7-142"><a href=""></a>        <span class="st">'R²'</span>: test_r2_mlr,</span>
<span id="cb7-143"><a href=""></a>        <span class="st">'Features'</span>: <span class="bu">len</span>(feature_columns),</span>
<span id="cb7-144"><a href=""></a>        <span class="st">'Complexity'</span>: <span class="st">'Medium'</span>,</span>
<span id="cb7-145"><a href=""></a>        <span class="st">'Interpretability'</span>: <span class="st">'Medium'</span></span>
<span id="cb7-146"><a href=""></a>    }</span>
<span id="cb7-147"><a href=""></a>}</span>
<span id="cb7-148"><a href=""></a></span>
<span id="cb7-149"><a href=""></a>comparison_df <span class="op">=</span> pd.DataFrame(models).T</span>
<span id="cb7-150"><a href=""></a><span class="bu">print</span>(comparison_df)</span>
<span id="cb7-151"><a href=""></a></span>
<span id="cb7-152"><a href=""></a><span class="co"># Business value assessment</span></span>
<span id="cb7-153"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">6. BUSINESS VALUE ASSESSMENT:"</span>)</span>
<span id="cb7-154"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">35</span>)</span>
<span id="cb7-155"><a href=""></a></span>
<span id="cb7-156"><a href=""></a><span class="co"># Calculate improvement in prediction accuracy</span></span>
<span id="cb7-157"><a href=""></a>rmse_improvement <span class="op">=</span> test_rmse <span class="op">-</span> test_rmse_mlr  <span class="co"># Assuming test_rmse from simple model</span></span>
<span id="cb7-158"><a href=""></a>improvement_percentage <span class="op">=</span> (rmse_improvement <span class="op">/</span> test_rmse) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb7-159"><a href=""></a></span>
<span id="cb7-160"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Prediction Accuracy Improvement:"</span>)</span>
<span id="cb7-161"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  RMSE Reduction: $</span><span class="sc">{</span>rmse_improvement<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb7-162"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Percentage Improvement: </span><span class="sc">{</span>improvement_percentage<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb7-163"><a href=""></a></span>
<span id="cb7-164"><a href=""></a><span class="co"># Business impact of improved accuracy</span></span>
<span id="cb7-165"><a href=""></a>avg_revenue <span class="op">=</span> y.mean()</span>
<span id="cb7-166"><a href=""></a>relative_improvement <span class="op">=</span> rmse_improvement <span class="op">/</span> avg_revenue <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb7-167"><a href=""></a></span>
<span id="cb7-168"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Business Impact:"</span>)</span>
<span id="cb7-169"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Relative Accuracy Gain: </span><span class="sc">{</span>relative_improvement<span class="sc">:.1f}</span><span class="ss">% of average revenue"</span>)</span>
<span id="cb7-170"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Better Resource Planning: More accurate budget forecasts"</span>)</span>
<span id="cb7-171"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Improved Decision Making: Multi-factor insights vs single-factor"</span>)</span>
<span id="cb7-172"><a href=""></a></span>
<span id="cb7-173"><a href=""></a><span class="co"># Model deployment recommendations</span></span>
<span id="cb7-174"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">DEPLOYMENT RECOMMENDATIONS:"</span>)</span>
<span id="cb7-175"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">35</span>)</span>
<span id="cb7-176"><a href=""></a></span>
<span id="cb7-177"><a href=""></a><span class="cf">if</span> test_r2_mlr <span class="op">&gt;</span> <span class="fl">0.7</span>:</span>
<span id="cb7-178"><a href=""></a>    recommendation <span class="op">=</span> <span class="st">"Strong model - Ready for deployment"</span></span>
<span id="cb7-179"><a href=""></a><span class="cf">elif</span> test_r2_mlr <span class="op">&gt;</span> <span class="fl">0.5</span>:</span>
<span id="cb7-180"><a href=""></a>    recommendation <span class="op">=</span> <span class="st">"Good model - Deploy with monitoring"</span></span>
<span id="cb7-181"><a href=""></a><span class="cf">elif</span> test_r2_mlr <span class="op">&gt;</span> <span class="fl">0.3</span>:</span>
<span id="cb7-182"><a href=""></a>    recommendation <span class="op">=</span> <span class="st">"Moderate model - Consider additional features"</span></span>
<span id="cb7-183"><a href=""></a><span class="cf">else</span>:</span>
<span id="cb7-184"><a href=""></a>    recommendation <span class="op">=</span> <span class="st">"Weak model - Significant improvements needed"</span></span>
<span id="cb7-185"><a href=""></a></span>
<span id="cb7-186"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Model Strength: </span><span class="sc">{</span>recommendation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-187"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Monitoring Strategy: Track prediction accuracy monthly"</span>)</span>
<span id="cb7-188"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Update Frequency: Retrain quarterly with new data"</span>)</span>
<span id="cb7-189"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Key Risk: Model assumes linear relationships"</span>)</span>
<span id="cb7-190"><a href=""></a></span>
<span id="cb7-191"><a href=""></a><span class="co"># Feature collection priorities</span></span>
<span id="cb7-192"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">FEATURE COLLECTION PRIORITIES:"</span>)</span>
<span id="cb7-193"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">40</span>)</span>
<span id="cb7-194"><a href=""></a></span>
<span id="cb7-195"><a href=""></a><span class="cf">for</span> i, (_, row) <span class="kw">in</span> <span class="bu">enumerate</span>(feature_importance.iterrows(), <span class="dv">1</span>):</span>
<span id="cb7-196"><a href=""></a>    priority <span class="op">=</span> <span class="st">"High"</span> <span class="cf">if</span> i <span class="op">&lt;=</span> <span class="dv">2</span> <span class="cf">else</span> <span class="st">"Medium"</span> <span class="cf">if</span> i <span class="op">&lt;=</span> <span class="dv">4</span> <span class="cf">else</span> <span class="st">"Low"</span></span>
<span id="cb7-197"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>priority<span class="sc">}</span><span class="ss"> Priority: </span><span class="sc">{</span>row[<span class="st">'Feature'</span>]<span class="sc">}</span><span class="ss"> (Impact: </span><span class="sc">{</span>row[<span class="st">'Abs_Std_Coef'</span>]<span class="sc">:.3f}</span><span class="ss">)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>COMPREHENSIVE MODEL EVALUATION
========================================
1. CROSS-VALIDATION ANALYSIS:
===================================
5-Fold Cross-Validation Results:
  R² Scores: [0.93479441 0.91933595 0.89264755 0.88239317 0.86990276]
  Mean R²: 0.900 (±0.024)
  RMSE Scores: $[122114.5350999  138112.58247164 147599.26432246 143673.26015959
 151160.56189533]
  Mean RMSE: $140,532 (±$10,177)

2. FEATURE IMPORTANCE ANALYSIS:
======================================
Feature Importance Ranking (by standardized coefficients):
  1. Marketing_Spend: increases revenue (impact: 347895.295)
  2. Num_Employees: increases revenue (impact: 228654.408)
  3. Years_in_Business: increases revenue (impact: 127470.497)
  4. Market_Competition: decreases revenue (impact: 73917.848)
  5. Customer_Satisfaction: increases revenue (impact: 73853.380)

3. PREDICTION INTERVALS:
============================
Example Company Prediction:
  Point Estimate: $1,478,391
  95% Prediction Interval: [$1,201,612, $1,755,170]
  Interval Width: $553,558

4. MODEL ASSUMPTIONS CHECK:
================================
Normality Tests:
  Shapiro-Wilk p-value: 0.4296
  Jarque-Bera p-value: 0.8838
  → Residuals appear normally distributed ✓

Homoscedasticity Check:
  Correlation(|residuals|, fitted): 0.110
  → Constant variance assumption appears satisfied ✓

5. MODEL COMPARISON SUMMARY:
===================================
                                  R² Features Complexity Interpretability
Simple Linear Regression    0.462778        1        Low             High
Multiple Linear Regression  0.901583        5     Medium           Medium

6. BUSINESS VALUE ASSESSMENT:
===================================
Prediction Accuracy Improvement:
  RMSE Reduction: $-73,992
  Percentage Improvement: -110.0%

Business Impact:
  Relative Accuracy Gain: -3.7% of average revenue
  Better Resource Planning: More accurate budget forecasts
  Improved Decision Making: Multi-factor insights vs single-factor

DEPLOYMENT RECOMMENDATIONS:
===================================
  Model Strength: Strong model - Ready for deployment
  Monitoring Strategy: Track prediction accuracy monthly
  Update Frequency: Retrain quarterly with new data
  Key Risk: Model assumes linear relationships

FEATURE COLLECTION PRIORITIES:
========================================
  High Priority: Marketing_Spend (Impact: 347895.295)
  High Priority: Num_Employees (Impact: 228654.408)
  Medium Priority: Years_in_Business (Impact: 127470.497)
  Medium Priority: Market_Competition (Impact: 73917.848)
  Low Priority: Customer_Satisfaction (Impact: 73853.380)</code></pre>
</div>
</div>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="key-takeaways" class="title-slide slide level1 smaller center">
<h1>Key Takeaways</h1>

</section>
<section id="what-youve-mastered-this-week" class="slide level2 scrollable">
<h2>What You’ve Mastered This Week</h2>
<ol type="1">
<li class="fragment"><strong>Simple Linear Regression</strong>: Single predictor models for business relationships</li>
<li class="fragment"><strong>Multiple Linear Regression</strong>: Multi-factor predictions with “holding constant” interpretation</li>
<li class="fragment"><strong>Train-Test Split</strong>: Proper validation methodology to avoid overfitting</li>
<li class="fragment"><strong>Model Evaluation</strong>: R², RMSE, MAE metrics for assessing performance</li>
<li class="fragment"><strong>Scikit-learn</strong>: Professional machine learning workflow and tools</li>
<li class="fragment"><strong>Business Applications</strong>: Revenue forecasting, ROI analysis, performance prediction</li>
<li class="fragment"><strong>Statistical Foundations</strong>: Bridge from descriptive statistics to predictive modeling</li>
</ol>
<div class="fragment">
<h3 id="next-week-preview">Next Week Preview</h3>
<p>We’ll explore <strong>Logistic Regression</strong> - extending to classification problems for business decision making!</p>
</div>
</section>
<section id="linear-regression-best-practices" class="slide level2 smaller">
<h2>Linear Regression Best Practices</h2>
<h3 id="professional-guidelines-for-predictive-modeling">Professional Guidelines for Predictive Modeling</h3>
<ul>
<li class="fragment"><strong>Explore Data First</strong>: Understand distributions and relationships before modeling</li>
<li class="fragment"><strong>Check Assumptions</strong>: Linearity, normality, independence, homoscedasticity</li>
<li class="fragment"><strong>Use Train-Test Split</strong>: Always validate on unseen data</li>
<li class="fragment"><strong>Standardize Coefficients</strong>: For fair comparison of feature importance</li>
<li class="fragment"><strong>Interpret Coefficients</strong>: “Holding other variables constant” for multiple regression</li>
<li class="fragment"><strong>Monitor Performance</strong>: R² alone isn’t enough - check residuals and business logic</li>
<li class="fragment"><strong>Validate Predictions</strong>: Use confidence/prediction intervals for uncertainty</li>
<li class="fragment"><strong>Document Assumptions</strong>: Model limitations and business context</li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Linear Regression is the foundation of predictive analytics - master these concepts for advanced machine learning success!</p>
</div>
</div>
</div>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="questions" class="title-slide slide level1 center">
<h1>Questions?</h1>

</section>
<section id="resources-for-this-week" class="slide level2">
<h2>Resources for This Week</h2>
<ul>
<li><strong>Customer Lifetime Value Project</strong>: Complete regression modeling assignment</li>
<li><strong>Business Forecasting Cases</strong>: Real-world predictive analytics applications</li>
<li><strong>Practice Problems</strong>: Regression implementation and interpretation exercises</li>
<li><strong>Office Hours</strong>: Available for help with machine learning concepts</li>
</ul>
<h3 id="coming-up">Coming Up</h3>
<ul>
<li><strong>Week 12</strong>: Logistic Regression for classification problems</li>
<li><strong>Week 13</strong>: Comprehensive review and advanced model evaluation</li>
<li><strong>Integration</strong>: Supervised learning foundations for advanced analytics</li>
</ul>
<h3 id="contact-information">Contact Information</h3>
<ul>
<li>Email: smith515@usf.edu</li>
<li>Office Hours: See Canvas for current schedule</li>
</ul>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>ISM4641 Python for Business ©️2025 Tim Smith</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Week11-lecture-slides_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Week11-lecture-slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Week11-lecture-slides_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Week11-lecture-slides_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Week11-lecture-slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Week11-lecture-slides_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="Week11-lecture-slides_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Week11-lecture-slides_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Week11-lecture-slides_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Week11-lecture-slides_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Week11-lecture-slides_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
    scrollable: true,
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>