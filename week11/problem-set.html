<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Smith">

<title>Practice Problems: Introduction to Machine Learning &amp; Linear Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="week11-practice_files/libs/clipboard/clipboard.min.js"></script>
<script src="week11-practice_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="week11-practice_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="week11-practice_files/libs/quarto-html/popper.min.js"></script>
<script src="week11-practice_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="week11-practice_files/libs/quarto-html/anchor.min.js"></script>
<link href="week11-practice_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="week11-practice_files/libs/quarto-html/quarto-syntax-highlighting-4a990d8dcb58f517c7c86712b8f2ac7c.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="week11-practice_files/libs/quarto-html/quarto-syntax-highlighting-dark-46f4cc9626f044588a66931b604fc9c8.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="week11-practice_files/libs/quarto-html/quarto-syntax-highlighting-4a990d8dcb58f517c7c86712b8f2ac7c.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="week11-practice_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="week11-practice_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="week11-practice_files/libs/bootstrap/bootstrap-7fb405d50af379f6f99cb0e774c9922f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="week11-practice_files/libs/bootstrap/bootstrap-dark-d2c9d76e2ea35e59204fefcb7aa2b466.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="week11-practice_files/libs/bootstrap/bootstrap-7fb405d50af379f6f99cb0e774c9922f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#assignment-overview" id="toc-assignment-overview" class="nav-link active" data-scroll-target="#assignment-overview">Assignment Overview</a></li>
  <li><a href="#problem-1-predicting-monthly-sales-from-advertising-spend-slr" id="toc-problem-1-predicting-monthly-sales-from-advertising-spend-slr" class="nav-link" data-scroll-target="#problem-1-predicting-monthly-sales-from-advertising-spend-slr">Problem 1: Predicting Monthly Sales from Advertising Spend (SLR)</a></li>
  <li><a href="#problem-2-evaluating-slr-and-predicting-delivery-times" id="toc-problem-2-evaluating-slr-and-predicting-delivery-times" class="nav-link" data-scroll-target="#problem-2-evaluating-slr-and-predicting-delivery-times">Problem 2: Evaluating SLR and Predicting Delivery Times</a></li>
  <li><a href="#problem-3-predicting-house-prices-with-multiple-factors-mlr" id="toc-problem-3-predicting-house-prices-with-multiple-factors-mlr" class="nav-link" data-scroll-target="#problem-3-predicting-house-prices-with-multiple-factors-mlr">Problem 3: Predicting House Prices with Multiple Factors (MLR)</a></li>
  <li><a href="#problem-4-evaluating-mlr-for-customer-satisfaction" id="toc-problem-4-evaluating-mlr-for-customer-satisfaction" class="nav-link" data-scroll-target="#problem-4-evaluating-mlr-for-customer-satisfaction">Problem 4: Evaluating MLR for Customer Satisfaction</a></li>
  <li><a href="#appendix-solutions" id="toc-appendix-solutions" class="nav-link" data-scroll-target="#appendix-solutions">Appendix: Solutions</a>
  <ul class="collapse">
  <li><a href="#solution-problem-1---predicting-monthly-sales-from-advertising-spend-slr" id="toc-solution-problem-1---predicting-monthly-sales-from-advertising-spend-slr" class="nav-link" data-scroll-target="#solution-problem-1---predicting-monthly-sales-from-advertising-spend-slr">Solution: Problem 1 - Predicting Monthly Sales from Advertising Spend (SLR)</a></li>
  <li><a href="#solution-problem-2---evaluating-slr-and-predicting-delivery-times" id="toc-solution-problem-2---evaluating-slr-and-predicting-delivery-times" class="nav-link" data-scroll-target="#solution-problem-2---evaluating-slr-and-predicting-delivery-times">Solution: Problem 2 - Evaluating SLR and Predicting Delivery Times</a></li>
  <li><a href="#solution-problem-3---predicting-house-prices-with-multiple-factors-mlr" id="toc-solution-problem-3---predicting-house-prices-with-multiple-factors-mlr" class="nav-link" data-scroll-target="#solution-problem-3---predicting-house-prices-with-multiple-factors-mlr">Solution: Problem 3 - Predicting House Prices with Multiple Factors (MLR)</a></li>
  <li><a href="#solution-problem-4---evaluating-mlr-for-customer-satisfaction" id="toc-solution-problem-4---evaluating-mlr-for-customer-satisfaction" class="nav-link" data-scroll-target="#solution-problem-4---evaluating-mlr-for-customer-satisfaction">Solution: Problem 4 - Evaluating MLR for Customer Satisfaction</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Practice Problems: Introduction to Machine Learning &amp; Linear Regression</h1>
<p class="subtitle lead">Python for Business Analytics</p>
</div>


<div class="quarto-title-meta-author column-page-right">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Dr.&nbsp;Smith </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of South Florida
          </p>
      </div>
  </div>

<div class="quarto-title-meta column-page-right">

      
  
    
  </div>
  


</header>


<style>
/* Canvas iframe optimization */
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  font-size: 16px;
  line-height: 1.5;
  color: #212529;
}

@media screen {
  body.in-iframe {
    margin: 0;
    padding: 15px;
    max-width: 100%;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
    font-size: 16px;
    line-height: 1.5;
    color: #212529;
  }
  .in-iframe .quarto-container {
    max-width: 100%;
    padding: 0 15px;
  }
  .in-iframe #quarto-content {
    max-width: 100%;
  }
  .in-iframe .page-layout-article {
    grid-template-columns: minmax(0, 1fr);
  }
  .in-iframe .page-layout-full {
    grid-template-columns: minmax(0, 1fr);
  }
  .in-iframe .sidebar {
    width: 200px !important;
    font-size: 0.9em;
  }
  .in-iframe .sidebar.toc-left {
    width: 200px !important;
    margin-right: 15px;
  }
  .in-iframe .column-body {
    grid-column: 1;
    max-width: 100%;
  }
  .in-iframe #quarto-document-content {
    max-width: calc(100% - 220px);
    padding: 0 15px;
  }
  .in-iframe pre {
    overflow-x: auto;
    max-width: 100%;
    font-size: 0.9em;
  }
  .in-iframe code {
    font-size: 0.9em;
  }
  .in-iframe table {
    display: block;
    overflow-x: auto;
    max-width: 100%;
    font-size: 0.9em;
  }
  .in-iframe img {
    max-width: 100%;
    height: auto;
  }
  .in-iframe .callout {
    margin: 1em 0;
    padding: 0.5em 1em;
  }
  .in-iframe .sourceCode {
    max-width: 100%;
    overflow-x: auto;
  }
  .in-iframe .cell {
    max-width: 100%;
  }
  .in-iframe body {
    font-size: 15px;
  }
  .in-iframe h1 {
    font-size: 1.8em;
  }
  .in-iframe h2 {
    font-size: 1.5em;
  }
  .in-iframe h3 {
    font-size: 1.3em;
  }
  .in-iframe h4 {
    font-size: 1.1em;
  }
  .in-iframe #quarto-margin-sidebar {
    display: none !important;
  }
  .in-iframe .margin-sidebar {
    display: none !important;
  }
  
  /* Ensure proper paragraph spacing */
  .in-iframe p {
    margin-bottom: 1rem;
  }
  
  /* Maintain list styling */
  .in-iframe ul, .in-iframe ol {
    margin-bottom: 1rem;
  }
}

@media screen and (max-width: 768px) {
  .in-iframe .sidebar {
    display: none !important;
  }
  .in-iframe #quarto-document-content {
    max-width: 100%;
  }
  .in-iframe body {
    font-size: 14px;
  }
}
</style>
<script>
if (window.self !== window.top) {
  document.addEventListener("DOMContentLoaded", function() {
    document.body.classList.add("in-iframe");
  });
}
</script>
<section id="assignment-overview" class="level2">
<h2 class="anchored" data-anchor-id="assignment-overview">Assignment Overview</h2>
<p>These exercises are designed to help you practice the concepts covered in our lecture on Introduction to Machine Learning, focusing on Simple and Multiple Linear Regression using Python. Please complete the tasks outlined in each problem.</p>
<p>You will need the following Python libraries. Ensure they are installed in your environment.</p>
<div id="setup" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score, mean_absolute_error</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># Optional: Set a consistent plot style</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="bu">print</span>(<span class="st">"Libraries imported successfully."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Libraries imported successfully.</code></pre>
</div>
</div>
<hr>
</section>
<section id="problem-1-predicting-monthly-sales-from-advertising-spend-slr" class="level2">
<h2 class="anchored" data-anchor-id="problem-1-predicting-monthly-sales-from-advertising-spend-slr">Problem 1: Predicting Monthly Sales from Advertising Spend (SLR)</h2>
<ul>
<li><strong>Scenario:</strong> A retail company wants to understand how its monthly advertising expenditure (in thousands of dollars) relates to its monthly sales (in thousands of dollars). They want to build a simple model to predict sales based on ad spend.</li>
<li><strong>Tasks:</strong>
<ol type="1">
<li>Run the starter code to generate the <code>df_sales</code> DataFrame.</li>
<li>Create a scatter plot of <code>AdSpend</code> (X-axis) vs.&nbsp;<code>Sales</code> (Y-axis) to visualize the relationship.</li>
<li>Define your feature variable <code>X</code> (AdSpend) and target variable <code>y</code> (Sales). Make sure <code>X</code> is a DataFrame (e.g., <code>df_sales[['AdSpend']]</code>).</li>
<li>Split the data into a training set (80% of data) and a test set (20% of data). Use <code>random_state=101</code> for reproducibility.</li>
<li>Create an instance of the <code>LinearRegression</code> model.</li>
<li>Train (fit) the model using <em>only</em> the training data (<code>X_train</code>, <code>y_train</code>).</li>
<li>Print the model’s intercept (β₀) and the coefficient (β₁) for <code>AdSpend</code>.</li>
</ol></li>
<li><strong>Interpretation Question:</strong>
<ul>
<li>Explain what the intercept represents in the context of this business problem. Is it practically meaningful here?</li>
<li>Explain what the <code>AdSpend</code> coefficient represents in terms of the relationship between advertising spending and sales.</li>
</ul></li>
</ul>
<div id="p1-starter-code" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Starter Code for Problem 1</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>np.random.seed(<span class="dv">101</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>n_months <span class="op">=</span> <span class="dv">120</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>ad_spend <span class="op">=</span> np.random.uniform(<span class="dv">5</span>, <span class="dv">25</span>, n_months) <span class="co"># Ad spend in $1000s (e.g., 5 = $5000)</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>sales <span class="op">=</span> <span class="dv">50</span> <span class="op">+</span> <span class="fl">7.5</span> <span class="op">*</span> ad_spend <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="dv">20</span>, n_months) <span class="co"># Sales in $1000s</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>sales <span class="op">=</span> np.maximum(sales, <span class="dv">10</span>) <span class="co"># Ensure sales are positive</span></span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a>df_sales <span class="op">=</span> pd.DataFrame({<span class="st">'AdSpend'</span>: ad_spend, <span class="st">'Sales'</span>: sales})</span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="bu">print</span>(<span class="st">"Problem 1: Sample Sales Data Head"</span>)</span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="bu">print</span>(df_sales.head())</span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co"># --- Your Code Below ---</span></span>
<span id="cb3-13"><a href="#cb3-13"></a></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co"># Task 2: Scatter plot</span></span>
<span id="cb3-15"><a href="#cb3-15"></a></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co"># Task 3: Define X and y</span></span>
<span id="cb3-17"><a href="#cb3-17"></a></span>
<span id="cb3-18"><a href="#cb3-18"></a></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co"># Task 4: Train-Test Split</span></span>
<span id="cb3-20"><a href="#cb3-20"></a></span>
<span id="cb3-21"><a href="#cb3-21"></a></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co"># Task 5: Create LinearRegression instance</span></span>
<span id="cb3-23"><a href="#cb3-23"></a></span>
<span id="cb3-24"><a href="#cb3-24"></a></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="co"># Task 6: Train the model</span></span>
<span id="cb3-26"><a href="#cb3-26"></a></span>
<span id="cb3-27"><a href="#cb3-27"></a></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="co"># Task 7: Print intercept and coefficient</span></span>
<span id="cb3-29"><a href="#cb3-29"></a></span>
<span id="cb3-30"><a href="#cb3-30"></a></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="co"># Interpretation Question: (Answer in comments or a Markdown cell)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Problem 1: Sample Sales Data Head
     AdSpend       Sales
0  15.327973  177.795904
1  16.413352  154.998140
2   5.569485   83.948001
3   8.430433  133.794112
4  18.705540  150.839445</code></pre>
</div>
</div>
<hr>
</section>
<section id="problem-2-evaluating-slr-and-predicting-delivery-times" class="level2">
<h2 class="anchored" data-anchor-id="problem-2-evaluating-slr-and-predicting-delivery-times">Problem 2: Evaluating SLR and Predicting Delivery Times</h2>
<ul>
<li><strong>Scenario:</strong> A logistics company wants to predict package delivery time (in hours) based on the distance (in miles) from the distribution center. They have data from recent deliveries.</li>
<li><strong>Tasks:</strong>
<ol type="1">
<li>Run the starter code to generate the <code>df_delivery</code> DataFrame.</li>
<li>Define the feature <code>X</code> (Distance) and target <code>y</code> (DeliveryTime).</li>
<li>Split the data into training (75%) and testing (25%) sets. Use <code>random_state=102</code>.</li>
<li>Train a Simple Linear Regression model on the training data.</li>
<li>Make predictions using the trained model on the <em>test set</em> (<code>X_test</code>).</li>
<li>Calculate the following evaluation metrics for the test set predictions:
<ul>
<li>R-squared (R²)</li>
<li>Root Mean Squared Error (RMSE)</li>
<li>Mean Absolute Error (MAE)</li>
</ul></li>
<li>Print the calculated metrics.</li>
<li>Use the trained model to predict the delivery time for two new deliveries with distances of 70 miles and 180 miles. Print these predictions.</li>
</ol></li>
<li><strong>Interpretation Question:</strong>
<ul>
<li>Explain what the R-squared value tells you about how well the model fits the <em>test</em> data.</li>
<li>What does the RMSE value represent? (Consider the units of the target variable).</li>
</ul></li>
</ul>
<div id="p2-starter-code" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Starter Code for Problem 2</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>np.random.seed(<span class="dv">102</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>n_deliveries <span class="op">=</span> <span class="dv">150</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>distance <span class="op">=</span> np.random.uniform(<span class="dv">10</span>, <span class="dv">200</span>, n_deliveries) <span class="co"># Distance in miles</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>delivery_time <span class="op">=</span> <span class="fl">1.5</span> <span class="op">+</span> <span class="fl">0.08</span> <span class="op">*</span> distance <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">1.2</span>, n_deliveries) <span class="co"># Time in hours</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>delivery_time <span class="op">=</span> np.maximum(delivery_time, <span class="fl">0.5</span>) <span class="co"># Minimum delivery time</span></span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a>df_delivery <span class="op">=</span> pd.DataFrame({<span class="st">'Distance'</span>: distance, <span class="st">'DeliveryTime'</span>: delivery_time})</span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Problem 2: Sample Delivery Data Head"</span>)</span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="bu">print</span>(df_delivery.head())</span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co"># --- Your Code Below ---</span></span>
<span id="cb5-13"><a href="#cb5-13"></a></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co"># Task 2: Define X and y</span></span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co"># Task 3: Train-Test Split</span></span>
<span id="cb5-17"><a href="#cb5-17"></a></span>
<span id="cb5-18"><a href="#cb5-18"></a></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="co"># Task 4: Train SLR model</span></span>
<span id="cb5-20"><a href="#cb5-20"></a></span>
<span id="cb5-21"><a href="#cb5-21"></a></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="co"># Task 5: Make predictions on test set</span></span>
<span id="cb5-23"><a href="#cb5-23"></a></span>
<span id="cb5-24"><a href="#cb5-24"></a></span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="co"># Task 6: Calculate evaluation metrics</span></span>
<span id="cb5-26"><a href="#cb5-26"></a></span>
<span id="cb5-27"><a href="#cb5-27"></a></span>
<span id="cb5-28"><a href="#cb5-28"></a><span class="co"># Task 7: Print metrics</span></span>
<span id="cb5-29"><a href="#cb5-29"></a></span>
<span id="cb5-30"><a href="#cb5-30"></a></span>
<span id="cb5-31"><a href="#cb5-31"></a><span class="co"># Task 8: Predict for new distances</span></span>
<span id="cb5-32"><a href="#cb5-32"></a></span>
<span id="cb5-33"><a href="#cb5-33"></a></span>
<span id="cb5-34"><a href="#cb5-34"></a><span class="co"># Interpretation Question: (Answer in comments or a Markdown cell)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Problem 2: Sample Delivery Data Head
     Distance  DeliveryTime
0  123.559501     12.024380
1  138.437512     13.432818
2   66.863531      6.528409
3  148.840651     14.845316
4  119.960484     13.462273</code></pre>
</div>
</div>
<hr>
</section>
<section id="problem-3-predicting-house-prices-with-multiple-factors-mlr" class="level2">
<h2 class="anchored" data-anchor-id="problem-3-predicting-house-prices-with-multiple-factors-mlr">Problem 3: Predicting House Prices with Multiple Factors (MLR)</h2>
<ul>
<li><strong>Scenario:</strong> A real estate firm wants a slightly more complex model to predict house prices (in dollars) based on both the square footage (<code>SqFt</code>) and the number of bathrooms (<code>Bathrooms</code>).</li>
<li><strong>Tasks:</strong>
<ol type="1">
<li>Run the starter code to generate the <code>df_houses</code> DataFrame.</li>
<li>Define the features <code>X</code> (containing <em>both</em> <code>SqFt</code> and <code>Bathrooms</code>) and the target <code>y</code> (Price).</li>
<li>Split the data into training (80%) and testing (20%) sets. Use <code>random_state=103</code>.</li>
<li>Train a Multiple Linear Regression model on the training data.</li>
<li>Print the model’s intercept (β₀) and the coefficients (β₁, β₂) for <code>SqFt</code> and <code>Bathrooms</code>. You might want to pair the coefficients with their feature names for clarity.</li>
</ol></li>
<li><strong>Interpretation Question:</strong>
<ul>
<li>Explain the meaning of the coefficient for <code>SqFt</code> in this model. Remember to mention the other variable.</li>
<li>Explain the meaning of the coefficient for <code>Bathrooms</code> in this model. Remember to mention the other variable.</li>
</ul></li>
</ul>
<div id="p3-starter-code" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Starter Code for Problem 3</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>np.random.seed(<span class="dv">103</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a>n_houses <span class="op">=</span> <span class="dv">250</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>sqft <span class="op">=</span> np.random.normal(<span class="dv">2000</span>, <span class="dv">500</span>, n_houses) <span class="co"># Average 2000 sqft</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>bathrooms <span class="op">=</span> np.random.choice([<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>, <span class="fl">3.5</span>, <span class="dv">4</span>], size<span class="op">=</span>n_houses, p<span class="op">=</span>[<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.25</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>]) <span class="co"># Number of bathrooms</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>sqft <span class="op">=</span> np.maximum(sqft, <span class="dv">800</span>) <span class="co"># Min sqft</span></span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co"># Price = Base + SqFt effect + Bathrooms effect + noise</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>price <span class="op">=</span> <span class="dv">30000</span> <span class="op">+</span> <span class="dv">180</span> <span class="op">*</span> sqft <span class="op">+</span> <span class="dv">40000</span> <span class="op">*</span> bathrooms <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="dv">50000</span>, n_houses)</span>
<span id="cb7-10"><a href="#cb7-10"></a>price <span class="op">=</span> np.maximum(price, <span class="dv">75000</span>) <span class="co"># Min price</span></span>
<span id="cb7-11"><a href="#cb7-11"></a></span>
<span id="cb7-12"><a href="#cb7-12"></a>df_houses <span class="op">=</span> pd.DataFrame({<span class="st">'SqFt'</span>: sqft, <span class="st">'Bathrooms'</span>: bathrooms, <span class="st">'Price'</span>: price})</span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Problem 3: Sample House Price Data Head"</span>)</span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="bu">print</span>(df_houses.head())</span>
<span id="cb7-15"><a href="#cb7-15"></a></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co"># --- Your Code Below ---</span></span>
<span id="cb7-17"><a href="#cb7-17"></a></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co"># Task 2: Define X (multiple features) and y</span></span>
<span id="cb7-19"><a href="#cb7-19"></a></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co"># Task 3: Train-Test Split</span></span>
<span id="cb7-21"><a href="#cb7-21"></a></span>
<span id="cb7-22"><a href="#cb7-22"></a></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co"># Task 4: Train MLR model</span></span>
<span id="cb7-24"><a href="#cb7-24"></a></span>
<span id="cb7-25"><a href="#cb7-25"></a></span>
<span id="cb7-26"><a href="#cb7-26"></a><span class="co"># Task 5: Print intercept and coefficients (pair with names)</span></span>
<span id="cb7-27"><a href="#cb7-27"></a></span>
<span id="cb7-28"><a href="#cb7-28"></a></span>
<span id="cb7-29"><a href="#cb7-29"></a><span class="co"># Interpretation Question: (Answer in comments or a Markdown cell)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Problem 3: Sample House Price Data Head
          SqFt  Bathrooms          Price
0  1375.360825        2.5  279540.296266
1  1869.834293        2.5  418434.898387
2  2191.896650        1.5  550641.324264
3  1807.269263        1.5  382939.376709
4  1457.431635        2.5  517365.233373</code></pre>
</div>
</div>
<hr>
</section>
<section id="problem-4-evaluating-mlr-for-customer-satisfaction" class="level2">
<h2 class="anchored" data-anchor-id="problem-4-evaluating-mlr-for-customer-satisfaction">Problem 4: Evaluating MLR for Customer Satisfaction</h2>
<ul>
<li><strong>Scenario:</strong> A SaaS (Software as a Service) company models customer satisfaction score (1-10 scale) based on the average support ticket <code>ResponseTime</code> (in hours) and the <code>ResolutionRate</code> (percentage of tickets resolved successfully, 0-100). Note that faster response times (lower values) are expected to correlate with higher satisfaction.</li>
<li><strong>Tasks:</strong>
<ol type="1">
<li>Run the starter code to generate the <code>df_satisfaction</code> DataFrame.</li>
<li>Define features <code>X</code> (<code>ResponseTime</code>, <code>ResolutionRate</code>) and target <code>y</code> (<code>SatisfactionScore</code>).</li>
<li>Split data into training (70%) and testing (30%) sets. Use <code>random_state=104</code>.</li>
<li>Train an MLR model on the training data.</li>
<li>Make predictions on the <em>test set</em>.</li>
<li>Calculate and print the R-squared (R²) and RMSE for the model’s performance on the <em>test set</em>.</li>
<li>Use the trained model to predict the <code>SatisfactionScore</code> for a hypothetical scenario with <code>ResponseTime</code> = 3 hours and <code>ResolutionRate</code> = 95%. Print the prediction.</li>
</ol></li>
<li><strong>Interpretation Question:</strong>
<ul>
<li>What does the R-squared value calculated on the test set indicate about the model’s ability to explain the variation in customer satisfaction scores using response time and resolution rate?</li>
<li>Look at the sign of the coefficient for <code>ResponseTime</code> (you might need to print it). Does it match the expectation that lower response times lead to higher satisfaction?</li>
</ul></li>
</ul>
<div id="p4-starter-code" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Starter Code for Problem 4</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>np.random.seed(<span class="dv">104</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a>n_clients <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>response_time <span class="op">=</span> np.random.uniform(<span class="fl">0.5</span>, <span class="dv">10</span>, n_clients) <span class="co"># Avg response time in hours</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>resolution_rate <span class="op">=</span> np.random.uniform(<span class="dv">75</span>, <span class="dv">100</span>, n_clients) <span class="co"># Resolution rate %</span></span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co"># Satisfaction = Base - ResponseTime effect + ResolutionRate effect + noise</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co"># Note the negative sign for response_time</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>satisfaction_score <span class="op">=</span> <span class="dv">3</span> <span class="op">-</span> <span class="fl">0.3</span> <span class="op">*</span> response_time <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> resolution_rate <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.75</span>, n_clients)</span>
<span id="cb9-10"><a href="#cb9-10"></a>satisfaction_score <span class="op">=</span> np.clip(satisfaction_score, <span class="dv">1</span>, <span class="dv">10</span>) <span class="co"># Score between 1 and 10</span></span>
<span id="cb9-11"><a href="#cb9-11"></a></span>
<span id="cb9-12"><a href="#cb9-12"></a>df_satisfaction <span class="op">=</span> pd.DataFrame({</span>
<span id="cb9-13"><a href="#cb9-13"></a>    <span class="st">'ResponseTime'</span>: response_time,</span>
<span id="cb9-14"><a href="#cb9-14"></a>    <span class="st">'ResolutionRate'</span>: resolution_rate,</span>
<span id="cb9-15"><a href="#cb9-15"></a>    <span class="st">'SatisfactionScore'</span>: satisfaction_score</span>
<span id="cb9-16"><a href="#cb9-16"></a>})</span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Problem 4: Sample Customer Satisfaction Data Head"</span>)</span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="bu">print</span>(df_satisfaction.head())</span>
<span id="cb9-19"><a href="#cb9-19"></a></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co"># --- Your Code Below ---</span></span>
<span id="cb9-21"><a href="#cb9-21"></a></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co"># Task 2: Define X and y</span></span>
<span id="cb9-23"><a href="#cb9-23"></a></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co"># Task 3: Train-Test Split</span></span>
<span id="cb9-25"><a href="#cb9-25"></a></span>
<span id="cb9-26"><a href="#cb9-26"></a></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co"># Task 4: Train MLR model</span></span>
<span id="cb9-28"><a href="#cb9-28"></a></span>
<span id="cb9-29"><a href="#cb9-29"></a></span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="co"># Task 5: Make predictions on test set</span></span>
<span id="cb9-31"><a href="#cb9-31"></a></span>
<span id="cb9-32"><a href="#cb9-32"></a></span>
<span id="cb9-33"><a href="#cb9-33"></a><span class="co"># Task 6: Calculate and print R2 and RMSE</span></span>
<span id="cb9-34"><a href="#cb9-34"></a></span>
<span id="cb9-35"><a href="#cb9-35"></a></span>
<span id="cb9-36"><a href="#cb9-36"></a><span class="co"># Task 7: Predict for a new scenario</span></span>
<span id="cb9-37"><a href="#cb9-37"></a></span>
<span id="cb9-38"><a href="#cb9-38"></a></span>
<span id="cb9-39"><a href="#cb9-39"></a><span class="co"># Interpretation Question: (Answer in comments or a Markdown cell)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Problem 4: Sample Customer Satisfaction Data Head
   ResponseTime  ResolutionRate  SatisfactionScore
0      1.905246       83.059772           6.224837
1      2.668834       84.121094           7.537259
2      8.171187       80.021925           4.981895
3      3.335508       81.929153           6.386379
4      2.264214       91.796977           6.994417</code></pre>
</div>
</div>
<hr>
</section>
<section id="appendix-solutions" class="level1">
<h1>Appendix: Solutions</h1>
<section id="solution-problem-1---predicting-monthly-sales-from-advertising-spend-slr" class="level2">
<h2 class="anchored" data-anchor-id="solution-problem-1---predicting-monthly-sales-from-advertising-spend-slr">Solution: Problem 1 - Predicting Monthly Sales from Advertising Spend (SLR)</h2>
<div id="cell-sol1" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># --- Solution Code for Problem 1 ---</span></span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co"># Task 2: Scatter plot</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb11-5"><a href="#cb11-5"></a>sns.scatterplot(x<span class="op">=</span><span class="st">'AdSpend'</span>, y<span class="op">=</span><span class="st">'Sales'</span>, data<span class="op">=</span>df_sales)</span>
<span id="cb11-6"><a href="#cb11-6"></a>plt.title(<span class="st">'Monthly Sales vs. Advertising Spend'</span>)</span>
<span id="cb11-7"><a href="#cb11-7"></a>plt.xlabel(<span class="st">'Advertising Spend ($1000s)'</span>)</span>
<span id="cb11-8"><a href="#cb11-8"></a>plt.ylabel(<span class="st">'Monthly Sales ($1000s)'</span>)</span>
<span id="cb11-9"><a href="#cb11-9"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb11-10"><a href="#cb11-10"></a>plt.show()</span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="bu">print</span>(<span class="st">"-&gt; Scatter plot displayed. Appears to show a positive linear trend."</span>)</span>
<span id="cb11-12"><a href="#cb11-12"></a></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co"># Task 3: Define X and y</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>X_sales <span class="op">=</span> df_sales[[<span class="st">'AdSpend'</span>]] <span class="co"># Feature DataFrame (2D)</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>y_sales <span class="op">=</span> df_sales[<span class="st">'Sales'</span>]     <span class="co"># Target Series (1D)</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">-&gt; Shape of X_sales:"</span>, X_sales.shape)</span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="bu">print</span>(<span class="st">"-&gt; Shape of y_sales:"</span>, y_sales.shape)</span>
<span id="cb11-18"><a href="#cb11-18"></a></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co"># Task 4: Train-Test Split</span></span>
<span id="cb11-20"><a href="#cb11-20"></a>X_sales_train, X_sales_test, y_sales_train, y_sales_test <span class="op">=</span> train_test_split(</span>
<span id="cb11-21"><a href="#cb11-21"></a>    X_sales, y_sales, test_size<span class="op">=</span><span class="fl">0.20</span>, random_state<span class="op">=</span><span class="dv">101</span></span>
<span id="cb11-22"><a href="#cb11-22"></a>)</span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">-&gt; Data split complete:"</span>)</span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="bu">print</span>(<span class="st">"   Training set size:"</span>, X_sales_train.shape[<span class="dv">0</span>])</span>
<span id="cb11-25"><a href="#cb11-25"></a><span class="bu">print</span>(<span class="st">"   Test set size:"</span>, X_sales_test.shape[<span class="dv">0</span>])</span>
<span id="cb11-26"><a href="#cb11-26"></a></span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="co"># Task 5: Create LinearRegression instance</span></span>
<span id="cb11-28"><a href="#cb11-28"></a>slr_model_sales <span class="op">=</span> LinearRegression()</span>
<span id="cb11-29"><a href="#cb11-29"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">-&gt; LinearRegression model instance created."</span>)</span>
<span id="cb11-30"><a href="#cb11-30"></a></span>
<span id="cb11-31"><a href="#cb11-31"></a><span class="co"># Task 6: Train the model</span></span>
<span id="cb11-32"><a href="#cb11-32"></a>slr_model_sales.fit(X_sales_train, y_sales_train)</span>
<span id="cb11-33"><a href="#cb11-33"></a><span class="bu">print</span>(<span class="st">"-&gt; Model training complete."</span>)</span>
<span id="cb11-34"><a href="#cb11-34"></a></span>
<span id="cb11-35"><a href="#cb11-35"></a><span class="co"># Task 7: Print intercept and coefficient</span></span>
<span id="cb11-36"><a href="#cb11-36"></a>intercept_sales <span class="op">=</span> slr_model_sales.intercept_</span>
<span id="cb11-37"><a href="#cb11-37"></a>coefficient_sales <span class="op">=</span> slr_model_sales.coef_[<span class="dv">0</span>]</span>
<span id="cb11-38"><a href="#cb11-38"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">-&gt; Model Intercept (β₀): </span><span class="sc">{</span>intercept_sales<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb11-39"><a href="#cb11-39"></a><span class="bu">print</span>(<span class="ss">f"-&gt; Model Coefficient for AdSpend (β₁): </span><span class="sc">{</span>coefficient_sales<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb11-40"><a href="#cb11-40"></a></span>
<span id="cb11-41"><a href="#cb11-41"></a><span class="co"># --- Interpretation ---</span></span>
<span id="cb11-42"><a href="#cb11-42"></a><span class="co"># Intercept (β₀): The intercept (~51.885) represents the predicted monthly sales (in $1000s) when the advertising spend is $0.</span></span>
<span id="cb11-43"><a href="#cb11-43"></a><span class="co"># In this context, it could represent baseline sales from factors other than advertising (e.g., brand loyalty, walk-ins).</span></span>
<span id="cb11-44"><a href="#cb11-44"></a><span class="co"># Whether it's truly meaningful depends on whether spending $0 is realistic or within the observed data range.</span></span>
<span id="cb11-45"><a href="#cb11-45"></a><span class="co"># If the lowest AdSpend in the data is significantly above 0, extrapolating to 0 might be unreliable.</span></span>
<span id="cb11-46"><a href="#cb11-46"></a><span class="co">#</span></span>
<span id="cb11-47"><a href="#cb11-47"></a><span class="co"># AdSpend Coefficient (β₁): The coefficient (~7.422) indicates that for each additional $1000 spent on advertising (`AdSpend` unit increase),</span></span>
<span id="cb11-48"><a href="#cb11-48"></a><span class="co"># the model predicts an increase in monthly sales of approximately $7,422 (`Sales` unit increase).</span></span>
<span id="cb11-49"><a href="#cb11-49"></a><span class="co"># This quantifies the positive linear relationship observed between ad spending and sales in the model.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="week11-practice_files/figure-html/sol1-output-1.png" id="sol1" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>-&gt; Scatter plot displayed. Appears to show a positive linear trend.

-&gt; Shape of X_sales: (120, 1)
-&gt; Shape of y_sales: (120,)

-&gt; Data split complete:
   Training set size: 96
   Test set size: 24

-&gt; LinearRegression model instance created.
-&gt; Model training complete.

-&gt; Model Intercept (β₀): 48.904
-&gt; Model Coefficient for AdSpend (β₁): 7.454</code></pre>
</div>
</div>
</section>
<section id="solution-problem-2---evaluating-slr-and-predicting-delivery-times" class="level2">
<h2 class="anchored" data-anchor-id="solution-problem-2---evaluating-slr-and-predicting-delivery-times">Solution: Problem 2 - Evaluating SLR and Predicting Delivery Times</h2>
<div id="sol2" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># --- Solution Code for Problem 2 ---</span></span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co"># Task 2: Define X and y</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>X_delivery <span class="op">=</span> df_delivery[[<span class="st">'Distance'</span>]]</span>
<span id="cb13-5"><a href="#cb13-5"></a>y_delivery <span class="op">=</span> df_delivery[<span class="st">'DeliveryTime'</span>]</span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="bu">print</span>(<span class="st">"-&gt; Shape of X_delivery:"</span>, X_delivery.shape)</span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="bu">print</span>(<span class="st">"-&gt; Shape of y_delivery:"</span>, y_delivery.shape)</span>
<span id="cb13-8"><a href="#cb13-8"></a></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co"># Task 3: Train-Test Split</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>X_del_train, X_del_test, y_del_train, y_del_test <span class="op">=</span> train_test_split(</span>
<span id="cb13-11"><a href="#cb13-11"></a>    X_delivery, y_delivery, test_size<span class="op">=</span><span class="fl">0.25</span>, random_state<span class="op">=</span><span class="dv">102</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>)</span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">-&gt; Data split complete:"</span>)</span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="bu">print</span>(<span class="st">"   Training set size:"</span>, X_del_train.shape[<span class="dv">0</span>])</span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="bu">print</span>(<span class="st">"   Test set size:"</span>, X_del_test.shape[<span class="dv">0</span>])</span>
<span id="cb13-16"><a href="#cb13-16"></a></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co"># Task 4: Train SLR model</span></span>
<span id="cb13-18"><a href="#cb13-18"></a>slr_model_delivery <span class="op">=</span> LinearRegression()</span>
<span id="cb13-19"><a href="#cb13-19"></a>slr_model_delivery.fit(X_del_train, y_del_train)</span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="bu">print</span>(<span class="st">"-&gt; Model training complete."</span>)</span>
<span id="cb13-21"><a href="#cb13-21"></a></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co"># Task 5: Make predictions on test set</span></span>
<span id="cb13-23"><a href="#cb13-23"></a>y_del_pred_test <span class="op">=</span> slr_model_delivery.predict(X_del_test)</span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="bu">print</span>(<span class="st">"-&gt; Predictions made on the test set."</span>)</span>
<span id="cb13-25"><a href="#cb13-25"></a></span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="co"># Task 6: Calculate evaluation metrics</span></span>
<span id="cb13-27"><a href="#cb13-27"></a>r2_del <span class="op">=</span> r2_score(y_del_test, y_del_pred_test)</span>
<span id="cb13-28"><a href="#cb13-28"></a>mse_del <span class="op">=</span> mean_squared_error(y_del_test, y_del_pred_test)</span>
<span id="cb13-29"><a href="#cb13-29"></a>rmse_del <span class="op">=</span> np.sqrt(mse_del)</span>
<span id="cb13-30"><a href="#cb13-30"></a>mae_del <span class="op">=</span> mean_absolute_error(y_del_test, y_del_pred_test)</span>
<span id="cb13-31"><a href="#cb13-31"></a><span class="bu">print</span>(<span class="st">"-&gt; Evaluation metrics calculated."</span>)</span>
<span id="cb13-32"><a href="#cb13-32"></a></span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="co"># Task 7: Print metrics</span></span>
<span id="cb13-34"><a href="#cb13-34"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">-&gt; Test Set Evaluation Metrics:"</span>)</span>
<span id="cb13-35"><a href="#cb13-35"></a><span class="bu">print</span>(<span class="ss">f"   R-squared (R²): </span><span class="sc">{</span>r2_del<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb13-36"><a href="#cb13-36"></a><span class="bu">print</span>(<span class="ss">f"   Root Mean Squared Error (RMSE): </span><span class="sc">{</span>rmse_del<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb13-37"><a href="#cb13-37"></a><span class="bu">print</span>(<span class="ss">f"   Mean Absolute Error (MAE): </span><span class="sc">{</span>mae_del<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb13-38"><a href="#cb13-38"></a></span>
<span id="cb13-39"><a href="#cb13-39"></a><span class="co"># Task 8: Predict for new distances</span></span>
<span id="cb13-40"><a href="#cb13-40"></a>new_distances <span class="op">=</span> pd.DataFrame({<span class="st">'Distance'</span>: [<span class="dv">70</span>, <span class="dv">180</span>]})</span>
<span id="cb13-41"><a href="#cb13-41"></a>predicted_times <span class="op">=</span> slr_model_delivery.predict(new_distances)</span>
<span id="cb13-42"><a href="#cb13-42"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">-&gt; Predictions for new distances:"</span>)</span>
<span id="cb13-43"><a href="#cb13-43"></a><span class="bu">print</span>(<span class="ss">f"   Predicted time for 70 miles: </span><span class="sc">{</span>predicted_times[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss"> hours"</span>)</span>
<span id="cb13-44"><a href="#cb13-44"></a><span class="bu">print</span>(<span class="ss">f"   Predicted time for 180 miles: </span><span class="sc">{</span>predicted_times[<span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss"> hours"</span>)</span>
<span id="cb13-45"><a href="#cb13-45"></a></span>
<span id="cb13-46"><a href="#cb13-46"></a><span class="co"># --- Interpretation ---</span></span>
<span id="cb13-47"><a href="#cb13-47"></a><span class="co"># R-squared (R²): The R² value (approx. 0.8602) indicates that about 86.02% of the variability</span></span>
<span id="cb13-48"><a href="#cb13-48"></a><span class="co"># in delivery times (in the test set) can be explained by the distance using this linear model.</span></span>
<span id="cb13-49"><a href="#cb13-49"></a><span class="co"># This suggests the model fits the test data reasonably well, as distance accounts for a large portion of the variation in delivery time.</span></span>
<span id="cb13-50"><a href="#cb13-50"></a><span class="co">#</span></span>
<span id="cb13-51"><a href="#cb13-51"></a><span class="co"># RMSE: The RMSE value (approx. 1.1537) represents the standard deviation of the prediction errors (residuals)</span></span>
<span id="cb13-52"><a href="#cb13-52"></a><span class="co"># on the test set. In this context, it means that, on average, the model's predictions of delivery time</span></span>
<span id="cb13-53"><a href="#cb13-53"></a><span class="co"># are off by about 1.15 hours. This gives an idea of the typical prediction error magnitude in the original units (hours).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-&gt; Shape of X_delivery: (150, 1)
-&gt; Shape of y_delivery: (150,)

-&gt; Data split complete:
   Training set size: 112
   Test set size: 38
-&gt; Model training complete.
-&gt; Predictions made on the test set.
-&gt; Evaluation metrics calculated.

-&gt; Test Set Evaluation Metrics:
   R-squared (R²): 0.9184
   Root Mean Squared Error (RMSE): 1.2638
   Mean Absolute Error (MAE): 1.0005

-&gt; Predictions for new distances:
   Predicted time for 70 miles: 7.16 hours
   Predicted time for 180 miles: 15.93 hours</code></pre>
</div>
</div>
</section>
<section id="solution-problem-3---predicting-house-prices-with-multiple-factors-mlr" class="level2">
<h2 class="anchored" data-anchor-id="solution-problem-3---predicting-house-prices-with-multiple-factors-mlr">Solution: Problem 3 - Predicting House Prices with Multiple Factors (MLR)</h2>
<div id="sol3" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># --- Solution Code for Problem 3 ---</span></span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co"># Task 2: Define X (multiple features) and y</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>X_houses <span class="op">=</span> df_houses[[<span class="st">'SqFt'</span>, <span class="st">'Bathrooms'</span>]] <span class="co"># X has two columns</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>y_houses <span class="op">=</span> df_houses[<span class="st">'Price'</span>]</span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="bu">print</span>(<span class="st">"-&gt; Shape of X_houses:"</span>, X_houses.shape)</span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="bu">print</span>(<span class="st">"-&gt; Shape of y_houses:"</span>, y_houses.shape)</span>
<span id="cb15-8"><a href="#cb15-8"></a></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co"># Task 3: Train-Test Split</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>X_house_train, X_house_test, y_house_train, y_house_test <span class="op">=</span> train_test_split(</span>
<span id="cb15-11"><a href="#cb15-11"></a>    X_houses, y_houses, test_size<span class="op">=</span><span class="fl">0.20</span>, random_state<span class="op">=</span><span class="dv">103</span></span>
<span id="cb15-12"><a href="#cb15-12"></a>)</span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">-&gt; Data split complete:"</span>)</span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="bu">print</span>(<span class="st">"   Training set size:"</span>, X_house_train.shape[<span class="dv">0</span>])</span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="bu">print</span>(<span class="st">"   Test set size:"</span>, X_house_test.shape[<span class="dv">0</span>])</span>
<span id="cb15-16"><a href="#cb15-16"></a></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co"># Task 4: Train MLR model</span></span>
<span id="cb15-18"><a href="#cb15-18"></a>mlr_model_houses <span class="op">=</span> LinearRegression()</span>
<span id="cb15-19"><a href="#cb15-19"></a>mlr_model_houses.fit(X_house_train, y_house_train)</span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="bu">print</span>(<span class="st">"-&gt; Model training complete."</span>)</span>
<span id="cb15-21"><a href="#cb15-21"></a></span>
<span id="cb15-22"><a href="#cb15-22"></a><span class="co"># Task 5: Print intercept and coefficients (pair with names)</span></span>
<span id="cb15-23"><a href="#cb15-23"></a>intercept_houses <span class="op">=</span> mlr_model_houses.intercept_</span>
<span id="cb15-24"><a href="#cb15-24"></a>coefficients_houses <span class="op">=</span> mlr_model_houses.coef_</span>
<span id="cb15-25"><a href="#cb15-25"></a>feature_names_houses <span class="op">=</span> X_house_train.columns</span>
<span id="cb15-26"><a href="#cb15-26"></a></span>
<span id="cb15-27"><a href="#cb15-27"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">-&gt; Model Intercept (β₀): </span><span class="sc">{</span>intercept_houses<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb15-28"><a href="#cb15-28"></a><span class="bu">print</span>(<span class="st">"-&gt; Model Coefficients (β):"</span>)</span>
<span id="cb15-29"><a href="#cb15-29"></a><span class="cf">for</span> feature, coef <span class="kw">in</span> <span class="bu">zip</span>(feature_names_houses, coefficients_houses):</span>
<span id="cb15-30"><a href="#cb15-30"></a>    <span class="bu">print</span>(<span class="ss">f"   - </span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>coef<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb15-31"><a href="#cb15-31"></a></span>
<span id="cb15-32"><a href="#cb15-32"></a><span class="co"># --- Interpretation ---</span></span>
<span id="cb15-33"><a href="#cb15-33"></a><span class="co"># Coefficient for SqFt: The coefficient for SqFt (approx. 180.56) means that for each additional</span></span>
<span id="cb15-34"><a href="#cb15-34"></a><span class="co"># square foot of space, the predicted house price increases by about $180.56, *assuming the number of bathrooms remains constant*.</span></span>
<span id="cb15-35"><a href="#cb15-35"></a><span class="co">#</span></span>
<span id="cb15-36"><a href="#cb15-36"></a><span class="co"># Coefficient for Bathrooms: The coefficient for Bathrooms (approx. 40341.00) means that for each</span></span>
<span id="cb15-37"><a href="#cb15-37"></a><span class="co"># additional full bathroom, the predicted house price increases by about $40,341, *assuming the square footage remains constant*.</span></span>
<span id="cb15-38"><a href="#cb15-38"></a><span class="co"># The interpretation hinges on holding the *other* variables in the model constant.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-&gt; Shape of X_houses: (250, 2)
-&gt; Shape of y_houses: (250,)

-&gt; Data split complete:
   Training set size: 200
   Test set size: 50
-&gt; Model training complete.

-&gt; Model Intercept (β₀): 6372.77
-&gt; Model Coefficients (β):
   - SqFt: 188.20
   - Bathrooms: 42829.53</code></pre>
</div>
</div>
</section>
<section id="solution-problem-4---evaluating-mlr-for-customer-satisfaction" class="level2">
<h2 class="anchored" data-anchor-id="solution-problem-4---evaluating-mlr-for-customer-satisfaction">Solution: Problem 4 - Evaluating MLR for Customer Satisfaction</h2>
<div id="sol4" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># --- Solution Code for Problem 4 ---</span></span>
<span id="cb17-2"><a href="#cb17-2"></a></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co"># Task 2: Define X and y</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>X_satisfaction <span class="op">=</span> df_satisfaction[[<span class="st">'ResponseTime'</span>, <span class="st">'ResolutionRate'</span>]]</span>
<span id="cb17-5"><a href="#cb17-5"></a>y_satisfaction <span class="op">=</span> df_satisfaction[<span class="st">'SatisfactionScore'</span>]</span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="bu">print</span>(<span class="st">"-&gt; Shape of X_satisfaction:"</span>, X_satisfaction.shape)</span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="bu">print</span>(<span class="st">"-&gt; Shape of y_satisfaction:"</span>, y_satisfaction.shape)</span>
<span id="cb17-8"><a href="#cb17-8"></a></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co"># Task 3: Train-Test Split</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>X_sat_train, X_sat_test, y_sat_train, y_sat_test <span class="op">=</span> train_test_split(</span>
<span id="cb17-11"><a href="#cb17-11"></a>    X_satisfaction, y_satisfaction, test_size<span class="op">=</span><span class="fl">0.30</span>, random_state<span class="op">=</span><span class="dv">104</span></span>
<span id="cb17-12"><a href="#cb17-12"></a>)</span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">-&gt; Data split complete:"</span>)</span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="bu">print</span>(<span class="st">"   Training set size:"</span>, X_sat_train.shape[<span class="dv">0</span>])</span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="bu">print</span>(<span class="st">"   Test set size:"</span>, X_sat_test.shape[<span class="dv">0</span>])</span>
<span id="cb17-16"><a href="#cb17-16"></a></span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="co"># Task 4: Train MLR model</span></span>
<span id="cb17-18"><a href="#cb17-18"></a>mlr_model_satisfaction <span class="op">=</span> LinearRegression()</span>
<span id="cb17-19"><a href="#cb17-19"></a>mlr_model_satisfaction.fit(X_sat_train, y_sat_train)</span>
<span id="cb17-20"><a href="#cb17-20"></a><span class="bu">print</span>(<span class="st">"-&gt; Model training complete."</span>)</span>
<span id="cb17-21"><a href="#cb17-21"></a></span>
<span id="cb17-22"><a href="#cb17-22"></a><span class="co"># Task 5: Make predictions on test set</span></span>
<span id="cb17-23"><a href="#cb17-23"></a>y_sat_pred_test <span class="op">=</span> mlr_model_satisfaction.predict(X_sat_test)</span>
<span id="cb17-24"><a href="#cb17-24"></a><span class="bu">print</span>(<span class="st">"-&gt; Predictions made on the test set."</span>)</span>
<span id="cb17-25"><a href="#cb17-25"></a></span>
<span id="cb17-26"><a href="#cb17-26"></a><span class="co"># Task 6: Calculate and print R2 and RMSE</span></span>
<span id="cb17-27"><a href="#cb17-27"></a>r2_sat <span class="op">=</span> r2_score(y_sat_test, y_sat_pred_test)</span>
<span id="cb17-28"><a href="#cb17-28"></a>mse_sat <span class="op">=</span> mean_squared_error(y_sat_test, y_sat_pred_test)</span>
<span id="cb17-29"><a href="#cb17-29"></a>rmse_sat <span class="op">=</span> np.sqrt(mse_sat)</span>
<span id="cb17-30"><a href="#cb17-30"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">-&gt; Test Set Evaluation Metrics:"</span>)</span>
<span id="cb17-31"><a href="#cb17-31"></a><span class="bu">print</span>(<span class="ss">f"   R-squared (R²): </span><span class="sc">{</span>r2_sat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb17-32"><a href="#cb17-32"></a><span class="bu">print</span>(<span class="ss">f"   Root Mean Squared Error (RMSE): </span><span class="sc">{</span>rmse_sat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb17-33"><a href="#cb17-33"></a></span>
<span id="cb17-34"><a href="#cb17-34"></a><span class="co"># Also print coefficients to answer interpretation question easily</span></span>
<span id="cb17-35"><a href="#cb17-35"></a>intercept_sat <span class="op">=</span> mlr_model_satisfaction.intercept_</span>
<span id="cb17-36"><a href="#cb17-36"></a>coefficients_sat <span class="op">=</span> mlr_model_satisfaction.coef_</span>
<span id="cb17-37"><a href="#cb17-37"></a>feature_names_sat <span class="op">=</span> X_sat_train.columns</span>
<span id="cb17-38"><a href="#cb17-38"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">-&gt; Model Intercept (β₀): </span><span class="sc">{</span>intercept_sat<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb17-39"><a href="#cb17-39"></a><span class="bu">print</span>(<span class="st">"-&gt; Model Coefficients (β):"</span>)</span>
<span id="cb17-40"><a href="#cb17-40"></a><span class="cf">for</span> feature, coef <span class="kw">in</span> <span class="bu">zip</span>(feature_names_sat, coefficients_sat):</span>
<span id="cb17-41"><a href="#cb17-41"></a>    <span class="bu">print</span>(<span class="ss">f"   - </span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>coef<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb17-42"><a href="#cb17-42"></a></span>
<span id="cb17-43"><a href="#cb17-43"></a><span class="co"># Task 7: Predict for a new scenario</span></span>
<span id="cb17-44"><a href="#cb17-44"></a>new_scenario_sat <span class="op">=</span> pd.DataFrame({</span>
<span id="cb17-45"><a href="#cb17-45"></a>    <span class="st">'ResponseTime'</span>: [<span class="dv">3</span>],      <span class="co"># 3 hours</span></span>
<span id="cb17-46"><a href="#cb17-46"></a>    <span class="st">'ResolutionRate'</span>: [<span class="dv">95</span>]    <span class="co"># 95%</span></span>
<span id="cb17-47"><a href="#cb17-47"></a>})</span>
<span id="cb17-48"><a href="#cb17-48"></a>predicted_satisfaction <span class="op">=</span> mlr_model_satisfaction.predict(new_scenario_sat)</span>
<span id="cb17-49"><a href="#cb17-49"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">-&gt; Predicted Satisfaction for ResponseTime=3, ResolutionRate=95%: </span><span class="sc">{</span>predicted_satisfaction[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb17-50"><a href="#cb17-50"></a></span>
<span id="cb17-51"><a href="#cb17-51"></a></span>
<span id="cb17-52"><a href="#cb17-52"></a><span class="co"># --- Interpretation ---</span></span>
<span id="cb17-53"><a href="#cb17-53"></a><span class="co"># R-squared (R²): The R² value (approx. 0.7961) on the test set indicates that about 79.61% of the variance</span></span>
<span id="cb17-54"><a href="#cb17-54"></a><span class="co"># in customer satisfaction scores can be explained by the linear combination of average support ticket response time</span></span>
<span id="cb17-55"><a href="#cb17-55"></a><span class="co"># and the resolution rate, according to this model. It suggests that these two factors together provide a good</span></span>
<span id="cb17-56"><a href="#cb17-56"></a><span class="co"># explanation for satisfaction levels in the unseen test data.</span></span>
<span id="cb17-57"><a href="#cb17-57"></a><span class="co">#</span></span>
<span id="cb17-58"><a href="#cb17-58"></a><span class="co"># ResponseTime Coefficient Sign: Yes, the coefficient for ResponseTime (approx. -0.310) is negative.</span></span>
<span id="cb17-59"><a href="#cb17-59"></a><span class="co"># This aligns with the expectation that longer response times (higher values) are associated with lower</span></span>
<span id="cb17-60"><a href="#cb17-60"></a><span class="co"># satisfaction scores, holding resolution rate constant. For each additional hour of response time,</span></span>
<span id="cb17-61"><a href="#cb17-61"></a><span class="co"># satisfaction is predicted to decrease by about 0.31 points on the 1-10 scale, holding resolution rate constant.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-&gt; Shape of X_satisfaction: (200, 2)
-&gt; Shape of y_satisfaction: (200,)

-&gt; Data split complete:
   Training set size: 140
   Test set size: 60
-&gt; Model training complete.
-&gt; Predictions made on the test set.

-&gt; Test Set Evaluation Metrics:
   R-squared (R²): 0.5464
   Root Mean Squared Error (RMSE): 0.6800

-&gt; Model Intercept (β₀): 2.759
-&gt; Model Coefficients (β):
   - ResponseTime: -0.316
   - ResolutionRate: 0.054

-&gt; Predicted Satisfaction for ResponseTime=3, ResolutionRate=95%: 6.92</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>