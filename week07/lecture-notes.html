<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Smith">

<title>Week 6: Working with Pandas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="week6-lecture-notes_files/libs/clipboard/clipboard.min.js"></script>
<script src="week6-lecture-notes_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="week6-lecture-notes_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="week6-lecture-notes_files/libs/quarto-html/popper.min.js"></script>
<script src="week6-lecture-notes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="week6-lecture-notes_files/libs/quarto-html/anchor.min.js"></script>
<link href="week6-lecture-notes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="week6-lecture-notes_files/libs/quarto-html/quarto-syntax-highlighting-4a990d8dcb58f517c7c86712b8f2ac7c.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="week6-lecture-notes_files/libs/quarto-html/quarto-syntax-highlighting-dark-46f4cc9626f044588a66931b604fc9c8.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="week6-lecture-notes_files/libs/quarto-html/quarto-syntax-highlighting-4a990d8dcb58f517c7c86712b8f2ac7c.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="week6-lecture-notes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="week6-lecture-notes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="week6-lecture-notes_files/libs/bootstrap/bootstrap-7fb405d50af379f6f99cb0e774c9922f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="week6-lecture-notes_files/libs/bootstrap/bootstrap-dark-d2c9d76e2ea35e59204fefcb7aa2b466.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="week6-lecture-notes_files/libs/bootstrap/bootstrap-7fb405d50af379f6f99cb0e774c9922f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#week-6-working-with-pandas" id="toc-week-6-working-with-pandas" class="nav-link active" data-scroll-target="#week-6-working-with-pandas">Week 6: Working with Pandas</a>
  <ul class="collapse">
  <li><a href="#why-use-pandas" id="toc-why-use-pandas" class="nav-link" data-scroll-target="#why-use-pandas">1. Why Use Pandas?</a></li>
  <li><a href="#setting-up-pandas" id="toc-setting-up-pandas" class="nav-link" data-scroll-target="#setting-up-pandas">2. Setting Up Pandas</a></li>
  <li><a href="#pandas-data-structures" id="toc-pandas-data-structures" class="nav-link" data-scroll-target="#pandas-data-structures">3. Pandas Data Structures</a></li>
  <li><a href="#indexing-selecting-and-filtering-data" id="toc-indexing-selecting-and-filtering-data" class="nav-link" data-scroll-target="#indexing-selecting-and-filtering-data">4. Indexing, Selecting, and Filtering Data</a></li>
  <li><a href="#data-cleaning-and-transformation" id="toc-data-cleaning-and-transformation" class="nav-link" data-scroll-target="#data-cleaning-and-transformation">5. Data Cleaning and Transformation</a></li>
  <li><a href="#grouping-aggregation-merging-and-pivot-tables" id="toc-grouping-aggregation-merging-and-pivot-tables" class="nav-link" data-scroll-target="#grouping-aggregation-merging-and-pivot-tables">6. Grouping, Aggregation, Merging, and Pivot Tables</a></li>
  <li><a href="#data-persistence" id="toc-data-persistence" class="nav-link" data-scroll-target="#data-persistence">7. Data Persistence</a></li>
  <li><a href="#real-world-applications-in-business-analytics" id="toc-real-world-applications-in-business-analytics" class="nav-link" data-scroll-target="#real-world-applications-in-business-analytics">8. Real-World Applications in Business Analytics</a></li>
  <li><a href="#conclusion-and-next-steps" id="toc-conclusion-and-next-steps" class="nav-link" data-scroll-target="#conclusion-and-next-steps">9. Conclusion and Next Steps</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 6: Working with Pandas</h1>
<p class="subtitle lead">DataFrames, Data Manipulation, and Advanced Operations</p>
</div>


<div class="quarto-title-meta-author column-page-right">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Dr.&nbsp;Smith </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of South Florida
          </p>
      </div>
  </div>

<div class="quarto-title-meta column-page-right">

      
  
    
  </div>
  


</header>


<style>
/* Canvas iframe optimization */
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  font-size: 16px;
  line-height: 1.5;
  color: #212529;
}

/* When NOT in iframe - force 1400px width */
@media screen {
  body:not(.in-iframe) .content {
    max-width: 1400px !important;
    width: 1400px !important;
    margin: 0 auto;
  }
  
  body:not(.in-iframe) #quarto-content {
    max-width: 1400px !important;
  }
  
  body:not(.in-iframe) .page-layout-full {
    max-width: 1400px !important;
  }
}

/* When IN iframe - responsive width */
@media screen {
  body.in-iframe {
    margin: 0;
    padding: 15px;
    max-width: 100%;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
    font-size: 16px;
    line-height: 1.5;
    color: #212529;
  }
  .in-iframe .quarto-container {
    max-width: 100%;
    padding: 0 15px;
  }
  .in-iframe #quarto-content {
    max-width: 100%;
  }
  .in-iframe .page-layout-article {
    grid-template-columns: minmax(0, 1fr);
  }
  .in-iframe .page-layout-full {
    grid-template-columns: minmax(0, 1fr);
  }
  .in-iframe .sidebar {
    width: 200px !important;
    font-size: 0.9em;
  }
  .in-iframe .sidebar.toc-left {
    width: 200px !important;
    margin-right: 15px;
  }
  .in-iframe .column-body {
    grid-column: 1;
    max-width: 100%;
  }
  .in-iframe #quarto-document-content {
    max-width: calc(100% - 220px);
    padding: 0 15px;
  }
  .in-iframe pre {
    overflow-x: auto;
    max-width: 100%;
    font-size: 0.9em;
  }
  .in-iframe code {
    font-size: 0.9em;
  }
  .in-iframe table {
    display: block;
    overflow-x: auto;
    max-width: 100%;
    font-size: 0.9em;
  }
  .in-iframe img {
    max-width: 100%;
    height: auto;
  }
  .in-iframe .callout {
    margin: 1em 0;
    padding: 0.5em 1em;
  }
  .in-iframe .sourceCode {
    max-width: 100%;
    overflow-x: auto;
  }
  .in-iframe .cell {
    max-width: 100%;
  }
  .in-iframe body {
    font-size: 15px;
  }
  .in-iframe h1 {
    font-size: 1.8em;
  }
  .in-iframe h2 {
    font-size: 1.5em;
  }
  .in-iframe h3 {
    font-size: 1.3em;
  }
  .in-iframe h4 {
    font-size: 1.1em;
  }
  .in-iframe #quarto-margin-sidebar {
    display: none !important;
  }
  .in-iframe .margin-sidebar {
    display: none !important;
  }
  
  /* Ensure proper paragraph spacing */
  .in-iframe p {
    margin-bottom: 1rem;
  }
  
  /* Maintain list styling */
  .in-iframe ul, .in-iframe ol {
    margin-bottom: 1rem;
  }
}

@media screen and (max-width: 768px) {
  .in-iframe .sidebar {
    display: none !important;
  }
  .in-iframe #quarto-document-content {
    max-width: 100%;
  }
  .in-iframe body {
    font-size: 14px;
  }
}
</style>
<script>
if (window.self !== window.top) {
  document.addEventListener("DOMContentLoaded", function() {
    document.body.classList.add("in-iframe");
  });
}
</script>
<style>
.graphviz, .graphviz svg, .graphviz img {
  overflow: visible !important;
  width: auto !important;
  height: auto !important;
  max-width: none !important;
  max-height: none !important;
}
.remark-embed-container {
  overflow: visible !important;
  height: auto !important;
}
figcaption {
  margin: auto;
  text-align: center;
}
</style>
<section id="week-6-working-with-pandas" class="level1">
<h1>Week 6: Working with Pandas</h1>
<p>Welcome to Week 6 of <strong>ISM4641: Python for Business Analytics</strong>. Today’s lecture will introduce you to <strong>Pandas</strong>, a powerful library for data analysis in Python. In this session, we will learn what Pandas is, why it’s essential for business analytics, and how to use it to clean, manipulate, and analyze data.</p>
<div class="callout callout-style-simple callout-note callout-titled" title="Background:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Background:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pandas was created to provide easy-to-use data structures and data analysis tools for Python. Its name is derived from “panel data,” a term used in econometrics, highlighting its utility in handling multidimensional data.</p>
</div>
</div>
<hr>
<section id="why-use-pandas" class="level2">
<h2 class="anchored" data-anchor-id="why-use-pandas">1. Why Use Pandas?</h2>
<p>Pandas is a cornerstone for data analysis because it simplifies working with structured data. Here are some of the key reasons for its use:</p>
<ul>
<li><p><strong>Intuitive Data Structures:</strong></p>
<ul>
<li><strong>Series:</strong> A one-dimensional labeled array (similar to a column in Excel).<br>
</li>
<li><strong>DataFrame:</strong> A two-dimensional table (like a spreadsheet or SQL table).</li>
</ul></li>
<li><p><strong>Data Cleaning and Transformation:</strong><br>
Easily handle missing values, filter data, and transform datasets—essential for preparing real-world data for analysis.</p></li>
<li><p><strong>Integration with Other Libraries:</strong><br>
Pandas works seamlessly with libraries such as NumPy, Matplotlib, and Seaborn, enabling you to build comprehensive analytics pipelines.</p></li>
</ul>
<div class="callout callout-style-simple callout-tip callout-titled" title="When to Use Pandas:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
When to Use Pandas:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use Pandas whenever you need to work with tabular data (CSV files, Excel spreadsheets, SQL query results) and want to perform operations like grouping, filtering, or joining datasets.</p>
</div>
</div>
<hr>
</section>
<section id="setting-up-pandas" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-pandas">2. Setting Up Pandas</h2>
<section id="installation-and-importing" class="level3">
<h3 class="anchored" data-anchor-id="installation-and-importing">2.1 Installation and Importing</h3>
<p>Before you start, ensure Pandas is installed. In many environments, including Google Colab, it’s pre-installed. If working locally, install it using:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="ex">pip</span> install pandas</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then, import Pandas in your script or notebook:</p>
<div id="b4764c0e" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled" title="Quick Tip:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Quick Tip:
</div>
</div>
<div class="callout-body-container callout-body">
<p>We import Pandas with the alias <code>pd</code> to keep our code concise.</p>
</div>
</div>
<hr>
</section>
</section>
<section id="pandas-data-structures" class="level2">
<h2 class="anchored" data-anchor-id="pandas-data-structures">3. Pandas Data Structures</h2>
<section id="the-series" class="level3">
<h3 class="anchored" data-anchor-id="the-series">3.1 The Series</h3>
<p>A <strong>Series</strong> is a one-dimensional array with labels (indices). It is similar to a single column in a spreadsheet.</p>
<section id="example-creating-a-series" class="level4">
<h4 class="anchored" data-anchor-id="example-creating-a-series">Example: Creating a Series</h4>
<div id="3c736553" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Creating a Series from a list of sales figures</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>sales_series <span class="op">=</span> pd.Series([<span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">250</span>, <span class="dv">300</span>])</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="bu">print</span>(<span class="st">"Sales Series:"</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="bu">print</span>(sales_series)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sales Series:
0    100
1    150
2    200
3    250
4    300
dtype: int64</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" title="Understanding Indices:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Understanding Indices:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pandas automatically assigns an index starting at 0. You can also specify custom indices:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>custom_sales <span class="op">=</span> pd.Series([<span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">250</span>, <span class="dv">300</span>], index<span class="op">=</span>[<span class="st">'Mon'</span>, <span class="st">'Tue'</span>, <span class="st">'Wed'</span>, <span class="st">'Thu'</span>, <span class="st">'Fri'</span>])</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="bu">print</span>(custom_sales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Or do the same by using a dictionary:</p>
<div id="88633c7c" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Creating a Series from a list of sales figures</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>sales_series <span class="op">=</span> pd.Series({<span class="st">"Monday"</span>:<span class="dv">100</span>, <span class="st">"Tuesday"</span>:<span class="dv">150</span>, <span class="st">"Wednesday"</span>:<span class="dv">200</span>, <span class="st">"Thursday"</span>:<span class="dv">250</span>, <span class="st">"Friday"</span>:<span class="dv">300</span>})</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="bu">print</span>(<span class="st">"Sales Series:"</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="bu">print</span>(sales_series)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sales Series:
Monday       100
Tuesday      150
Wednesday    200
Thursday     250
Friday       300
dtype: int64</code></pre>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="the-dataframe" class="level3">
<h3 class="anchored" data-anchor-id="the-dataframe">3.2 The DataFrame</h3>
<p>A <strong>DataFrame</strong> is a two-dimensional table with rows and columns.</p>
<section id="example-creating-a-dataframe" class="level4">
<h4 class="anchored" data-anchor-id="example-creating-a-dataframe">Example: Creating a DataFrame</h4>
<div id="5623e9fa" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Creating a DataFrame from a dictionary</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>data <span class="op">=</span> {</span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="st">'Product'</span>: [<span class="st">'Laptop'</span>, <span class="st">'Mouse'</span>, <span class="st">'Keyboard'</span>, <span class="st">'Monitor'</span>],</span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="st">'Price'</span>: [<span class="fl">999.99</span>, <span class="fl">29.99</span>, <span class="fl">49.99</span>, <span class="fl">199.99</span>],</span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="st">'Stock'</span>: [<span class="dv">50</span>, <span class="dv">150</span>, <span class="dv">100</span>, <span class="dv">75</span>]</span>
<span id="cb8-6"><a href="#cb8-6"></a>}</span>
<span id="cb8-7"><a href="#cb8-7"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="bu">print</span>(<span class="st">"Initial DataFrame:"</span>)</span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initial DataFrame:
    Product   Price  Stock
0    Laptop  999.99     50
1     Mouse   29.99    150
2  Keyboard   49.99    100
3   Monitor  199.99     75</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled" title="When to Use DataFrames:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
When to Use DataFrames:
</div>
</div>
<div class="callout-body-container callout-body">
<p>DataFrames are ideal when you have multiple variables (columns) that describe your data records (rows)—common in business analytics for tracking products, sales, and customer data.</p>
</div>
</div>
<p><strong>Additional Example:</strong><br>
You can also create a DataFrame from a list of dictionaries:</p>
<div id="4852c20b" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>data_list <span class="op">=</span> [</span>
<span id="cb10-2"><a href="#cb10-2"></a>    {<span class="st">'Product'</span>: <span class="st">'Laptop'</span>, <span class="st">'Price'</span>: <span class="fl">999.99</span>, <span class="st">'Stock'</span>: <span class="dv">50</span>},</span>
<span id="cb10-3"><a href="#cb10-3"></a>    {<span class="st">'Product'</span>: <span class="st">'Mouse'</span>, <span class="st">'Price'</span>: <span class="fl">29.99</span>, <span class="st">'Stock'</span>: <span class="dv">150</span>},</span>
<span id="cb10-4"><a href="#cb10-4"></a>    {<span class="st">'Product'</span>: <span class="st">'Keyboard'</span>, <span class="st">'Price'</span>: <span class="fl">49.99</span>, <span class="st">'Stock'</span>: <span class="dv">100</span>},</span>
<span id="cb10-5"><a href="#cb10-5"></a>    {<span class="st">'Product'</span>: <span class="st">'Monitor'</span>, <span class="st">'Price'</span>: <span class="fl">199.99</span>, <span class="st">'Stock'</span>: <span class="dv">75</span>}</span>
<span id="cb10-6"><a href="#cb10-6"></a>]</span>
<span id="cb10-7"><a href="#cb10-7"></a>df2 <span class="op">=</span> pd.DataFrame(data_list)</span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="bu">print</span>(df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Product   Price  Stock
0    Laptop  999.99     50
1     Mouse   29.99    150
2  Keyboard   49.99    100
3   Monitor  199.99     75</code></pre>
</div>
</div>
<p>Just in case the above examples that contrast iloc and loc are confusing, let’s look at another example where the index for the dataframe is not like regular numeric indices.</p>
<div id="1437fb9a" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co"># Creating a DataFrame with custom row labels</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>data <span class="op">=</span> {</span>
<span id="cb12-5"><a href="#cb12-5"></a>    <span class="st">'Product'</span>: [<span class="st">'Laptop'</span>, <span class="st">'Mouse'</span>, <span class="st">'Keyboard'</span>, <span class="st">'Monitor'</span>],</span>
<span id="cb12-6"><a href="#cb12-6"></a>    <span class="st">'Price'</span>: [<span class="fl">999.99</span>, <span class="fl">29.99</span>, <span class="fl">49.99</span>, <span class="fl">199.99</span>],</span>
<span id="cb12-7"><a href="#cb12-7"></a>    <span class="st">'Stock'</span>: [<span class="dv">50</span>, <span class="dv">150</span>, <span class="dv">100</span>, <span class="dv">75</span>]</span>
<span id="cb12-8"><a href="#cb12-8"></a>}</span>
<span id="cb12-9"><a href="#cb12-9"></a>custom_index <span class="op">=</span> [<span class="st">'L1'</span>, <span class="st">'M1'</span>, <span class="st">'K1'</span>, <span class="st">'N1'</span>]</span>
<span id="cb12-10"><a href="#cb12-10"></a>df_named <span class="op">=</span> pd.DataFrame(data, index<span class="op">=</span>custom_index)</span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="bu">print</span>(<span class="st">"DataFrame with custom row labels:"</span>)</span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="bu">print</span>(df_named)</span>
<span id="cb12-13"><a href="#cb12-13"></a></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co"># Using .loc to retrieve the row with label 'M1'</span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Using .loc to retrieve the row with label 'M1':"</span>)</span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="bu">print</span>(df_named.loc[<span class="st">'M1'</span>])</span>
<span id="cb12-17"><a href="#cb12-17"></a></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co"># Using .iloc to retrieve the row at index position 1</span></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="co"># (which corresponds to the row with label 'M1')</span></span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Using .iloc to retrieve the row at index position 1:"</span>)</span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="bu">print</span>(df_named.iloc[<span class="dv">1</span>])</span>
<span id="cb12-22"><a href="#cb12-22"></a></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co"># Demonstrating slicing with both .loc and .iloc</span></span>
<span id="cb12-24"><a href="#cb12-24"></a><span class="co"># Note: .loc slicing is inclusive of the end label, while .iloc slicing is exclusive of the end index.</span></span>
<span id="cb12-25"><a href="#cb12-25"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Using .loc to slice rows from 'M1' to 'N1':"</span>)</span>
<span id="cb12-26"><a href="#cb12-26"></a><span class="bu">print</span>(df_named.loc[<span class="st">'M1'</span>:<span class="st">'N1'</span>])</span>
<span id="cb12-27"><a href="#cb12-27"></a></span>
<span id="cb12-28"><a href="#cb12-28"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Using .iloc to slice rows from index position 1 to 3:"</span>)</span>
<span id="cb12-29"><a href="#cb12-29"></a><span class="bu">print</span>(df_named.iloc[<span class="dv">1</span>:<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame with custom row labels:
     Product   Price  Stock
L1    Laptop  999.99     50
M1     Mouse   29.99    150
K1  Keyboard   49.99    100
N1   Monitor  199.99     75

Using .loc to retrieve the row with label 'M1':
Product    Mouse
Price      29.99
Stock        150
Name: M1, dtype: object

Using .iloc to retrieve the row at index position 1:
Product    Mouse
Price      29.99
Stock        150
Name: M1, dtype: object

Using .loc to slice rows from 'M1' to 'N1':
     Product   Price  Stock
M1     Mouse   29.99    150
K1  Keyboard   49.99    100
N1   Monitor  199.99     75

Using .iloc to slice rows from index position 1 to 3:
     Product  Price  Stock
M1     Mouse  29.99    150
K1  Keyboard  49.99    100</code></pre>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="indexing-selecting-and-filtering-data" class="level2">
<h2 class="anchored" data-anchor-id="indexing-selecting-and-filtering-data">4. Indexing, Selecting, and Filtering Data</h2>
<section id="accessing-columns-and-rows" class="level3">
<h3 class="anchored" data-anchor-id="accessing-columns-and-rows">4.1 Accessing Columns and Rows</h3>
<section id="selecting-columns" class="level4">
<h4 class="anchored" data-anchor-id="selecting-columns">Selecting Columns</h4>
<div id="3a49b850" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Selecting the 'Price' column from the DataFrame</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>prices <span class="op">=</span> df[<span class="st">'Price'</span>]</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="bu">print</span>(<span class="st">"Prices:"</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="bu">print</span>(prices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Prices:
0    999.99
1     29.99
2     49.99
3    199.99
Name: Price, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="selecting-rows" class="level4">
<h4 class="anchored" data-anchor-id="selecting-rows">Selecting Rows</h4>
<p>Pandas provides two primary methods for selecting rows: - <strong><code>.loc</code>:</strong> For label-based indexing. - <strong><code>.iloc</code>:</strong> For position-based indexing.</p>
<div id="76158831" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Using .loc to select the first row by its label</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>first_row <span class="op">=</span> df.loc[<span class="dv">0</span>]</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="bu">print</span>(<span class="st">"First row using .loc:"</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="bu">print</span>(first_row)</span>
<span id="cb16-5"><a href="#cb16-5"></a></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co"># Using .iloc to select the first row by position</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>first_row_iloc <span class="op">=</span> df.iloc[<span class="dv">0</span>]</span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="bu">print</span>(<span class="st">"First row using .iloc:"</span>)</span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="bu">print</span>(first_row_iloc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>First row using .loc:
Product    Laptop
Price      999.99
Stock          50
Name: 0, dtype: object
First row using .iloc:
Product    Laptop
Price      999.99
Stock          50
Name: 0, dtype: object</code></pre>
</div>
</div>
<p><strong>Additional Example:</strong><br>
Selecting multiple rows using <code>.iloc</code>:</p>
<div id="beac5e7b" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>first_two_rows <span class="op">=</span> df.iloc[<span class="dv">0</span>:<span class="dv">2</span>]</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="bu">print</span>(<span class="st">"First two rows:"</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="bu">print</span>(first_two_rows)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>First two rows:
  Product   Price  Stock
0  Laptop  999.99     50
1   Mouse   29.99    150</code></pre>
</div>
</div>
</section>
</section>
<section id="filtering-data" class="level3">
<h3 class="anchored" data-anchor-id="filtering-data">4.2 Filtering Data</h3>
<p>Filtering extracts rows that meet a specific condition.</p>
<section id="example-filtering-rows-by-condition" class="level4">
<h4 class="anchored" data-anchor-id="example-filtering-rows-by-condition">Example: Filtering Rows by Condition</h4>
<div id="ece2631c" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Filter products with a Price greater than 50</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>expensive_products <span class="op">=</span> df[df[<span class="st">'Price'</span>] <span class="op">&gt;</span> <span class="dv">50</span>]</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="bu">print</span>(<span class="st">"Products with Price &gt; 50:"</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="bu">print</span>(expensive_products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Products with Price &gt; 50:
   Product   Price  Stock
0   Laptop  999.99     50
3  Monitor  199.99     75</code></pre>
</div>
</div>
<div id="03ca6720" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Filter products with Price &gt; 30 and Price &lt; 200</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>mid_range_products <span class="op">=</span> df[(df[<span class="st">'Price'</span>] <span class="op">&gt;</span> <span class="dv">30</span>) <span class="op">&amp;</span> (df[<span class="st">'Price'</span>] <span class="op">&lt;</span> <span class="dv">200</span>)]</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="bu">print</span>(<span class="st">"Products with Price &gt; 30 and &lt; 200:"</span>)</span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="bu">print</span>(mid_range_products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Products with Price &gt; 30 and &lt; 200:
    Product   Price  Stock
2  Keyboard   49.99    100
3   Monitor  199.99     75</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" title="Boolean Indexing:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Boolean Indexing:
</div>
</div>
<div class="callout-body-container callout-body">
<p>The expression <code>df['Price'] &gt; 50</code> creates a boolean Series (True/False for each row). Pandas then returns only the rows where the condition is <code>True</code>.</p>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" title="Operator Differences: `and` vs `&amp;`">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Operator Differences: <code>and</code> vs <code>&amp;</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>In Python, and is a logical operator used to combine boolean expressions that evaluate to a single boolean value. It expects scalar (single) boolean values and does not operate element-wise on sequences such as lists, NumPy arrays, or Pandas Series.</p>
<p>In contrast, the bitwise &amp; operator is used to perform an element-wise logical “and” operation. When filtering Pandas DataFrames, each condition (e.g., df[‘Price’] &gt; 30) produces a boolean Series. The &amp; operator then evaluates the condition for each corresponding element in these Series. Important: Enclose each condition in parentheses to ensure the correct order of operations, as the bitwise operator has a lower precedence compared to the comparison operators.</p>
</div>
</div>
<p><strong>Additional Examples:</strong></p>
<p>Filtering with string conditions:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Filter products whose name contains the letter 'o'</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>products_with_o <span class="op">=</span> df[df[<span class="st">'Product'</span>].<span class="bu">str</span>.contains(<span class="st">"o"</span>)]</span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="bu">print</span>(<span class="st">"Products with 'o' in the name:"</span>)</span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="bu">print</span>(products_with_o)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
</section>
</section>
<section id="data-cleaning-and-transformation" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-and-transformation">5. Data Cleaning and Transformation</h2>
<p>Real-world data often contains missing or inconsistent values. Pandas provides methods to handle these.</p>
<section id="handling-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="handling-missing-data">5.1 Handling Missing Data</h3>
<section id="identifying-missing-values" class="level4">
<h4 class="anchored" data-anchor-id="identifying-missing-values">Identifying Missing Values</h4>
<div id="2124a3e6" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># Creating a DataFrame with missing values</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>data_with_nan <span class="op">=</span> {</span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="st">'Product'</span>: [<span class="st">'Laptop'</span>, <span class="st">'Mouse'</span>, <span class="st">'Keyboard'</span>, <span class="st">'Monitor'</span>],</span>
<span id="cb25-4"><a href="#cb25-4"></a>  <span class="st">'Price'</span>: [<span class="fl">999.99</span>, <span class="va">None</span>, <span class="fl">49.99</span>, <span class="fl">199.99</span>],</span>
<span id="cb25-5"><a href="#cb25-5"></a>  <span class="st">'Stock'</span>: [<span class="dv">50</span>, <span class="dv">150</span>, <span class="va">None</span>, <span class="dv">75</span>]</span>
<span id="cb25-6"><a href="#cb25-6"></a>}</span>
<span id="cb25-7"><a href="#cb25-7"></a>df_nan <span class="op">=</span> pd.DataFrame(data_with_nan)</span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="bu">print</span>(<span class="st">"DataFrame with Missing Values:"</span>)</span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="bu">print</span>(df_nan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame with Missing Values:
    Product   Price  Stock
0    Laptop  999.99   50.0
1     Mouse     NaN  150.0
2  Keyboard   49.99    NaN
3   Monitor  199.99   75.0</code></pre>
</div>
</div>
</section>
<section id="filling-missing-values" class="level4">
<h4 class="anchored" data-anchor-id="filling-missing-values">Filling Missing Values</h4>
<div id="46e0708b" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># Fill missing values: fill Price with the mean and Stock with 0</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>df_nan[<span class="st">'Price'</span>].fillna(df_nan[<span class="st">'Price'</span>].mean(), inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-3"><a href="#cb27-3"></a>df_nan[<span class="st">'Stock'</span>].fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="bu">print</span>(<span class="st">"DataFrame after Filling Missing Values:"</span>)</span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="bu">print</span>(df_nan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame after Filling Missing Values:
    Product       Price  Stock
0    Laptop  999.990000   50.0
1     Mouse  416.656667  150.0
2  Keyboard   49.990000    0.0
3   Monitor  199.990000   75.0</code></pre>
</div>
</div>
</section>
<section id="dropping-missing-values" class="level4">
<h4 class="anchored" data-anchor-id="dropping-missing-values">Dropping Missing Values</h4>
<div id="a0f80b9f" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># Creating a DataFrame with missing values</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>data_with_nan <span class="op">=</span> pd.DataFrame(</span>
<span id="cb29-3"><a href="#cb29-3"></a>  {</span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="st">'Product'</span>: [<span class="st">'Laptop'</span>, <span class="st">'Mouse'</span>, <span class="st">'Keyboard'</span>, <span class="st">'Monitor'</span>],</span>
<span id="cb29-5"><a href="#cb29-5"></a>  <span class="st">'Price'</span>: [<span class="fl">999.99</span>, <span class="va">None</span>, <span class="fl">49.99</span>, <span class="fl">199.99</span>],</span>
<span id="cb29-6"><a href="#cb29-6"></a>  <span class="st">'Stock'</span>: [<span class="dv">50</span>, <span class="dv">150</span>, <span class="va">None</span>, <span class="dv">75</span>]</span>
<span id="cb29-7"><a href="#cb29-7"></a>  }</span>
<span id="cb29-8"><a href="#cb29-8"></a>)</span>
<span id="cb29-9"><a href="#cb29-9"></a></span>
<span id="cb29-10"><a href="#cb29-10"></a><span class="bu">print</span>(<span class="st">"Before Drop:"</span>)</span>
<span id="cb29-11"><a href="#cb29-11"></a><span class="bu">print</span>(data_with_nan)</span>
<span id="cb29-12"><a href="#cb29-12"></a></span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="co"># Alternatively, drop any rows that contain missing values</span></span>
<span id="cb29-14"><a href="#cb29-14"></a>df_dropna <span class="op">=</span> data_with_nan.dropna()</span>
<span id="cb29-15"><a href="#cb29-15"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">DataFrame after Dropping Missing Values:"</span>)</span>
<span id="cb29-16"><a href="#cb29-16"></a><span class="bu">print</span>(df_dropna)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Before Drop:
    Product   Price  Stock
0    Laptop  999.99   50.0
1     Mouse     NaN  150.0
2  Keyboard   49.99    NaN
3   Monitor  199.99   75.0

DataFrame after Dropping Missing Values:
   Product   Price  Stock
0   Laptop  999.99   50.0
3  Monitor  199.99   75.0</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled" title="Best Practice:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Best Practice:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Always inspect your data for missing values before analysis. Choose to fill or drop missing data based on your analysis needs.</p>
</div>
</div>
</section>
</section>
<section id="data-transformation" class="level3">
<h3 class="anchored" data-anchor-id="data-transformation">5.2 Data Transformation</h3>
<p>Data transformation might include adding new columns, renaming, or modifying existing data.</p>
<section id="example-adding-a-calculated-column" class="level4">
<h4 class="anchored" data-anchor-id="example-adding-a-calculated-column">Example: Adding a Calculated Column</h4>
<div id="d3b63d0b" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># Add a new column for Total Value: Price multiplied by Stock</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>df[<span class="st">'Total Value'</span>] <span class="op">=</span> df[<span class="st">'Price'</span>] <span class="op">*</span> df[<span class="st">'Stock'</span>]</span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="bu">print</span>(<span class="st">"DataFrame with Total Value Column:"</span>)</span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame with Total Value Column:
    Product   Price  Stock  Total Value
0    Laptop  999.99     50     49999.50
1     Mouse   29.99    150      4498.50
2  Keyboard   49.99    100      4999.00
3   Monitor  199.99     75     14999.25</code></pre>
</div>
</div>
</section>
<section id="example-applying-a-discount" class="level4">
<h4 class="anchored" data-anchor-id="example-applying-a-discount">Example: Applying a Discount</h4>
<div id="a98f0593" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># Create a new column for Discounted Price with a 10% discount applied</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>df[<span class="st">'Discounted Price'</span>] <span class="op">=</span> df[<span class="st">'Price'</span>] <span class="op">*</span> <span class="fl">0.90</span></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="bu">print</span>(<span class="st">"DataFrame with Discounted Price:"</span>)</span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame with Discounted Price:
    Product   Price  Stock  Total Value  Discounted Price
0    Laptop  999.99     50     49999.50           899.991
1     Mouse   29.99    150      4498.50            26.991
2  Keyboard   49.99    100      4999.00            44.991
3   Monitor  199.99     75     14999.25           179.991</code></pre>
</div>
</div>
</section>
<section id="example-renaming-columns" class="level4">
<h4 class="anchored" data-anchor-id="example-renaming-columns">Example: Renaming Columns</h4>
<div id="2296ad43" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># Rename columns for clarity</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>df.rename(columns<span class="op">=</span>{<span class="st">'Product'</span>: <span class="st">'Item'</span>, <span class="st">'Stock'</span>: <span class="st">'Inventory'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="bu">print</span>(<span class="st">"DataFrame with Renamed Columns:"</span>)</span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame with Renamed Columns:
       Item   Price  Inventory  Total Value  Discounted Price
0    Laptop  999.99         50     49999.50           899.991
1     Mouse   29.99        150      4498.50            26.991
2  Keyboard   49.99        100      4999.00            44.991
3   Monitor  199.99         75     14999.25           179.991</code></pre>
</div>
</div>
<p><strong>Additional Example:</strong><br>
Converting a column to a different data type (this is often required when importing data from a file):</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># Convert the 'Price' column to integer values for rounding purposes</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>df[<span class="st">'Price_Int'</span>] <span class="op">=</span> df[<span class="st">'Price'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="bu">print</span>(<span class="st">"DataFrame with Price converted to Integer:"</span>)</span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-note callout-titled" title="Real-World Use:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Real-World Use:
</div>
</div>
<div class="callout-body-container callout-body">
<p>In business analytics, these transformations are common. You might calculate revenue, apply discounts, or compute profit margins to derive actionable insights.</p>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="grouping-aggregation-merging-and-pivot-tables" class="level2">
<h2 class="anchored" data-anchor-id="grouping-aggregation-merging-and-pivot-tables">6. Grouping, Aggregation, Merging, and Pivot Tables</h2>
<section id="grouping-and-aggregation" class="level3">
<h3 class="anchored" data-anchor-id="grouping-and-aggregation">6.1 Grouping and Aggregation</h3>
<p>Grouping lets you summarize data based on specific keys.</p>
<section id="example-grouping-sales-data" class="level4">
<h4 class="anchored" data-anchor-id="example-grouping-sales-data">Example: Grouping Sales Data</h4>
<div id="b349ec63" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># Create a sample DataFrame of sales data</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>sales_data <span class="op">=</span> {</span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="st">'Region'</span>: [<span class="st">'North'</span>, <span class="st">'South'</span>, <span class="st">'East'</span>, <span class="st">'West'</span>, <span class="st">'North'</span>, <span class="st">'South'</span>],</span>
<span id="cb38-4"><a href="#cb38-4"></a>  <span class="st">'Sales'</span>: [<span class="dv">250</span>, <span class="dv">300</span>, <span class="dv">450</span>, <span class="dv">500</span>, <span class="dv">350</span>, <span class="dv">400</span>]</span>
<span id="cb38-5"><a href="#cb38-5"></a>}</span>
<span id="cb38-6"><a href="#cb38-6"></a>df_sales <span class="op">=</span> pd.DataFrame(sales_data)</span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="bu">print</span>(<span class="st">"Input DataFrame is:"</span>)</span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="bu">print</span>(df_sales)</span>
<span id="cb38-9"><a href="#cb38-9"></a></span>
<span id="cb38-10"><a href="#cb38-10"></a><span class="co"># Group by 'Region' and sum the Sales for each region</span></span>
<span id="cb38-11"><a href="#cb38-11"></a>grouped_sales <span class="op">=</span> df_sales.groupby(<span class="st">'Region'</span>).<span class="bu">sum</span>()</span>
<span id="cb38-12"><a href="#cb38-12"></a><span class="bu">print</span>(<span class="st">"Grouped Sales by Region:"</span>)</span>
<span id="cb38-13"><a href="#cb38-13"></a><span class="bu">print</span>(grouped_sales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Input DataFrame is:
  Region  Sales
0  North    250
1  South    300
2   East    450
3   West    500
4  North    350
5  South    400
Grouped Sales by Region:
        Sales
Region       
East      450
North     600
South     700
West      500</code></pre>
</div>
</div>
</section>
<section id="example-multiple-aggregations" class="level4">
<h4 class="anchored" data-anchor-id="example-multiple-aggregations">Example: Multiple Aggregations</h4>
<div id="ec3b90ff" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># Calculate both total and average sales per region</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>aggregated_sales <span class="op">=</span> df_sales.groupby(<span class="st">'Region'</span>).agg({<span class="st">'Sales'</span>: [<span class="st">'sum'</span>, <span class="st">'mean'</span>]})</span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="bu">print</span>(<span class="st">"Aggregated Sales (Sum and Mean) by Region:"</span>)</span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="bu">print</span>(aggregated_sales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Aggregated Sales (Sum and Mean) by Region:
       Sales       
         sum   mean
Region             
East     450  450.0
North    600  300.0
South    700  350.0
West     500  500.0</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" title="Aggregation Functions:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Aggregation Functions:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Functions such as <code>sum()</code>, <code>mean()</code>, <code>min()</code>, <code>max()</code>, and <code>count()</code> help summarize your data, making it easier to extract meaningful insights.</p>
</div>
</div>
</section>
</section>
<section id="merging-and-joining-dataframes" class="level3">
<h3 class="anchored" data-anchor-id="merging-and-joining-dataframes">6.2 Merging and Joining DataFrames</h3>
<p>Merging combines datasets based on common keys—similar to SQL joins.</p>
<section id="example-merging-customer-and-order-data" class="level4">
<h4 class="anchored" data-anchor-id="example-merging-customer-and-order-data">Example: Merging Customer and Order Data</h4>
<div id="57a175e0" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># Sample customer DataFrame</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>df_customers <span class="op">=</span> pd.DataFrame({</span>
<span id="cb42-3"><a href="#cb42-3"></a>  <span class="st">'CustomerID'</span>: [<span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">103</span>],</span>
<span id="cb42-4"><a href="#cb42-4"></a>  <span class="st">'Name'</span>: [<span class="st">'Alice'</span>, <span class="st">'Bob'</span>, <span class="st">'Charlie'</span>]</span>
<span id="cb42-5"><a href="#cb42-5"></a>})</span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="bu">print</span>(<span class="st">"Customers DataFrame:"</span>)</span>
<span id="cb42-7"><a href="#cb42-7"></a><span class="bu">print</span>(df_customers)</span>
<span id="cb42-8"><a href="#cb42-8"></a></span>
<span id="cb42-9"><a href="#cb42-9"></a><span class="co"># Sample orders DataFrame</span></span>
<span id="cb42-10"><a href="#cb42-10"></a>df_orders <span class="op">=</span> pd.DataFrame({</span>
<span id="cb42-11"><a href="#cb42-11"></a>  <span class="st">'CustomerID'</span>: [<span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">101</span>],</span>
<span id="cb42-12"><a href="#cb42-12"></a>  <span class="st">'OrderID'</span>: [<span class="dv">1001</span>, <span class="dv">1002</span>, <span class="dv">1003</span>],</span>
<span id="cb42-13"><a href="#cb42-13"></a>  <span class="st">'Amount'</span>: [<span class="dv">250</span>, <span class="dv">150</span>, <span class="dv">300</span>]</span>
<span id="cb42-14"><a href="#cb42-14"></a>})</span>
<span id="cb42-15"><a href="#cb42-15"></a><span class="bu">print</span>(<span class="st">"Orders DataFrame:"</span>)</span>
<span id="cb42-16"><a href="#cb42-16"></a><span class="bu">print</span>(df_orders)</span>
<span id="cb42-17"><a href="#cb42-17"></a></span>
<span id="cb42-18"><a href="#cb42-18"></a><span class="co"># Merge the DataFrames on CustomerID</span></span>
<span id="cb42-19"><a href="#cb42-19"></a>merged_df <span class="op">=</span> pd.merge(df_customers, df_orders, on<span class="op">=</span><span class="st">'CustomerID'</span>)</span>
<span id="cb42-20"><a href="#cb42-20"></a><span class="bu">print</span>(<span class="st">"Merged Customer-Order DataFrame:"</span>)</span>
<span id="cb42-21"><a href="#cb42-21"></a><span class="bu">print</span>(merged_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Customers DataFrame:
   CustomerID     Name
0         101    Alice
1         102      Bob
2         103  Charlie
Orders DataFrame:
   CustomerID  OrderID  Amount
0         101     1001     250
1         102     1002     150
2         101     1003     300
Merged Customer-Order DataFrame:
   CustomerID   Name  OrderID  Amount
0         101  Alice     1001     250
1         101  Alice     1003     300
2         102    Bob     1002     150</code></pre>
</div>
</div>
</section>
<section id="example-left-join-vs.-inner-join" class="level4">
<h4 class="anchored" data-anchor-id="example-left-join-vs.-inner-join">Example: Left Join vs.&nbsp;Inner Join</h4>
<div id="852eaa90" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># Left join: retains all customers, even if they have no matching orders</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>left_join_df <span class="op">=</span> pd.merge(df_customers, df_orders, on<span class="op">=</span><span class="st">'CustomerID'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="bu">print</span>(<span class="st">"Left Join (All Customers):"</span>)</span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="bu">print</span>(left_join_df)</span>
<span id="cb44-5"><a href="#cb44-5"></a></span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="co"># Inner join: only includes customers with matching orders</span></span>
<span id="cb44-7"><a href="#cb44-7"></a>inner_join_df <span class="op">=</span> pd.merge(df_customers, df_orders, on<span class="op">=</span><span class="st">'CustomerID'</span>, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb44-8"><a href="#cb44-8"></a><span class="bu">print</span>(<span class="st">"Inner Join (Customers with Orders):"</span>)</span>
<span id="cb44-9"><a href="#cb44-9"></a><span class="bu">print</span>(inner_join_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Left Join (All Customers):
   CustomerID     Name  OrderID  Amount
0         101    Alice   1001.0   250.0
1         101    Alice   1003.0   300.0
2         102      Bob   1002.0   150.0
3         103  Charlie      NaN     NaN
Inner Join (Customers with Orders):
   CustomerID   Name  OrderID  Amount
0         101  Alice     1001     250
1         101  Alice     1003     300
2         102    Bob     1002     150</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled" title="Joining Data:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Joining Data:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Choose the type of join (left, right, inner, outer) based on your data needs. For example, a left join is useful to maintain a full list of customers while bringing in order details where available.</p>
</div>
</div>
</section>
<section id="example-concatenating-two-dataframes" class="level4">
<h4 class="anchored" data-anchor-id="example-concatenating-two-dataframes">Example: Concatenating two DataFrames</h4>
<div id="71741049" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb46-2"><a href="#cb46-2"></a></span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="co"># Sample DataFrame Part 1</span></span>
<span id="cb46-4"><a href="#cb46-4"></a>df_part1 <span class="op">=</span> pd.DataFrame({</span>
<span id="cb46-5"><a href="#cb46-5"></a>    <span class="st">'CustomerID'</span>: [<span class="dv">101</span>, <span class="dv">102</span>],</span>
<span id="cb46-6"><a href="#cb46-6"></a>    <span class="st">'Name'</span>: [<span class="st">'Alice'</span>, <span class="st">'Bob'</span>]</span>
<span id="cb46-7"><a href="#cb46-7"></a>})</span>
<span id="cb46-8"><a href="#cb46-8"></a><span class="bu">print</span>(<span class="st">"Customer DataFrame Part 1:"</span>)</span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="bu">print</span>(df_part1)</span>
<span id="cb46-10"><a href="#cb46-10"></a></span>
<span id="cb46-11"><a href="#cb46-11"></a><span class="co"># Sample DataFrame Part 2</span></span>
<span id="cb46-12"><a href="#cb46-12"></a>df_part2 <span class="op">=</span> pd.DataFrame({</span>
<span id="cb46-13"><a href="#cb46-13"></a>    <span class="st">'CustomerID'</span>: [<span class="dv">103</span>, <span class="dv">104</span>],</span>
<span id="cb46-14"><a href="#cb46-14"></a>    <span class="st">'Name'</span>: [<span class="st">'Charlie'</span>, <span class="st">'Diana'</span>]</span>
<span id="cb46-15"><a href="#cb46-15"></a>})</span>
<span id="cb46-16"><a href="#cb46-16"></a><span class="bu">print</span>(<span class="st">"Customer DataFrame Part 2:"</span>)</span>
<span id="cb46-17"><a href="#cb46-17"></a><span class="bu">print</span>(df_part2)</span>
<span id="cb46-18"><a href="#cb46-18"></a></span>
<span id="cb46-19"><a href="#cb46-19"></a><span class="co"># Concatenating the DataFrames by rows</span></span>
<span id="cb46-20"><a href="#cb46-20"></a>concatenated_df <span class="op">=</span> pd.concat([df_part1, df_part2], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-21"><a href="#cb46-21"></a><span class="bu">print</span>(<span class="st">"Concatenated DataFrame (joined by rows):"</span>)</span>
<span id="cb46-22"><a href="#cb46-22"></a><span class="bu">print</span>(concatenated_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Customer DataFrame Part 1:
   CustomerID   Name
0         101  Alice
1         102    Bob
Customer DataFrame Part 2:
   CustomerID     Name
0         103  Charlie
1         104    Diana
Concatenated DataFrame (joined by rows):
   CustomerID     Name
0         101    Alice
1         102      Bob
2         103  Charlie
3         104    Diana</code></pre>
</div>
</div>
</section>
</section>
<section id="creating-pivot-tables" class="level3">
<h3 class="anchored" data-anchor-id="creating-pivot-tables">6.3 Creating Pivot Tables</h3>
<p>Pivot tables summarize data in a compact format, often revealing trends and patterns.</p>
<section id="example-pivot-table-for-total-sales-by-region" class="level4">
<h4 class="anchored" data-anchor-id="example-pivot-table-for-total-sales-by-region">Example: Pivot Table for Total Sales by Region</h4>
<div class="sourceCode" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># Create a pivot table summarizing total sales by region</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>pivot_table <span class="op">=</span> pd.pivot_table(df_sales, values<span class="op">=</span><span class="st">'Sales'</span>, index<span class="op">=</span><span class="st">'Region'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>)</span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="bu">print</span>(<span class="st">"Pivot Table - Total Sales by Region:"</span>)</span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="bu">print</span>(pivot_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="additional-example-pivot-table-with-multiple-aggregations" class="level4">
<h4 class="anchored" data-anchor-id="additional-example-pivot-table-with-multiple-aggregations">Additional Example: Pivot Table with Multiple Aggregations</h4>
<div id="8317e1bf" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># Detailed sales data with additional metrics</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>detailed_sales <span class="op">=</span> {</span>
<span id="cb49-3"><a href="#cb49-3"></a>  <span class="st">'Region'</span>: [<span class="st">'North'</span>, <span class="st">'South'</span>, <span class="st">'North'</span>, <span class="st">'East'</span>, <span class="st">'South'</span>, <span class="st">'West'</span>],</span>
<span id="cb49-4"><a href="#cb49-4"></a>  <span class="st">'Sales'</span>: [<span class="dv">250</span>, <span class="dv">300</span>, <span class="dv">350</span>, <span class="dv">450</span>, <span class="dv">400</span>, <span class="dv">500</span>],</span>
<span id="cb49-5"><a href="#cb49-5"></a>  <span class="st">'Units'</span>: [<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">20</span>, <span class="dv">18</span>, <span class="dv">25</span>]</span>
<span id="cb49-6"><a href="#cb49-6"></a>}</span>
<span id="cb49-7"><a href="#cb49-7"></a>df_detailed <span class="op">=</span> pd.DataFrame(detailed_sales)</span>
<span id="cb49-8"><a href="#cb49-8"></a>pivot_multi <span class="op">=</span> pd.pivot_table(df_detailed, values<span class="op">=</span>[<span class="st">'Sales'</span>, <span class="st">'Units'</span>], index<span class="op">=</span><span class="st">'Region'</span>, </span>
<span id="cb49-9"><a href="#cb49-9"></a>                              aggfunc<span class="op">=</span>{<span class="st">'Sales'</span>: <span class="st">'sum'</span>, <span class="st">'Units'</span>: <span class="st">'mean'</span>})</span>
<span id="cb49-10"><a href="#cb49-10"></a><span class="bu">print</span>(<span class="st">"Pivot Table with Multiple Aggregations:"</span>)</span>
<span id="cb49-11"><a href="#cb49-11"></a><span class="bu">print</span>(pivot_multi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pivot Table with Multiple Aggregations:
        Sales  Units
Region              
East      450   20.0
North     600   11.0
South     700   16.5
West      500   25.0</code></pre>
</div>
</div>
</section>
<section id="additional-example-pivot-table-with-count-and-mean-aggregations" class="level4">
<h4 class="anchored" data-anchor-id="additional-example-pivot-table-with-count-and-mean-aggregations">Additional Example: Pivot Table with Count and Mean Aggregations</h4>
<div id="98816bd1" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># Using the detailed sales DataFrame, create a pivot table that calculates </span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="co"># the number of sales records (count) and the average sales per region.</span></span>
<span id="cb51-3"><a href="#cb51-3"></a>pivot_count_mean <span class="op">=</span> pd.pivot_table(df_detailed, values<span class="op">=</span><span class="st">'Sales'</span>, index<span class="op">=</span><span class="st">'Region'</span>, </span>
<span id="cb51-4"><a href="#cb51-4"></a>                                  aggfunc<span class="op">=</span>[<span class="st">'count'</span>, <span class="st">'mean'</span>])</span>
<span id="cb51-5"><a href="#cb51-5"></a><span class="bu">print</span>(<span class="st">"Pivot Table - Count and Average Sales by Region:"</span>)</span>
<span id="cb51-6"><a href="#cb51-6"></a><span class="bu">print</span>(pivot_count_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pivot Table - Count and Average Sales by Region:
       count   mean
       Sales  Sales
Region             
East       1  450.0
North      2  300.0
South      2  350.0
West       1  500.0</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled" title="Insight Generation:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insight Generation:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pivot tables are powerful for summarizing large datasets quickly. They help you see the big picture—such as total sales per region, average values, or record counts—enabling faster decision-making.</p>
</div>
</div>
</section>
</section>
<section id="common-aggregation-functions-for-pivot-tables" class="level3">
<h3 class="anchored" data-anchor-id="common-aggregation-functions-for-pivot-tables">Common Aggregation Functions for Pivot Tables</h3>
<p>When creating pivot tables in Pandas, you can use a variety of aggregation functions. Some of the most common functions include:</p>
<ul>
<li><strong><code>sum</code></strong>: Calculates the total sum of values.</li>
<li><strong><code>mean</code></strong>: Computes the average of values.</li>
<li><strong><code>median</code></strong>: Finds the middle value.</li>
<li><strong><code>min</code></strong>: Returns the minimum value.</li>
<li><strong><code>max</code></strong>: Returns the maximum value.</li>
<li><strong><code>count</code></strong>: Counts the number of non-null entries.</li>
<li><strong><code>std</code></strong>: Computes the standard deviation.</li>
<li><strong><code>var</code></strong>: Calculates the variance.</li>
<li><strong><code>first</code></strong>: Returns the first value in the group.</li>
<li><strong><code>last</code></strong>: Returns the last value in the group.</li>
</ul>
<p>Additionally, you can also pass custom functions or a list of these functions to perform multiple aggregations simultaneously.</p>
<p>Here is an example where we use a custom function (Note: You will not be tested on this; it’s included for completeness of covered of the topic - and for students that want more advanced material):</p>
<div id="e622b8e3" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb53-2"><a href="#cb53-2"></a></span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="co"># Define a custom function to calculate the range (max - min)</span></span>
<span id="cb53-4"><a href="#cb53-4"></a><span class="kw">def</span> sales_range(x):</span>
<span id="cb53-5"><a href="#cb53-5"></a>    <span class="cf">return</span> x.<span class="bu">max</span>() <span class="op">-</span> x.<span class="bu">min</span>()</span>
<span id="cb53-6"><a href="#cb53-6"></a></span>
<span id="cb53-7"><a href="#cb53-7"></a><span class="co"># Sample sales data</span></span>
<span id="cb53-8"><a href="#cb53-8"></a>sales_data <span class="op">=</span> {</span>
<span id="cb53-9"><a href="#cb53-9"></a>    <span class="st">'Region'</span>: [<span class="st">'North'</span>, <span class="st">'South'</span>, <span class="st">'North'</span>, <span class="st">'East'</span>, <span class="st">'South'</span>, <span class="st">'West'</span>],</span>
<span id="cb53-10"><a href="#cb53-10"></a>    <span class="st">'Sales'</span>: [<span class="dv">250</span>, <span class="dv">300</span>, <span class="dv">350</span>, <span class="dv">450</span>, <span class="dv">400</span>, <span class="dv">500</span>],</span>
<span id="cb53-11"><a href="#cb53-11"></a>    <span class="st">'Units'</span>: [<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">20</span>, <span class="dv">18</span>, <span class="dv">25</span>]</span>
<span id="cb53-12"><a href="#cb53-12"></a>}</span>
<span id="cb53-13"><a href="#cb53-13"></a>df_sales_custom <span class="op">=</span> pd.DataFrame(sales_data)</span>
<span id="cb53-14"><a href="#cb53-14"></a></span>
<span id="cb53-15"><a href="#cb53-15"></a><span class="co"># Create a pivot table using the custom aggregation function for Sales</span></span>
<span id="cb53-16"><a href="#cb53-16"></a>pivot_custom <span class="op">=</span> pd.pivot_table(df_sales_custom, values<span class="op">=</span><span class="st">'Sales'</span>, index<span class="op">=</span><span class="st">'Region'</span>, aggfunc<span class="op">=</span>sales_range)</span>
<span id="cb53-17"><a href="#cb53-17"></a><span class="bu">print</span>(<span class="st">"Pivot Table - Sales Range by Region (Custom Function):"</span>)</span>
<span id="cb53-18"><a href="#cb53-18"></a><span class="bu">print</span>(pivot_custom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pivot Table - Sales Range by Region (Custom Function):
        Sales
Region       
East        0
North     100
South     100
West        0</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="data-persistence" class="level2">
<h2 class="anchored" data-anchor-id="data-persistence">7. Data Persistence</h2>
<p>Persisting your data allows you to save your work and share your results.</p>
<section id="saving-data-to-files" class="level3">
<h3 class="anchored" data-anchor-id="saving-data-to-files">7.1 Saving Data to Files</h3>
<section id="saving-to-csv" class="level4">
<h4 class="anchored" data-anchor-id="saving-to-csv">Saving to CSV</h4>
<div id="8ed5bfdb" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a><span class="co"># Save the products DataFrame to a CSV file</span></span>
<span id="cb55-2"><a href="#cb55-2"></a>df.to_csv(<span class="st">"products.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="bu">print</span>(<span class="st">"DataFrame saved to 'products.csv'."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame saved to 'products.csv'.</code></pre>
</div>
</div>
</section>
<section id="saving-to-excel" class="level4">
<h4 class="anchored" data-anchor-id="saving-to-excel">Saving to Excel</h4>
<div id="fb3de307" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a><span class="co"># Save the products DataFrame to an Excel file (requires openpyxl)</span></span>
<span id="cb57-2"><a href="#cb57-2"></a>df.to_excel(<span class="st">"products.xlsx"</span>, index<span class="op">=</span><span class="va">False</span>, sheet_name<span class="op">=</span><span class="st">"Products"</span>)</span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="bu">print</span>(<span class="st">"DataFrame saved to 'products.xlsx'."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame saved to 'products.xlsx'.</code></pre>
</div>
</div>
</section>
</section>
<section id="loading-data-from-files" class="level3">
<h3 class="anchored" data-anchor-id="loading-data-from-files">7.2 Loading Data from Files</h3>
<section id="reading-from-csv" class="level4">
<h4 class="anchored" data-anchor-id="reading-from-csv">Reading from CSV</h4>
<div id="393f5ba1" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1"></a>df_loaded <span class="op">=</span> pd.read_csv(<span class="st">"products.csv"</span>)</span>
<span id="cb59-2"><a href="#cb59-2"></a><span class="bu">print</span>(<span class="st">"DataFrame loaded from CSV:"</span>)</span>
<span id="cb59-3"><a href="#cb59-3"></a><span class="bu">print</span>(df_loaded)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame loaded from CSV:
       Item   Price  Inventory  Total Value  Discounted Price
0    Laptop  999.99         50     49999.50           899.991
1     Mouse   29.99        150      4498.50            26.991
2  Keyboard   49.99        100      4999.00            44.991
3   Monitor  199.99         75     14999.25           179.991</code></pre>
</div>
</div>
</section>
<section id="reading-from-excel" class="level4">
<h4 class="anchored" data-anchor-id="reading-from-excel">Reading from Excel</h4>
<div id="3dd77ac9" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1"></a>df_loaded_excel <span class="op">=</span> pd.read_excel(<span class="st">"products.xlsx"</span>, sheet_name<span class="op">=</span><span class="st">"Products"</span>)</span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="bu">print</span>(<span class="st">"DataFrame loaded from Excel:"</span>)</span>
<span id="cb61-3"><a href="#cb61-3"></a><span class="bu">print</span>(df_loaded_excel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame loaded from Excel:
       Item   Price  Inventory  Total Value  Discounted Price
0    Laptop  999.99         50     49999.50           899.991
1     Mouse   29.99        150      4498.50            26.991
2  Keyboard   49.99        100      4999.00            44.991
3   Monitor  199.99         75     14999.25           179.991</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled" title="File Formats:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
File Formats:
</div>
</div>
<div class="callout-body-container callout-body">
<p>CSV files are plain text and widely supported, while Excel files allow multiple sheets and advanced formatting options.</p>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled" title="Tip: Loading Data Directly from the Web">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip: Loading Data Directly from the Web
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can load data from a URL using Pandas’ <code>read_csv()</code> function. This allows you to work with datasets hosted on the internet without manually downloading them first.</p>
<div id="89d3f758" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb63-2"><a href="#cb63-2"></a></span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="co"># URL for the BostonHousing dataset hosted on GitHub</span></span>
<span id="cb63-4"><a href="#cb63-4"></a>url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/prof-tcsmith/data/refs/heads/master/BostonHousing.csv"</span></span>
<span id="cb63-5"><a href="#cb63-5"></a></span>
<span id="cb63-6"><a href="#cb63-6"></a><span class="co"># Load the dataset into a DataFrame</span></span>
<span id="cb63-7"><a href="#cb63-7"></a>df_boston <span class="op">=</span> pd.read_csv(url)</span>
<span id="cb63-8"><a href="#cb63-8"></a></span>
<span id="cb63-9"><a href="#cb63-9"></a><span class="co"># Display the first few rows of the DataFrame</span></span>
<span id="cb63-10"><a href="#cb63-10"></a><span class="bu">print</span>(<span class="st">"First 5 rows of the Boston Housing dataset:"</span>)</span>
<span id="cb63-11"><a href="#cb63-11"></a><span class="bu">print</span>(df_boston.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>First 5 rows of the Boston Housing dataset:
      CRIM    ZN  INDUS  CHAS    NOX     RM   AGE     DIS  RAD  TAX  PTRATIO  \
0  0.00632  18.0   2.31     0  0.538  6.575  65.2  4.0900    1  296     15.3   
1  0.02731   0.0   7.07     0  0.469  6.421  78.9  4.9671    2  242     17.8   
2  0.02729   0.0   7.07     0  0.469  7.185  61.1  4.9671    2  242     17.8   
3  0.03237   0.0   2.18     0  0.458  6.998  45.8  6.0622    3  222     18.7   
4  0.06905   0.0   2.18     0  0.458  7.147  54.2  6.0622    3  222     18.7   

   LSTAT  MEDV  CAT. MEDV  
0   4.98  24.0          0  
1   9.14  21.6          0  
2   4.03  34.7          1  
3   2.94  33.4          1  
4   5.33  36.2          1  </code></pre>
</div>
</div>
<p>In this example, the <code>read_csv()</code> function reads the CSV data directly from the provided URL and loads it into the DataFrame <code>df_boston</code>. This method is particularly useful when you want to work with up-to-date data hosted online.</p>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="real-world-applications-in-business-analytics" class="level2">
<h2 class="anchored" data-anchor-id="real-world-applications-in-business-analytics">8. Real-World Applications in Business Analytics</h2>
<p>Let’s explore some practical scenarios where Pandas becomes a vital tool.</p>
<section id="sales-performance-analysis" class="level3">
<h3 class="anchored" data-anchor-id="sales-performance-analysis">8.1 Sales Performance Analysis</h3>
<p>Imagine you have daily sales data and need to compute trends like moving averages.</p>
<div id="2025b924" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># Sample daily sales data with dates</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>daily_sales <span class="op">=</span> {</span>
<span id="cb65-3"><a href="#cb65-3"></a>  <span class="st">'Date'</span>: pd.date_range(start<span class="op">=</span><span class="st">'2025-01-01'</span>, periods<span class="op">=</span><span class="dv">7</span>),</span>
<span id="cb65-4"><a href="#cb65-4"></a>  <span class="st">'Sales'</span>: [<span class="dv">250</span>, <span class="dv">300</span>, <span class="dv">280</span>, <span class="dv">320</span>, <span class="dv">310</span>, <span class="dv">290</span>, <span class="dv">330</span>]</span>
<span id="cb65-5"><a href="#cb65-5"></a>}</span>
<span id="cb65-6"><a href="#cb65-6"></a>df_daily_sales <span class="op">=</span> pd.DataFrame(daily_sales)</span>
<span id="cb65-7"><a href="#cb65-7"></a></span>
<span id="cb65-8"><a href="#cb65-8"></a><span class="co"># Calculate a 3-day moving average to smooth out short-term fluctuations</span></span>
<span id="cb65-9"><a href="#cb65-9"></a>df_daily_sales[<span class="st">'3-Day Moving Average'</span>] <span class="op">=</span> df_daily_sales[<span class="st">'Sales'</span>].rolling(window<span class="op">=</span><span class="dv">3</span>).mean()</span>
<span id="cb65-10"><a href="#cb65-10"></a><span class="bu">print</span>(<span class="st">"Daily Sales with 3-Day Moving Average:"</span>)</span>
<span id="cb65-11"><a href="#cb65-11"></a><span class="bu">print</span>(df_daily_sales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Daily Sales with 3-Day Moving Average:
        Date  Sales  3-Day Moving Average
0 2025-01-01    250                   NaN
1 2025-01-02    300                   NaN
2 2025-01-03    280            276.666667
3 2025-01-04    320            300.000000
4 2025-01-05    310            303.333333
5 2025-01-06    290            306.666667
6 2025-01-07    330            310.000000</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled" title="Practical Application:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practical Application:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Moving averages help reduce daily volatility, making it easier to forecast trends. This is essential for planning inventory and managing cash flow.</p>
</div>
</div>
</section>
<section id="customer-segmentation" class="level3">
<h3 class="anchored" data-anchor-id="customer-segmentation">8.2 Customer Segmentation</h3>
<p>By merging customer information with order history, you can identify high-value customers.</p>
<div id="4e874703" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1"></a><span class="co"># Merge customer and order data from earlier</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>customer_orders <span class="op">=</span> pd.merge(df_customers, df_orders, on<span class="op">=</span><span class="st">'CustomerID'</span>)</span>
<span id="cb67-3"><a href="#cb67-3"></a><span class="co"># Group by customer name and calculate the total spending</span></span>
<span id="cb67-4"><a href="#cb67-4"></a>segmentation <span class="op">=</span> customer_orders.groupby(<span class="st">'Name'</span>)[<span class="st">'Amount'</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb67-5"><a href="#cb67-5"></a>segmentation.rename(columns<span class="op">=</span>{<span class="st">'Amount'</span>: <span class="st">'Total Spent'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb67-6"><a href="#cb67-6"></a><span class="bu">print</span>(<span class="st">"Customer Segmentation Analysis:"</span>)</span>
<span id="cb67-7"><a href="#cb67-7"></a><span class="bu">print</span>(segmentation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Customer Segmentation Analysis:
    Name  Total Spent
0  Alice          550
1    Bob          150</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled" title="Business Insight:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Business Insight:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Segmenting customers by total spending can help tailor marketing strategies and reward high-value clients.</p>
</div>
</div>
</section>
<section id="inventory-management-analysis" class="level3">
<h3 class="anchored" data-anchor-id="inventory-management-analysis">8.3 Inventory Management Analysis</h3>
<p>In business, maintaining optimal inventory levels is critical. Pandas can help analyze inventory data across multiple warehouses or product lines.</p>
<div id="3620dcc3" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1"></a><span class="co"># Sample inventory data for different products across multiple stores</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>inventory_data <span class="op">=</span> {</span>
<span id="cb69-3"><a href="#cb69-3"></a>  <span class="st">'Store'</span>: [<span class="st">'Store A'</span>, <span class="st">'Store A'</span>, <span class="st">'Store B'</span>, <span class="st">'Store B'</span>, <span class="st">'Store C'</span>, <span class="st">'Store C'</span>],</span>
<span id="cb69-4"><a href="#cb69-4"></a>  <span class="st">'Product'</span>: [<span class="st">'Laptop'</span>, <span class="st">'Mouse'</span>, <span class="st">'Laptop'</span>, <span class="st">'Mouse'</span>, <span class="st">'Laptop'</span>, <span class="st">'Mouse'</span>],</span>
<span id="cb69-5"><a href="#cb69-5"></a>  <span class="st">'Stock'</span>: [<span class="dv">20</span>, <span class="dv">100</span>, <span class="dv">15</span>, <span class="dv">120</span>, <span class="dv">25</span>, <span class="dv">80</span>],</span>
<span id="cb69-6"><a href="#cb69-6"></a>  <span class="st">'Reorder Level'</span>: [<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">10</span>, <span class="dv">50</span>]</span>
<span id="cb69-7"><a href="#cb69-7"></a>}</span>
<span id="cb69-8"><a href="#cb69-8"></a>df_inventory <span class="op">=</span> pd.DataFrame(inventory_data)</span>
<span id="cb69-9"><a href="#cb69-9"></a><span class="bu">print</span>(<span class="st">"Inventory Data:"</span>)</span>
<span id="cb69-10"><a href="#cb69-10"></a><span class="bu">print</span>(df_inventory)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Inventory Data:
     Store Product  Stock  Reorder Level
0  Store A  Laptop     20             10
1  Store A   Mouse    100             50
2  Store B  Laptop     15             10
3  Store B   Mouse    120             50
4  Store C  Laptop     25             10
5  Store C   Mouse     80             50</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Example Analysis:</strong><br>
Identify products with stock below the reorder level:</p>
</blockquote>
<div id="da5057a6" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># Filter items where Stock is below Reorder Level</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>low_stock <span class="op">=</span> df_inventory[df_inventory[<span class="st">'Stock'</span>] <span class="op">&lt;</span> df_inventory[<span class="st">'Reorder Level'</span>]]</span>
<span id="cb71-3"><a href="#cb71-3"></a><span class="bu">print</span>(<span class="st">"Products below Reorder Level:"</span>)</span>
<span id="cb71-4"><a href="#cb71-4"></a><span class="bu">print</span>(low_stock)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Products below Reorder Level:
Empty DataFrame
Columns: [Store, Product, Stock, Reorder Level]
Index: []</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Additional Aggregation:</strong><br>
Group by product to see overall inventory across all stores:</p>
</blockquote>
<div id="187ba474" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a>inventory_summary <span class="op">=</span> df_inventory.groupby(<span class="st">'Product'</span>).agg({<span class="st">'Stock'</span>: <span class="st">'sum'</span>})</span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="bu">print</span>(<span class="st">"Total Stock by Product:"</span>)</span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="bu">print</span>(inventory_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total Stock by Product:
         Stock
Product       
Laptop      60
Mouse      300</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled" title="Real-World Use:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Real-World Use:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Effective inventory management minimizes stockouts and overstock situations, helping optimize costs and improve customer satisfaction.</p>
</div>
</div>
</section>
<section id="financial-performance-analysis" class="level3">
<h3 class="anchored" data-anchor-id="financial-performance-analysis">8.4 Financial Performance Analysis</h3>
<p>Financial data analysis is key to assessing business health. Use Pandas to analyze revenue, cost, and profit data over time.</p>
<div id="62a99f42" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1"></a><span class="co"># Sample financial data for a business over several months</span></span>
<span id="cb75-2"><a href="#cb75-2"></a>financial_data <span class="op">=</span> {</span>
<span id="cb75-3"><a href="#cb75-3"></a>  <span class="st">'Month'</span>: [<span class="st">'Jan'</span>, <span class="st">'Feb'</span>, <span class="st">'Mar'</span>, <span class="st">'Apr'</span>, <span class="st">'May'</span>, <span class="st">'Jun'</span>],</span>
<span id="cb75-4"><a href="#cb75-4"></a>  <span class="st">'Revenue'</span>: [<span class="dv">10000</span>, <span class="dv">12000</span>, <span class="dv">9000</span>, <span class="dv">15000</span>, <span class="dv">13000</span>, <span class="dv">14000</span>],</span>
<span id="cb75-5"><a href="#cb75-5"></a>  <span class="st">'Cost'</span>: [<span class="dv">7000</span>, <span class="dv">8000</span>, <span class="dv">6000</span>, <span class="dv">9000</span>, <span class="dv">7500</span>, <span class="dv">8500</span>]</span>
<span id="cb75-6"><a href="#cb75-6"></a>}</span>
<span id="cb75-7"><a href="#cb75-7"></a>df_financial <span class="op">=</span> pd.DataFrame(financial_data)</span>
<span id="cb75-8"><a href="#cb75-8"></a></span>
<span id="cb75-9"><a href="#cb75-9"></a><span class="co"># Calculate Profit and Profit Margin</span></span>
<span id="cb75-10"><a href="#cb75-10"></a>df_financial[<span class="st">'Profit'</span>] <span class="op">=</span> df_financial[<span class="st">'Revenue'</span>] <span class="op">-</span> df_financial[<span class="st">'Cost'</span>]</span>
<span id="cb75-11"><a href="#cb75-11"></a>df_financial[<span class="st">'Profit Margin'</span>] <span class="op">=</span> (df_financial[<span class="st">'Profit'</span>] <span class="op">/</span> df_financial[<span class="st">'Revenue'</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb75-12"><a href="#cb75-12"></a><span class="bu">print</span>(<span class="st">"Financial Performance Data:"</span>)</span>
<span id="cb75-13"><a href="#cb75-13"></a><span class="bu">print</span>(df_financial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Financial Performance Data:
  Month  Revenue  Cost  Profit  Profit Margin
0   Jan    10000  7000    3000      30.000000
1   Feb    12000  8000    4000      33.333333
2   Mar     9000  6000    3000      33.333333
3   Apr    15000  9000    6000      40.000000
4   May    13000  7500    5500      42.307692
5   Jun    14000  8500    5500      39.285714</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Pivoting Financial Data:</strong><br>
You can also pivot data if you have additional dimensions, such as region or product line, to summarize financial performance.</p>
</blockquote>
<div class="callout callout-style-simple callout-tip callout-titled" title="Business Insight:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Business Insight:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Analyzing financial performance helps in budgeting, forecasting, and strategic planning. Tracking profit margins and costs over time enables data-driven decision making.</p>
</div>
</div>
<hr>
</section>
</section>
<section id="conclusion-and-next-steps" class="level2">
<h2 class="anchored" data-anchor-id="conclusion-and-next-steps">9. Conclusion and Next Steps</h2>
<p>In today’s lecture, we learned how to: - <strong>Create and manipulate Pandas Series and DataFrames</strong> to store and analyze tabular data. - <strong>Access and filter data</strong> using intuitive indexing and boolean operations. - <strong>Clean and transform data</strong> to prepare it for meaningful analysis. - <strong>Aggregate, merge, and pivot data</strong> to generate actionable business insights. - <strong>Persist your data</strong> by saving to and loading from CSV and Excel files. - Explore <strong>real-world applications</strong> including Sales Performance, Customer Segmentation, Inventory Management, and Financial Performance Analysis.</p>
<div class="callout callout-style-simple callout-note callout-titled" title="Final Thought:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Final Thought:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Mastering Pandas is a critical step in becoming a proficient business analyst. The ability to clean, transform, and analyze data empowers you to make informed, data-driven decisions.</p>
</div>
</div>
<p><strong>Next Steps:</strong> - <strong>Review these notes carefully.</strong> - <strong>Experiment with your own datasets:</strong> Try loading data from a CSV file and applying these techniques. - <strong>Practice:</strong> Complete the exercises provided on Canvas, and bring any questions to our next session or office hours.</p>
<p>Happy coding, and enjoy exploring the power of Pandas!</p>
<hr>
<p><em>Dr.&nbsp;Tim C. Smith ©️2025</em></p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>