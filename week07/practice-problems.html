<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>week6-problem-set</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="week6-problem-set_files/libs/clipboard/clipboard.min.js"></script>
<script src="week6-problem-set_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="week6-problem-set_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="week6-problem-set_files/libs/quarto-html/popper.min.js"></script>
<script src="week6-problem-set_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="week6-problem-set_files/libs/quarto-html/anchor.min.js"></script>
<link href="week6-problem-set_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="week6-problem-set_files/libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="week6-problem-set_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="week6-problem-set_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="week6-problem-set_files/libs/bootstrap/bootstrap-bc29b7a494c55474c6a8d56f75b3cb06.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<hr>
<p>title: “Week 6: Pandas Practice Problem Set” subtitle: “Practice Problems for DataFrames, Data Manipulation, and More” author: “Dr.&nbsp;Smith” institute: “University of South Florida” date-format: long execute: echo: true warning: false format: html:</p>
<pre><code>page-layout: full
grid:
  body-width: 1400px
  sidebar-width: 250px
  margin-width: 0px
  gutter-width: 1.5rem
toc: true
toc-location: left
toc-depth: 2
number-sections: false
highlight-style: github
code-fold: false
code-tools: false
code-block-bg: "#f5f5f5"
code-block-border-left: "#31BAE9"
code-block-line-numbers: false
code-overflow: scroll
code-link: false
theme:
  light: flatly
  dark: darkly
callout-appearance: simple

code-line-numbers: true</code></pre>
<hr>
<style>
/* Canvas iframe optimization */
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  font-size: 16px;
  line-height: 1.5;
  color: #212529;
}

/* When NOT in iframe - force 1400px width */
@media screen {
  body:not(.in-iframe) .content {
    max-width: 1400px !important;
    width: 1400px !important;
    margin: 0 auto;
  }
  
  body:not(.in-iframe) #quarto-content {
    max-width: 1400px !important;
  }
  
  body:not(.in-iframe) .page-layout-full {
    max-width: 1400px !important;
  }
}

/* When IN iframe - responsive width */
@media screen {
  body.in-iframe {
    margin: 0;
    padding: 15px;
    max-width: 100%;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
    font-size: 16px;
    line-height: 1.5;
    color: #212529;
  }
  .in-iframe .quarto-container {
    max-width: 100%;
    padding: 0 15px;
  }
  .in-iframe #quarto-content {
    max-width: 100%;
  }
  .in-iframe .page-layout-article {
    grid-template-columns: minmax(0, 1fr);
  }
  .in-iframe .page-layout-full {
    grid-template-columns: minmax(0, 1fr);
  }
  .in-iframe .sidebar {
    width: 200px !important;
    font-size: 0.9em;
  }
  .in-iframe .sidebar.toc-left {
    width: 200px !important;
    margin-right: 15px;
  }
  .in-iframe .column-body {
    grid-column: 1;
    max-width: 100%;
  }
  .in-iframe #quarto-document-content {
    max-width: calc(100% - 220px);
    padding: 0 15px;
  }
  .in-iframe pre {
    overflow-x: auto;
    max-width: 100%;
    font-size: 0.9em;
  }
  .in-iframe code {
    font-size: 0.9em;
  }
  .in-iframe table {
    display: block;
    overflow-x: auto;
    max-width: 100%;
    font-size: 0.9em;
  }
  .in-iframe img {
    max-width: 100%;
    height: auto;
  }
  .in-iframe .callout {
    margin: 1em 0;
    padding: 0.5em 1em;
  }
  .in-iframe .sourceCode {
    max-width: 100%;
    overflow-x: auto;
  }
  .in-iframe .cell {
    max-width: 100%;
  }
  .in-iframe body {
    font-size: 15px;
  }
  .in-iframe h1 {
    font-size: 1.8em;
  }
  .in-iframe h2 {
    font-size: 1.5em;
  }
  .in-iframe h3 {
    font-size: 1.3em;
  }
  .in-iframe h4 {
    font-size: 1.1em;
  }
  .in-iframe #quarto-margin-sidebar {
    display: none !important;
  }
  .in-iframe .margin-sidebar {
    display: none !important;
  }
  
  /* Ensure proper paragraph spacing */
  .in-iframe p {
    margin-bottom: 1rem;
  }
  
  /* Maintain list styling */
  .in-iframe ul, .in-iframe ol {
    margin-bottom: 1rem;
  }
}

@media screen and (max-width: 768px) {
  .in-iframe .sidebar {
    display: none !important;
  }
  .in-iframe #quarto-document-content {
    max-width: 100%;
  }
  .in-iframe body {
    font-size: 14px;
  }
}
</style>
<script>
if (window.self !== window.top) {
  document.addEventListener("DOMContentLoaded", function() {
    document.body.classList.add("in-iframe");
  });
}
</script>
<section id="week-6-pandas-practice-problem-set" class="level1">
<h1>Week 6: Pandas Practice Problem Set</h1>
<p>Welcome to the Week 6 practice problem set. This set contains 25 questions designed to reinforce your understanding of Pandas topics including Series, DataFrames, indexing, filtering, data cleaning, transformation, grouping, merging, pivot tables, and data persistence. Try to work through each problem on your own. Detailed sample solutions with explanations are provided at the end of this file.</p>
<hr>
<section id="questions" class="level2">
<h2 class="anchored" data-anchor-id="questions">Questions</h2>
<ol type="1">
<li><p><strong>Creating a Series:</strong><br>
Create a Pandas Series from the list <code>[10, 20, 30, 40, 50]</code> and print it.</p></li>
<li><p><strong>Custom Indices in Series:</strong><br>
Create a Pandas Series from the list <code>[100, 200, 300, 400]</code> with custom indices <code>['Q1', 'Q2', 'Q3', 'Q4']</code>.</p></li>
<li><p><strong>Creating a DataFrame from a Dictionary:</strong><br>
Create a DataFrame with the following data:</p>
<ul>
<li>Products: <code>['Tablet', 'Smartphone', 'Laptop']</code><br>
</li>
<li>Prices: <code>[299.99, 499.99, 999.99]</code><br>
</li>
<li>Stock: <code>[100, 150, 50]</code></li>
</ul></li>
<li><p><strong>Creating a DataFrame from a List of Dictionaries:</strong><br>
Create a DataFrame using a list of dictionaries where each dictionary represents a product with keys <code>"Product"</code>, <code>"Price"</code>, and <code>"Stock"</code>.</p></li>
<li><p><strong>Selecting a Column:</strong><br>
Given the DataFrame from question 3, select and print the <code>"Price"</code> column.</p></li>
<li><p><strong>Selecting a Row with .loc and .iloc:</strong><br>
Using the DataFrame from question 3, print the first row using both <code>.loc</code> and <code>.iloc</code>.</p></li>
<li><p><strong>Filtering Numeric Data:</strong><br>
Filter the DataFrame from question 3 to show only the products with a Price greater than 300.</p></li>
<li><p><strong>Filtering with String Methods:</strong><br>
Filter the DataFrame from question 3 to show products whose names contain the letter “a” (case-insensitive).</p></li>
<li><p><strong>Identifying Missing Values:</strong><br>
Create a DataFrame with missing values using:</p>
<ul>
<li><code>"Product": ['TV', 'Radio', 'Speaker']</code><br>
</li>
<li><code>"Price": [499.99, None, 199.99]</code><br>
</li>
<li><code>"Stock": [20, 30, None]</code><br>
Print the DataFrame and identify the missing values.</li>
</ul></li>
<li><p><strong>Filling Missing Values:</strong><br>
For the DataFrame in question 9, fill missing <code>"Price"</code> values with the mean price and <code>"Stock"</code> values with 0.</p></li>
<li><p><strong>Dropping Missing Values:</strong><br>
For the DataFrame in question 9, drop any rows that contain missing values.</p></li>
<li><p><strong>Adding a Calculated Column:</strong><br>
For the DataFrame from question 3, add a new column <code>"Total Value"</code> calculated as <code>Price * Stock</code>.</p></li>
<li><p><strong>Applying a Discount:</strong><br>
For the DataFrame from question 3, create a new column <code>"Discounted Price"</code> that applies a 10% discount to the <code>"Price"</code>.</p></li>
<li><p><strong>Renaming Columns:</strong><br>
Rename the columns of the DataFrame from question 3 to <code>['Item', 'Unit Price', 'Inventory']</code>.</p></li>
<li><p><strong>Data Type Conversion:</strong><br>
Convert the <code>"Price"</code> column of the DataFrame from question 3 to integer values (rounding if necessary) and print the result.</p></li>
<li><p><strong>Grouping and Summing:</strong><br>
Create a DataFrame with sales data:</p>
<ul>
<li><code>"Region": ['North', 'South', 'East', 'North', 'South']</code></li>
<li><code>"Sales": [300, 400, 500, 200, 300]</code><br>
Group by <code>"Region"</code> and compute the total sales for each region.</li>
</ul></li>
<li><p><strong>Multiple Aggregations:</strong><br>
Using the same sales data from question 16, group by <code>"Region"</code> and compute both the sum and the mean of sales.</p></li>
<li><p><strong>Merging DataFrames:</strong><br>
Create two DataFrames: one with customer data and one with order data.</p>
<ul>
<li>Customer DataFrame:<br>
<code>"CustomerID": [1, 2, 3]</code>, <code>"Name": ['Alice', 'Bob', 'Charlie']</code></li>
<li>Order DataFrame:<br>
<code>"CustomerID": [1, 2, 1]</code>, <code>"OrderID": [101, 102, 103]</code>, <code>"Amount": [250, 150, 300]</code><br>
Merge these DataFrames on <code>"CustomerID"</code>.</li>
</ul></li>
<li><p><strong>Left Join Merge:</strong><br>
Using the DataFrames from question 18, perform a left join to include all customers, even those without orders.</p></li>
<li><p><strong>Creating a Pivot Table:</strong><br>
Create a pivot table from the sales data in question 16 that summarizes total sales by region.</p></li>
<li><p><strong>Saving to CSV:</strong><br>
Save the DataFrame from question 3 (or a similar DataFrame) to a CSV file named <code>"products.csv"</code>.</p></li>
<li><p><strong>Saving to Excel:</strong><br>
Save the same DataFrame from question 3 to an Excel file named <code>"products.xlsx"</code> with the sheet name <code>"Products"</code>.</p></li>
<li><p><strong>Loading from CSV:</strong><br>
Load the CSV file <code>"products.csv"</code> into a DataFrame and print it.</p></li>
<li><p><strong>Loading from Excel:</strong><br>
Load the Excel file <code>"products.xlsx"</code> (sheet <code>"Products"</code>) into a DataFrame and print it.</p></li>
<li><p><strong>Multi-step Data Transformation:</strong><br>
Given the following DataFrame:</p>
<div id="c4e9f89f" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Product'</span>: [<span class="st">'Monitor'</span>, <span class="st">'Keyboard'</span>, <span class="st">'Mouse'</span>, <span class="st">'Speaker'</span>, <span class="st">'Webcam'</span>],</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Price'</span>: [<span class="fl">199.99</span>, <span class="va">None</span>, <span class="fl">29.99</span>, <span class="fl">99.99</span>, <span class="va">None</span>],</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Stock'</span>: [<span class="dv">75</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="va">None</span>, <span class="dv">80</span>]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>df_multi <span class="op">=</span> pd.DataFrame(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Perform these steps:</p>
<ul>
<li>Fill missing <code>"Price"</code> values with the mean price.</li>
<li>Fill missing <code>"Stock"</code> values with 0.</li>
<li>Add a new column <code>"Total Value"</code> calculated as <code>Price * Stock</code>.</li>
<li>Filter the DataFrame to show only products with a <code>"Total Value"</code> greater than 5000.</li>
<li>Group the resulting DataFrame by <code>"Product"</code> and display the sum of <code>"Total Value"</code>.</li>
</ul></li>
</ol>
<hr>
</section>
</section>
<section id="sample-solutions" class="level1">
<h1>Sample Solutions</h1>
<p>Below are the sample solutions with step-by-step explanations for each problem.</p>
<section id="creating-a-series" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-series">1. Creating a Series</h2>
<div id="4ced5fcd" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Series from a list</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>series_1 <span class="op">=</span> pd.Series([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>])</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(series_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0    10
1    20
2    30
3    40
4    50
dtype: int64</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
We import Pandas and use <code>pd.Series()</code> to create a Series from a list. The output is a one-dimensional array with automatically assigned indices starting at 0.</p>
<hr>
</section>
<section id="custom-indices-in-series" class="level2">
<h2 class="anchored" data-anchor-id="custom-indices-in-series">2. Custom Indices in Series</h2>
<div id="9c59c5e0" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Series with custom indices</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>series_custom <span class="op">=</span> pd.Series([<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>], index<span class="op">=</span>[<span class="st">'Q1'</span>, <span class="st">'Q2'</span>, <span class="st">'Q3'</span>, <span class="st">'Q4'</span>])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(series_custom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Q1    100
Q2    200
Q3    300
Q4    400
dtype: int64</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
By passing the <code>index</code> parameter, we assign custom labels (<code>Q1</code>, <code>Q2</code>, etc.) to each element in the Series.</p>
<hr>
</section>
<section id="creating-a-dataframe-from-a-dictionary" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-dataframe-from-a-dictionary">3. Creating a DataFrame from a Dictionary</h2>
<div id="10d814bc" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data_dict <span class="op">=</span> {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Product'</span>: [<span class="st">'Tablet'</span>, <span class="st">'Smartphone'</span>, <span class="st">'Laptop'</span>],</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Price'</span>: [<span class="fl">299.99</span>, <span class="fl">499.99</span>, <span class="fl">999.99</span>],</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Stock'</span>: [<span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">50</span>]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame(data_dict)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Product   Price  Stock
0      Tablet  299.99    100
1  Smartphone  499.99    150
2      Laptop  999.99     50</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
A dictionary with keys as column names and values as lists is passed to <code>pd.DataFrame()</code> to create a structured table.</p>
<hr>
</section>
<section id="creating-a-dataframe-from-a-list-of-dictionaries" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-dataframe-from-a-list-of-dictionaries">4. Creating a DataFrame from a List of Dictionaries</h2>
<div id="d1649ca3" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data_list <span class="op">=</span> [</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Product'</span>: <span class="st">'Tablet'</span>, <span class="st">'Price'</span>: <span class="fl">299.99</span>, <span class="st">'Stock'</span>: <span class="dv">100</span>},</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Product'</span>: <span class="st">'Smartphone'</span>, <span class="st">'Price'</span>: <span class="fl">499.99</span>, <span class="st">'Stock'</span>: <span class="dv">150</span>},</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Product'</span>: <span class="st">'Laptop'</span>, <span class="st">'Price'</span>: <span class="fl">999.99</span>, <span class="st">'Stock'</span>: <span class="dv">50</span>}</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame(data_list)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Product   Price  Stock
0      Tablet  299.99    100
1  Smartphone  499.99    150
2      Laptop  999.99     50</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
Each dictionary in the list represents a row. Pandas automatically constructs the DataFrame with appropriate columns.</p>
<hr>
</section>
<section id="selecting-a-column" class="level2">
<h2 class="anchored" data-anchor-id="selecting-a-column">5. Selecting a Column</h2>
<div id="066193e5" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using df1 from Problem 3</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>prices_col <span class="op">=</span> df1[<span class="st">'Price'</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(prices_col)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0    299.99
1    499.99
2    999.99
Name: Price, dtype: float64</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
Using square brackets and the column name, we extract the <code>"Price"</code> column as a Series.</p>
<hr>
</section>
<section id="selecting-a-row-with-.loc-and-.iloc" class="level2">
<h2 class="anchored" data-anchor-id="selecting-a-row-with-.loc-and-.iloc">6. Selecting a Row with .loc and .iloc</h2>
<div id="80c7f410" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using df1 from Problem 3</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>row_loc <span class="op">=</span> df1.loc[<span class="dv">0</span>]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>row_iloc <span class="op">=</span> df1.iloc[<span class="dv">0</span>]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Row selected with .loc:</span><span class="ch">\n</span><span class="st">"</span>, row_loc)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Row selected with .iloc:</span><span class="ch">\n</span><span class="st">"</span>, row_iloc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Row selected with .loc:
 Product    Tablet
Price      299.99
Stock         100
Name: 0, dtype: object
Row selected with .iloc:
 Product    Tablet
Price      299.99
Stock         100
Name: 0, dtype: object</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
<code>.loc</code> selects rows based on label while <code>.iloc</code> uses integer positions. Here, both return the first row since our default index starts at 0.</p>
<hr>
</section>
<section id="filtering-numeric-data" class="level2">
<h2 class="anchored" data-anchor-id="filtering-numeric-data">7. Filtering Numeric Data</h2>
<div id="764f0156" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter products with Price &gt; 300 in df1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>expensive_products <span class="op">=</span> df1[df1[<span class="st">'Price'</span>] <span class="op">&gt;</span> <span class="dv">300</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(expensive_products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Product   Price  Stock
1  Smartphone  499.99    150
2      Laptop  999.99     50</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
The condition <code>df1['Price'] &gt; 300</code> returns a boolean Series. We then use it to filter rows where the condition is True.</p>
<hr>
</section>
<section id="filtering-with-string-methods" class="level2">
<h2 class="anchored" data-anchor-id="filtering-with-string-methods">8. Filtering with String Methods</h2>
<div id="e1143376" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter products with names containing the letter 'a' (case-insensitive)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>products_with_a <span class="op">=</span> df1[df1[<span class="st">'Product'</span>].<span class="bu">str</span>.contains(<span class="st">"a"</span>, case<span class="op">=</span><span class="va">False</span>)]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(products_with_a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Product   Price  Stock
0      Tablet  299.99    100
1  Smartphone  499.99    150
2      Laptop  999.99     50</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
Using <code>.str.contains()</code>, we filter the <code>"Product"</code> column for entries containing “a”. The <code>case=False</code> parameter ensures case-insensitive matching.</p>
<hr>
</section>
<section id="identifying-missing-values" class="level2">
<h2 class="anchored" data-anchor-id="identifying-missing-values">9. Identifying Missing Values</h2>
<div id="9d65a5ed" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data_nan <span class="op">=</span> {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Product'</span>: [<span class="st">'TV'</span>, <span class="st">'Radio'</span>, <span class="st">'Speaker'</span>],</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Price'</span>: [<span class="fl">499.99</span>, <span class="va">None</span>, <span class="fl">199.99</span>],</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Stock'</span>: [<span class="dv">20</span>, <span class="dv">30</span>, <span class="va">None</span>]</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>df_nan <span class="op">=</span> pd.DataFrame(data_nan)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_nan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Product   Price  Stock
0       TV  499.99   20.0
1    Radio     NaN   30.0
2  Speaker  199.99    NaN</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
This DataFrame contains <code>None</code> values which are interpreted as missing data. The printed output will show <code>NaN</code> in place of missing values.</p>
<hr>
</section>
<section id="filling-missing-values" class="level2">
<h2 class="anchored" data-anchor-id="filling-missing-values">10. Filling Missing Values</h2>
<div id="090d14d8" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill missing Price with mean and Stock with 0 in df_nan</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df_nan[<span class="st">'Price'</span>].fillna(df_nan[<span class="st">'Price'</span>].mean(), inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>df_nan[<span class="st">'Stock'</span>].fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_nan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Product   Price  Stock
0       TV  499.99   20.0
1    Radio  349.99   30.0
2  Speaker  199.99    0.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_806932/1398187088.py:2: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  df_nan['Price'].fillna(df_nan['Price'].mean(), inplace=True)
/tmp/ipykernel_806932/1398187088.py:3: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  df_nan['Stock'].fillna(0, inplace=True)</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
We use <code>.fillna()</code> to replace missing values. For <code>"Price"</code>, we use the mean of the column; for <code>"Stock"</code>, we fill with 0.</p>
<hr>
</section>
<section id="dropping-missing-values" class="level2">
<h2 class="anchored" data-anchor-id="dropping-missing-values">11. Dropping Missing Values</h2>
<div id="b736852d" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with any missing values from the original df_nan</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>df_drop <span class="op">=</span> df_nan.dropna()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_drop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Product   Price  Stock
0       TV  499.99   20.0
1    Radio  349.99   30.0
2  Speaker  199.99    0.0</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
<code>.dropna()</code> removes rows containing any missing values, giving a DataFrame with complete data.</p>
<hr>
</section>
<section id="adding-a-calculated-column" class="level2">
<h2 class="anchored" data-anchor-id="adding-a-calculated-column">12. Adding a Calculated Column</h2>
<div id="11da11c5" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using df1 from Problem 3: add 'Total Value' as Price * Stock</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'Total Value'</span>] <span class="op">=</span> df1[<span class="st">'Price'</span>] <span class="op">*</span> df1[<span class="st">'Stock'</span>]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Product   Price  Stock  Total Value
0      Tablet  299.99    100      29999.0
1  Smartphone  499.99    150      74998.5
2      Laptop  999.99     50      49999.5</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
A new column is created by performing element-wise multiplication of the <code>"Price"</code> and <code>"Stock"</code> columns.</p>
<hr>
</section>
<section id="applying-a-discount" class="level2">
<h2 class="anchored" data-anchor-id="applying-a-discount">13. Applying a Discount</h2>
<div id="c120c69f" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add 'Discounted Price' as 10% off Price in df1</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'Discounted Price'</span>] <span class="op">=</span> df1[<span class="st">'Price'</span>] <span class="op">*</span> <span class="fl">0.90</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Product   Price  Stock  Total Value  Discounted Price
0      Tablet  299.99    100      29999.0           269.991
1  Smartphone  499.99    150      74998.5           449.991
2      Laptop  999.99     50      49999.5           899.991</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
The new column applies a 10% discount (multiplies Price by 0.90) to each product.</p>
<hr>
</section>
<section id="renaming-columns" class="level2">
<h2 class="anchored" data-anchor-id="renaming-columns">14. Renaming Columns</h2>
<div id="b2917282" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns in df1</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df1.rename(columns<span class="op">=</span>{<span class="st">'Product'</span>: <span class="st">'Item'</span>, <span class="st">'Price'</span>: <span class="st">'Unit Price'</span>, <span class="st">'Stock'</span>: <span class="st">'Inventory'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Item  Unit Price  Inventory  Total Value  Discounted Price
0      Tablet      299.99        100      29999.0           269.991
1  Smartphone      499.99        150      74998.5           449.991
2      Laptop      999.99         50      49999.5           899.991</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
Using <code>.rename()</code>, we update the column names for clarity.</p>
<hr>
</section>
<section id="data-type-conversion" class="level2">
<h2 class="anchored" data-anchor-id="data-type-conversion">15. Data Type Conversion</h2>
<div id="ae319d94" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Unit Price' in df1 to integer (rounding down)</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'Price_Int'</span>] <span class="op">=</span> df1[<span class="st">'Unit Price'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Item  Unit Price  Inventory  Total Value  Discounted Price  Price_Int
0      Tablet      299.99        100      29999.0           269.991        299
1  Smartphone      499.99        150      74998.5           449.991        499
2      Laptop      999.99         50      49999.5           899.991        999</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
<code>.astype(int)</code> converts the column to integer type, which truncates the decimal portion.</p>
<hr>
</section>
<section id="grouping-and-summing" class="level2">
<h2 class="anchored" data-anchor-id="grouping-and-summing">16. Grouping and Summing</h2>
<div id="822020c0" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>sales_data <span class="op">=</span> {</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Region'</span>: [<span class="st">'North'</span>, <span class="st">'South'</span>, <span class="st">'East'</span>, <span class="st">'North'</span>, <span class="st">'South'</span>],</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sales'</span>: [<span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">500</span>, <span class="dv">200</span>, <span class="dv">300</span>]</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>df_sales <span class="op">=</span> pd.DataFrame(sales_data)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> df_sales.groupby(<span class="st">'Region'</span>).<span class="bu">sum</span>()</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(grouped)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Sales
Region       
East      500
North     500
South     700</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
Grouping by <code>"Region"</code> and using <code>.sum()</code> computes total sales for each region.</p>
<hr>
</section>
<section id="multiple-aggregations" class="level2">
<h2 class="anchored" data-anchor-id="multiple-aggregations">17. Multiple Aggregations</h2>
<div id="5e562ed3" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>aggregated <span class="op">=</span> df_sales.groupby(<span class="st">'Region'</span>).agg({<span class="st">'Sales'</span>: [<span class="st">'sum'</span>, <span class="st">'mean'</span>]})</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aggregated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Sales       
         sum   mean
Region             
East     500  500.0
North    500  250.0
South    700  350.0</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
The <code>.agg()</code> function allows multiple aggregation functions (here, sum and mean) on the grouped data.</p>
<hr>
</section>
<section id="merging-dataframes" class="level2">
<h2 class="anchored" data-anchor-id="merging-dataframes">18. Merging DataFrames</h2>
<div id="1cce7a1e" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df_customers <span class="op">=</span> pd.DataFrame({</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CustomerID'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Name'</span>: [<span class="st">'Alice'</span>, <span class="st">'Bob'</span>, <span class="st">'Charlie'</span>]</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>df_orders <span class="op">=</span> pd.DataFrame({</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CustomerID'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>],</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'OrderID'</span>: [<span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">103</span>],</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Amount'</span>: [<span class="dv">250</span>, <span class="dv">150</span>, <span class="dv">300</span>]</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> pd.merge(df_customers, df_orders, on<span class="op">=</span><span class="st">'CustomerID'</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(merged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   CustomerID   Name  OrderID  Amount
0           1  Alice      101     250
1           1  Alice      103     300
2           2    Bob      102     150</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
Using <code>pd.merge()</code>, we join the customer and order DataFrames on the <code>"CustomerID"</code> key.</p>
<hr>
</section>
<section id="left-join-merge" class="level2">
<h2 class="anchored" data-anchor-id="left-join-merge">19. Left Join Merge</h2>
<div id="870e0dca" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>left_join <span class="op">=</span> pd.merge(df_customers, df_orders, on<span class="op">=</span><span class="st">'CustomerID'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(left_join)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   CustomerID     Name  OrderID  Amount
0           1    Alice    101.0   250.0
1           1    Alice    103.0   300.0
2           2      Bob    102.0   150.0
3           3  Charlie      NaN     NaN</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
A left join keeps all rows from <code>df_customers</code> while merging matching rows from <code>df_orders</code>.</p>
<hr>
</section>
<section id="creating-a-pivot-table" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-pivot-table">20. Creating a Pivot Table</h2>
<div id="9f043399" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pivot <span class="op">=</span> pd.pivot_table(df_sales, values<span class="op">=</span><span class="st">'Sales'</span>, index<span class="op">=</span><span class="st">'Region'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pivot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Sales
Region       
East      500
North     500
South     700</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
<code>pd.pivot_table()</code> summarizes the data by computing total sales for each region.</p>
<hr>
</section>
<section id="saving-to-csv" class="level2">
<h2 class="anchored" data-anchor-id="saving-to-csv">21. Saving to CSV</h2>
<div id="af6b89fd" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df1.to_csv(<span class="st">"products.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Saved to products.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Saved to products.csv</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
The DataFrame is written to a CSV file without including the index column.</p>
<hr>
</section>
<section id="saving-to-excel" class="level2">
<h2 class="anchored" data-anchor-id="saving-to-excel">22. Saving to Excel</h2>
<div id="c68f8392" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>df1.to_excel(<span class="st">"products.xlsx"</span>, index<span class="op">=</span><span class="va">False</span>, sheet_name<span class="op">=</span><span class="st">"Products"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Saved to products.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Saved to products.xlsx</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
The DataFrame is saved as an Excel file with a specified sheet name. (Requires the <code>openpyxl</code> library.)</p>
<hr>
</section>
<section id="loading-from-csv" class="level2">
<h2 class="anchored" data-anchor-id="loading-from-csv">23. Loading from CSV</h2>
<div id="4f146901" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>df_from_csv <span class="op">=</span> pd.read_csv(<span class="st">"products.csv"</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_from_csv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Item  Unit Price  Inventory  Total Value  Discounted Price  Price_Int
0      Tablet      299.99        100      29999.0           269.991        299
1  Smartphone      499.99        150      74998.5           449.991        499
2      Laptop      999.99         50      49999.5           899.991        999</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
Using <code>pd.read_csv()</code>, we load the CSV file back into a DataFrame.</p>
<hr>
</section>
<section id="loading-from-excel" class="level2">
<h2 class="anchored" data-anchor-id="loading-from-excel">24. Loading from Excel</h2>
<div id="9b723a81" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df_from_excel <span class="op">=</span> pd.read_excel(<span class="st">"products.xlsx"</span>, sheet_name<span class="op">=</span><span class="st">"Products"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_from_excel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Item  Unit Price  Inventory  Total Value  Discounted Price  Price_Int
0      Tablet      299.99        100      29999.0           269.991        299
1  Smartphone      499.99        150      74998.5           449.991        499
2      Laptop      999.99         50      49999.5           899.991        999</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
Using <code>pd.read_excel()</code>, we load the Excel file and specify the sheet to load.</p>
<hr>
</section>
<section id="multi-step-data-transformation" class="level2">
<h2 class="anchored" data-anchor-id="multi-step-data-transformation">25. Multi-step Data Transformation</h2>
<div id="902dd263" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the DataFrame</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>data_multi <span class="op">=</span> {</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Product'</span>: [<span class="st">'Monitor'</span>, <span class="st">'Keyboard'</span>, <span class="st">'Mouse'</span>, <span class="st">'Speaker'</span>, <span class="st">'Webcam'</span>],</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Price'</span>: [<span class="fl">199.99</span>, <span class="va">None</span>, <span class="fl">29.99</span>, <span class="fl">99.99</span>, <span class="va">None</span>],</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Stock'</span>: [<span class="dv">75</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="va">None</span>, <span class="dv">80</span>]</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>df_multi <span class="op">=</span> pd.DataFrame(data_multi)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Fill missing values</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>df_multi[<span class="st">'Price'</span>].fillna(df_multi[<span class="st">'Price'</span>].mean(), inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>df_multi[<span class="st">'Stock'</span>].fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Add "Total Value" column</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>df_multi[<span class="st">'Total Value'</span>] <span class="op">=</span> df_multi[<span class="st">'Price'</span>] <span class="op">*</span> df_multi[<span class="st">'Stock'</span>]</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Filter rows with "Total Value" &gt; 5000</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>df_filtered <span class="op">=</span> df_multi[df_multi[<span class="st">'Total Value'</span>] <span class="op">&gt;</span> <span class="dv">5000</span>]</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Group by "Product" and sum "Total Value"</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> df_filtered.groupby(<span class="st">'Product'</span>).agg({<span class="st">'Total Value'</span>: <span class="st">'sum'</span>}).reset_index()</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Product  Total Value
0  Keyboard     10999.00
1   Monitor     14999.25
2    Webcam      8799.20</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_806932/2410459172.py:10: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  df_multi['Price'].fillna(df_multi['Price'].mean(), inplace=True)
/tmp/ipykernel_806932/2410459172.py:11: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  df_multi['Stock'].fillna(0, inplace=True)</code></pre>
</div>
</div>
<p><strong>Explanation:</strong><br>
- <strong>Step 1:</strong> Missing <code>"Price"</code> values are filled with the mean price, and missing <code>"Stock"</code> values with 0.<br>
- <strong>Step 2:</strong> A new column <code>"Total Value"</code> is calculated.<br>
- <strong>Step 3:</strong> Rows where <code>"Total Value"</code> exceeds 5000 are filtered.<br>
- <strong>Step 4:</strong> The resulting DataFrame is grouped by <code>"Product"</code>, summing up the <code>"Total Value"</code> for each product.</p>
<hr>
</section>
</section>
<section id="end-of-practice-problem-set" class="level1">
<h1>End of Practice Problem Set</h1>
<p>Make sure to attempt each question on your own before reviewing these sample solutions. If you have any questions, please bring them to our next session or office hours.</p>
<p>Happy coding!</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>