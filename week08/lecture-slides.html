<!DOCTYPE html>
<html lang="en"><head>
<script src="Week08-lecture-slides_files/libs/clipboard/clipboard.min.js"></script>
<script src="Week08-lecture-slides_files/libs/quarto-html/tabby.min.js"></script>
<script src="Week08-lecture-slides_files/libs/quarto-html/popper.min.js"></script>
<script src="Week08-lecture-slides_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Week08-lecture-slides_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Week08-lecture-slides_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Week08-lecture-slides_files/libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.31">

  <meta name="author" content="Dr.&nbsp;Tim Smith">
  <meta name="dcterms.date" content="2025-03-22">
  <title>ISM4641: Python for Business Analytics</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Week08-lecture-slides_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Week08-lecture-slides_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Week08-lecture-slides_files/libs/revealjs/dist/theme/quarto-f563837468303362081e247dddd440d0.css">
  <link rel="stylesheet" href="../reveal-scroll.css">
  <link href="Week08-lecture-slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Week08-lecture-slides_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Week08-lecture-slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Week08-lecture-slides_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="Week08-lecture-slides_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="Week08-lecture-slides_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<link rel="stylesheet" href="../css/reveal-scroll.css">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">ISM4641: Python for Business Analytics</h1>
  <p class="subtitle">Week 8: Data Visualization with Matplotlib</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Tim Smith 
</div>
</div>
</div>

  <p class="date">March 22, 2025</p>
</section>
<section>
<section id="welcome-to-week-8" class="title-slide slide level1 smaller center">
<h1>Welcome to Week 8!</h1>

</section>
<section id="the-power-of-data-visualization" class="slide level2">
<h2>The Power of Data Visualization</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="why-visualize">Why Visualize?</h3>
<ul>
<li><strong>Pattern Recognition</strong>: See trends instantly</li>
<li><strong>Communication</strong>: Pictures worth 1000 words</li>
<li><strong>Decision Making</strong>: Visual insights drive action</li>
<li><strong>Storytelling</strong>: Data tells compelling stories</li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="what-well-master">What We’ll Master</h3>
<ul>
<li><strong>Matplotlib fundamentals</strong></li>
<li><strong>Business-appropriate charts</strong></li>
<li><strong>Professional customization</strong></li>
<li><strong>Multi-plot dashboards</strong></li>
<li><strong>Integration with Pandas</strong></li>
</ul>
</div></div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>“The greatest value of a picture is when it forces us to notice what we never expected to see.” - John Tukey</p>
</div>
</div>
</div>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="part-1-matplotlib-fundamentals" class="title-slide slide level1 smaller center">
<h1>Part 1: Matplotlib Fundamentals</h1>

</section>
<section id="object-oriented-approach" class="slide level2">
<h2>Object-Oriented Approach</h2>
<div id="e9d83d38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href=""></a></span>
<span id="cb1-5"><a href=""></a><span class="co"># Set style for professional appearance</span></span>
<span id="cb1-6"><a href=""></a>plt.style.use(<span class="st">'default'</span>)</span>
<span id="cb1-7"><a href=""></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">6</span>)</span>
<span id="cb1-8"><a href=""></a>plt.rcParams[<span class="st">'font.size'</span>] <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb1-9"><a href=""></a></span>
<span id="cb1-10"><a href=""></a><span class="co"># Business sales data</span></span>
<span id="cb1-11"><a href=""></a>months <span class="op">=</span> [<span class="st">'Jan'</span>, <span class="st">'Feb'</span>, <span class="st">'Mar'</span>, <span class="st">'Apr'</span>, <span class="st">'May'</span>, <span class="st">'Jun'</span>]</span>
<span id="cb1-12"><a href=""></a>sales_2023 <span class="op">=</span> [<span class="dv">850000</span>, <span class="dv">920000</span>, <span class="dv">780000</span>, <span class="dv">880000</span>, <span class="dv">950000</span>, <span class="dv">1020000</span>]</span>
<span id="cb1-13"><a href=""></a>sales_2024 <span class="op">=</span> [<span class="dv">950000</span>, <span class="dv">1040000</span>, <span class="dv">890000</span>, <span class="dv">1020000</span>, <span class="dv">1150000</span>, <span class="dv">1240000</span>]</span>
<span id="cb1-14"><a href=""></a></span>
<span id="cb1-15"><a href=""></a><span class="bu">print</span>(<span class="st">"MATPLOTLIB FUNDAMENTALS"</span>)</span>
<span id="cb1-16"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">25</span>)</span>
<span id="cb1-17"><a href=""></a></span>
<span id="cb1-18"><a href=""></a><span class="co"># Object-oriented approach (recommended)</span></span>
<span id="cb1-19"><a href=""></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">7</span>))</span>
<span id="cb1-20"><a href=""></a></span>
<span id="cb1-21"><a href=""></a><span class="co"># Create line plots</span></span>
<span id="cb1-22"><a href=""></a>ax.plot(months, sales_2023, marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="fl">2.5</span>, label<span class="op">=</span><span class="st">'2023 Sales'</span>, color<span class="op">=</span><span class="st">'#1f77b4'</span>)</span>
<span id="cb1-23"><a href=""></a>ax.plot(months, sales_2024, marker<span class="op">=</span><span class="st">'s'</span>, linewidth<span class="op">=</span><span class="fl">2.5</span>, label<span class="op">=</span><span class="st">'2024 Sales'</span>, color<span class="op">=</span><span class="st">'#ff7f0e'</span>)</span>
<span id="cb1-24"><a href=""></a></span>
<span id="cb1-25"><a href=""></a><span class="co"># Customize the plot</span></span>
<span id="cb1-26"><a href=""></a>ax.set_title(<span class="st">'Monthly Sales Comparison: 2023 vs 2024'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb1-27"><a href=""></a>ax.set_xlabel(<span class="st">'Month'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb1-28"><a href=""></a>ax.set_ylabel(<span class="st">'Sales Revenue ($)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb1-29"><a href=""></a></span>
<span id="cb1-30"><a href=""></a><span class="co"># Format y-axis for currency</span></span>
<span id="cb1-31"><a href=""></a>ax.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M'</span>))</span>
<span id="cb1-32"><a href=""></a></span>
<span id="cb1-33"><a href=""></a><span class="co"># Add grid for readability</span></span>
<span id="cb1-34"><a href=""></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb1-35"><a href=""></a></span>
<span id="cb1-36"><a href=""></a><span class="co"># Add legend</span></span>
<span id="cb1-37"><a href=""></a>ax.legend(fontsize<span class="op">=</span><span class="dv">12</span>, loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb1-38"><a href=""></a></span>
<span id="cb1-39"><a href=""></a><span class="co"># Improve layout</span></span>
<span id="cb1-40"><a href=""></a>plt.tight_layout()</span>
<span id="cb1-41"><a href=""></a>plt.show()</span>
<span id="cb1-42"><a href=""></a></span>
<span id="cb1-43"><a href=""></a><span class="co"># Business insights from the data</span></span>
<span id="cb1-44"><a href=""></a>growth_rates <span class="op">=</span> [(s24 <span class="op">-</span> s23) <span class="op">/</span> s23 <span class="op">*</span> <span class="dv">100</span> <span class="cf">for</span> s23, s24 <span class="kw">in</span> <span class="bu">zip</span>(sales_2023, sales_2024)]</span>
<span id="cb1-45"><a href=""></a>avg_growth <span class="op">=</span> np.mean(growth_rates)</span>
<span id="cb1-46"><a href=""></a></span>
<span id="cb1-47"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Business Analysis:"</span>)</span>
<span id="cb1-48"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Average YoY Growth: </span><span class="sc">{</span>avg_growth<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb1-49"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Best Growth Month: </span><span class="sc">{</span>months[np.argmax(growth_rates)]<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span><span class="bu">max</span>(growth_rates)<span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb1-50"><a href=""></a><span class="bu">print</span>(<span class="ss">f"2024 Total: $</span><span class="sc">{</span><span class="bu">sum</span>(sales_2024)<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb1-51"><a href=""></a><span class="bu">print</span>(<span class="ss">f"2023 Total: $</span><span class="sc">{</span><span class="bu">sum</span>(sales_2023)<span class="sc">:,}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MATPLOTLIB FUNDAMENTALS
=========================</code></pre>
</div>

<div class="cell-output cell-output-stdout">
<pre><code>Business Analysis:
Average YoY Growth: 16.2%
Best Growth Month: Jun (21.6%)
2024 Total: $6,290,000
2023 Total: $5,400,000</code></pre>
</div>
</div>
<img data-src="Week08-lecture-slides_files/figure-revealjs/cell-2-output-2.png" class="r-stretch"></section>
<section id="figure-and-axes-concepts" class="slide level2 smaller">
<h2>Figure and Axes Concepts</h2>
<div id="6ada8042" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href=""></a><span class="co"># Understanding Figure and Axes hierarchy</span></span>
<span id="cb4-2"><a href=""></a><span class="bu">print</span>(<span class="st">"FIGURE AND AXES STRUCTURE"</span>)</span>
<span id="cb4-3"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">30</span>)</span>
<span id="cb4-4"><a href=""></a></span>
<span id="cb4-5"><a href=""></a><span class="co"># Create a comprehensive business dashboard</span></span>
<span id="cb4-6"><a href=""></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb4-7"><a href=""></a></span>
<span id="cb4-8"><a href=""></a><span class="co"># Define subplot grid (2x2)</span></span>
<span id="cb4-9"><a href=""></a>ax1 <span class="op">=</span> plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)  <span class="co"># Top-left</span></span>
<span id="cb4-10"><a href=""></a>ax2 <span class="op">=</span> plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)  <span class="co"># Top-right</span></span>
<span id="cb4-11"><a href=""></a>ax3 <span class="op">=</span> plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)  <span class="co"># Bottom-left</span></span>
<span id="cb4-12"><a href=""></a>ax4 <span class="op">=</span> plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>)  <span class="co"># Bottom-right</span></span>
<span id="cb4-13"><a href=""></a></span>
<span id="cb4-14"><a href=""></a><span class="co"># Sample business data</span></span>
<span id="cb4-15"><a href=""></a>departments <span class="op">=</span> [<span class="st">'Sales'</span>, <span class="st">'Marketing'</span>, <span class="st">'IT'</span>, <span class="st">'HR'</span>, <span class="st">'Finance'</span>]</span>
<span id="cb4-16"><a href=""></a>q1_performance <span class="op">=</span> [<span class="dv">92</span>, <span class="dv">87</span>, <span class="dv">94</span>, <span class="dv">89</span>, <span class="dv">91</span>]</span>
<span id="cb4-17"><a href=""></a>q2_performance <span class="op">=</span> [<span class="dv">88</span>, <span class="dv">91</span>, <span class="dv">96</span>, <span class="dv">92</span>, <span class="dv">89</span>]</span>
<span id="cb4-18"><a href=""></a></span>
<span id="cb4-19"><a href=""></a>regions <span class="op">=</span> [<span class="st">'North'</span>, <span class="st">'South'</span>, <span class="st">'East'</span>, <span class="st">'West'</span>]</span>
<span id="cb4-20"><a href=""></a>market_share <span class="op">=</span> [<span class="dv">28</span>, <span class="dv">22</span>, <span class="dv">35</span>, <span class="dv">15</span>]</span>
<span id="cb4-21"><a href=""></a></span>
<span id="cb4-22"><a href=""></a>customer_satisfaction <span class="op">=</span> [<span class="fl">4.2</span>, <span class="fl">4.5</span>, <span class="fl">3.8</span>, <span class="fl">4.7</span>, <span class="fl">4.1</span>, <span class="fl">4.6</span>, <span class="fl">3.9</span>, <span class="fl">4.8</span>, <span class="fl">4.3</span>, <span class="fl">4.4</span>]</span>
<span id="cb4-23"><a href=""></a></span>
<span id="cb4-24"><a href=""></a>monthly_costs <span class="op">=</span> [<span class="dv">150000</span>, <span class="dv">165000</span>, <span class="dv">142000</span>, <span class="dv">178000</span>, <span class="dv">155000</span>, <span class="dv">169000</span>]</span>
<span id="cb4-25"><a href=""></a></span>
<span id="cb4-26"><a href=""></a><span class="co"># Plot 1: Department Performance (Bar Chart)</span></span>
<span id="cb4-27"><a href=""></a>x_pos <span class="op">=</span> np.arange(<span class="bu">len</span>(departments))</span>
<span id="cb4-28"><a href=""></a>width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb4-29"><a href=""></a></span>
<span id="cb4-30"><a href=""></a>ax1.bar(x_pos <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, q1_performance, width, label<span class="op">=</span><span class="st">'Q1'</span>, color<span class="op">=</span><span class="st">'#1f77b4'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb4-31"><a href=""></a>ax1.bar(x_pos <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, q2_performance, width, label<span class="op">=</span><span class="st">'Q2'</span>, color<span class="op">=</span><span class="st">'#ff7f0e'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb4-32"><a href=""></a></span>
<span id="cb4-33"><a href=""></a>ax1.set_title(<span class="st">'Department Performance by Quarter'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb4-34"><a href=""></a>ax1.set_xlabel(<span class="st">'Department'</span>)</span>
<span id="cb4-35"><a href=""></a>ax1.set_ylabel(<span class="st">'Performance Score'</span>)</span>
<span id="cb4-36"><a href=""></a>ax1.set_xticks(x_pos)</span>
<span id="cb4-37"><a href=""></a>ax1.set_xticklabels(departments, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb4-38"><a href=""></a>ax1.legend()</span>
<span id="cb4-39"><a href=""></a>ax1.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb4-40"><a href=""></a></span>
<span id="cb4-41"><a href=""></a><span class="co"># Plot 2: Market Share (Pie Chart)</span></span>
<span id="cb4-42"><a href=""></a>colors <span class="op">=</span> [<span class="st">'#ff9999'</span>, <span class="st">'#66b3ff'</span>, <span class="st">'#99ff99'</span>, <span class="st">'#ffcc99'</span>]</span>
<span id="cb4-43"><a href=""></a>wedges, texts, autotexts <span class="op">=</span> ax2.pie(market_share, labels<span class="op">=</span>regions, colors<span class="op">=</span>colors, </span>
<span id="cb4-44"><a href=""></a>                                  autopct<span class="op">=</span><span class="st">'</span><span class="sc">%1.1f%%</span><span class="st">'</span>, startangle<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb4-45"><a href=""></a>ax2.set_title(<span class="st">'Market Share by Region'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb4-46"><a href=""></a></span>
<span id="cb4-47"><a href=""></a><span class="co"># Plot 3: Customer Satisfaction Distribution (Histogram)</span></span>
<span id="cb4-48"><a href=""></a>ax3.hist(customer_satisfaction, bins<span class="op">=</span><span class="dv">8</span>, color<span class="op">=</span><span class="st">'#2ca02c'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb4-49"><a href=""></a>ax3.set_title(<span class="st">'Customer Satisfaction Distribution'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb4-50"><a href=""></a>ax3.set_xlabel(<span class="st">'Satisfaction Score'</span>)</span>
<span id="cb4-51"><a href=""></a>ax3.set_ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb4-52"><a href=""></a>ax3.axvline(np.mean(customer_satisfaction), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, </span>
<span id="cb4-53"><a href=""></a>            label<span class="op">=</span><span class="ss">f'Mean: </span><span class="sc">{</span>np<span class="sc">.</span>mean(customer_satisfaction)<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb4-54"><a href=""></a>ax3.legend()</span>
<span id="cb4-55"><a href=""></a>ax3.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb4-56"><a href=""></a></span>
<span id="cb4-57"><a href=""></a><span class="co"># Plot 4: Monthly Costs Trend (Line Chart)</span></span>
<span id="cb4-58"><a href=""></a>ax4.plot(months, monthly_costs, marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'#d62728'</span>)</span>
<span id="cb4-59"><a href=""></a>ax4.fill_between(months, monthly_costs, alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'#d62728'</span>)</span>
<span id="cb4-60"><a href=""></a>ax4.set_title(<span class="st">'Monthly Operating Costs'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb4-61"><a href=""></a>ax4.set_xlabel(<span class="st">'Month'</span>)</span>
<span id="cb4-62"><a href=""></a>ax4.set_ylabel(<span class="st">'Cost ($)'</span>)</span>
<span id="cb4-63"><a href=""></a>ax4.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="op">/</span><span class="dv">1000</span><span class="sc">:.0f}</span><span class="ss">K'</span>))</span>
<span id="cb4-64"><a href=""></a>ax4.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb4-65"><a href=""></a></span>
<span id="cb4-66"><a href=""></a><span class="co"># Add overall figure title</span></span>
<span id="cb4-67"><a href=""></a>fig.suptitle(<span class="st">'Q2 2024 Business Performance Dashboard'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">0.95</span>)</span>
<span id="cb4-68"><a href=""></a></span>
<span id="cb4-69"><a href=""></a><span class="co"># Adjust layout to prevent overlap</span></span>
<span id="cb4-70"><a href=""></a>plt.tight_layout()</span>
<span id="cb4-71"><a href=""></a>plt.subplots_adjust(top<span class="op">=</span><span class="fl">0.90</span>)  <span class="co"># Make room for main title</span></span>
<span id="cb4-72"><a href=""></a>plt.show()</span>
<span id="cb4-73"><a href=""></a></span>
<span id="cb4-74"><a href=""></a><span class="bu">print</span>(<span class="st">"Dashboard Components:"</span>)</span>
<span id="cb4-75"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  4 different chart types for comprehensive analysis"</span>)</span>
<span id="cb4-76"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Integrated business metrics visualization"</span>)</span>
<span id="cb4-77"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Professional formatting and layout"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>FIGURE AND AXES STRUCTURE
==============================</code></pre>
</div>

<div class="cell-output cell-output-stdout">
<pre><code>Dashboard Components:
  4 different chart types for comprehensive analysis
  Integrated business metrics visualization
  Professional formatting and layout</code></pre>
</div>
</div>
<img data-src="Week08-lecture-slides_files/figure-revealjs/cell-3-output-2.png" class="r-stretch"></section>
<section class="slide level2">

</section></section>
<section>
<section id="part-2-essential-business-charts" class="title-slide slide level1 smaller center">
<h1>Part 2: Essential Business Charts</h1>

</section>
<section id="bar-charts-for-comparisons" class="slide level2">
<h2>Bar Charts for Comparisons</h2>
<div id="b494b00d" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href=""></a><span class="co"># Department revenue analysis</span></span>
<span id="cb7-2"><a href=""></a>departments <span class="op">=</span> [<span class="st">'Sales'</span>, <span class="st">'Marketing'</span>, <span class="st">'Product Dev'</span>, <span class="st">'Customer Service'</span>, <span class="st">'Operations'</span>]</span>
<span id="cb7-3"><a href=""></a>q1_revenue <span class="op">=</span> [<span class="dv">2500000</span>, <span class="dv">180000</span>, <span class="dv">450000</span>, <span class="dv">120000</span>, <span class="dv">380000</span>]</span>
<span id="cb7-4"><a href=""></a>q2_revenue <span class="op">=</span> [<span class="dv">2800000</span>, <span class="dv">220000</span>, <span class="dv">510000</span>, <span class="dv">140000</span>, <span class="dv">420000</span>]</span>
<span id="cb7-5"><a href=""></a>q3_revenue <span class="op">=</span> [<span class="dv">2650000</span>, <span class="dv">195000</span>, <span class="dv">480000</span>, <span class="dv">135000</span>, <span class="dv">405000</span>]</span>
<span id="cb7-6"><a href=""></a></span>
<span id="cb7-7"><a href=""></a><span class="bu">print</span>(<span class="st">"BUSINESS BAR CHART ANALYSIS"</span>)</span>
<span id="cb7-8"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">35</span>)</span>
<span id="cb7-9"><a href=""></a></span>
<span id="cb7-10"><a href=""></a><span class="co"># Create horizontal bar chart for better readability with long labels</span></span>
<span id="cb7-11"><a href=""></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">8</span>))</span>
<span id="cb7-12"><a href=""></a></span>
<span id="cb7-13"><a href=""></a><span class="co"># Vertical bar chart - Quarterly comparison</span></span>
<span id="cb7-14"><a href=""></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(departments))</span>
<span id="cb7-15"><a href=""></a>width <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb7-16"><a href=""></a></span>
<span id="cb7-17"><a href=""></a>bars1 <span class="op">=</span> ax1.bar(x <span class="op">-</span> width, q1_revenue, width, label<span class="op">=</span><span class="st">'Q1'</span>, color<span class="op">=</span><span class="st">'#1f77b4'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb7-18"><a href=""></a>bars2 <span class="op">=</span> ax1.bar(x, q2_revenue, width, label<span class="op">=</span><span class="st">'Q2'</span>, color<span class="op">=</span><span class="st">'#ff7f0e'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb7-19"><a href=""></a>bars3 <span class="op">=</span> ax1.bar(x <span class="op">+</span> width, q3_revenue, width, label<span class="op">=</span><span class="st">'Q3'</span>, color<span class="op">=</span><span class="st">'#2ca02c'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb7-20"><a href=""></a></span>
<span id="cb7-21"><a href=""></a><span class="co"># Add value labels on bars</span></span>
<span id="cb7-22"><a href=""></a><span class="kw">def</span> add_value_labels(ax, bars):</span>
<span id="cb7-23"><a href=""></a>    <span class="cf">for</span> bar <span class="kw">in</span> bars:</span>
<span id="cb7-24"><a href=""></a>        height <span class="op">=</span> bar.get_height()</span>
<span id="cb7-25"><a href=""></a>        ax.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="fl">2.</span>, height <span class="op">+</span> <span class="dv">10000</span>,</span>
<span id="cb7-26"><a href=""></a>                <span class="ss">f'$</span><span class="sc">{</span>height<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-27"><a href=""></a></span>
<span id="cb7-28"><a href=""></a>add_value_labels(ax1, bars1)</span>
<span id="cb7-29"><a href=""></a>add_value_labels(ax1, bars2)</span>
<span id="cb7-30"><a href=""></a>add_value_labels(ax1, bars3)</span>
<span id="cb7-31"><a href=""></a></span>
<span id="cb7-32"><a href=""></a>ax1.set_title(<span class="st">'Quarterly Revenue by Department'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-33"><a href=""></a>ax1.set_xlabel(<span class="st">'Department'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-34"><a href=""></a>ax1.set_ylabel(<span class="st">'Revenue ($)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-35"><a href=""></a>ax1.set_xticks(x)</span>
<span id="cb7-36"><a href=""></a>ax1.set_xticklabels(departments, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb7-37"><a href=""></a>ax1.legend()</span>
<span id="cb7-38"><a href=""></a>ax1.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb7-39"><a href=""></a>ax1.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M'</span>))</span>
<span id="cb7-40"><a href=""></a></span>
<span id="cb7-41"><a href=""></a><span class="co"># Horizontal bar chart - Total performance</span></span>
<span id="cb7-42"><a href=""></a>total_revenue <span class="op">=</span> [<span class="bu">sum</span>(x) <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">zip</span>(q1_revenue, q2_revenue, q3_revenue)]</span>
<span id="cb7-43"><a href=""></a>colors <span class="op">=</span> [<span class="st">'#ff7f7f'</span> <span class="cf">if</span> x <span class="op">&lt;</span> np.mean(total_revenue) <span class="cf">else</span> <span class="st">'#7fbf7f'</span> <span class="cf">for</span> x <span class="kw">in</span> total_revenue]</span>
<span id="cb7-44"><a href=""></a></span>
<span id="cb7-45"><a href=""></a>bars <span class="op">=</span> ax2.barh(departments, total_revenue, color<span class="op">=</span>colors, alpha<span class="op">=</span><span class="fl">0.8</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb7-46"><a href=""></a></span>
<span id="cb7-47"><a href=""></a><span class="co"># Add value labels</span></span>
<span id="cb7-48"><a href=""></a><span class="cf">for</span> i, (bar, value) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(bars, total_revenue)):</span>
<span id="cb7-49"><a href=""></a>    ax2.text(value <span class="op">+</span> <span class="dv">50000</span>, bar.get_y() <span class="op">+</span> bar.get_height()<span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb7-50"><a href=""></a>             <span class="ss">f'$</span><span class="sc">{</span>value<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-51"><a href=""></a></span>
<span id="cb7-52"><a href=""></a>ax2.set_title(<span class="st">'Total 9-Month Revenue by Department'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-53"><a href=""></a>ax2.set_xlabel(<span class="st">'Total Revenue ($)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-54"><a href=""></a>ax2.xaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M'</span>))</span>
<span id="cb7-55"><a href=""></a>ax2.grid(axis<span class="op">=</span><span class="st">'x'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb7-56"><a href=""></a></span>
<span id="cb7-57"><a href=""></a><span class="co"># Add average line</span></span>
<span id="cb7-58"><a href=""></a>avg_revenue <span class="op">=</span> np.mean(total_revenue)</span>
<span id="cb7-59"><a href=""></a>ax2.axvline(avg_revenue, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, </span>
<span id="cb7-60"><a href=""></a>            label<span class="op">=</span><span class="ss">f'Average: $</span><span class="sc">{</span>avg_revenue<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M'</span>)</span>
<span id="cb7-61"><a href=""></a>ax2.legend()</span>
<span id="cb7-62"><a href=""></a></span>
<span id="cb7-63"><a href=""></a>plt.tight_layout()</span>
<span id="cb7-64"><a href=""></a>plt.show()</span>
<span id="cb7-65"><a href=""></a></span>
<span id="cb7-66"><a href=""></a><span class="co"># Business insights</span></span>
<span id="cb7-67"><a href=""></a><span class="bu">print</span>(<span class="st">"Key Performance Insights:"</span>)</span>
<span id="cb7-68"><a href=""></a>best_dept <span class="op">=</span> departments[np.argmax(total_revenue)]</span>
<span id="cb7-69"><a href=""></a>worst_dept <span class="op">=</span> departments[np.argmin(total_revenue)]</span>
<span id="cb7-70"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Top Performer: </span><span class="sc">{</span>best_dept<span class="sc">}</span><span class="ss"> ($</span><span class="sc">{</span><span class="bu">max</span>(total_revenue)<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M)"</span>)</span>
<span id="cb7-71"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Needs Attention: </span><span class="sc">{</span>worst_dept<span class="sc">}</span><span class="ss"> ($</span><span class="sc">{</span><span class="bu">min</span>(total_revenue)<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M)"</span>)</span>
<span id="cb7-72"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Revenue Gap: $</span><span class="sc">{</span>(<span class="bu">max</span>(total_revenue) <span class="op">-</span> <span class="bu">min</span>(total_revenue))<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M"</span>)</span>
<span id="cb7-73"><a href=""></a></span>
<span id="cb7-74"><a href=""></a><span class="co"># Growth analysis</span></span>
<span id="cb7-75"><a href=""></a>q2_growth <span class="op">=</span> [(q2 <span class="op">-</span> q1) <span class="op">/</span> q1 <span class="op">*</span> <span class="dv">100</span> <span class="cf">for</span> q1, q2 <span class="kw">in</span> <span class="bu">zip</span>(q1_revenue, q2_revenue)]</span>
<span id="cb7-76"><a href=""></a>q3_growth <span class="op">=</span> [(q3 <span class="op">-</span> q2) <span class="op">/</span> q2 <span class="op">*</span> <span class="dv">100</span> <span class="cf">for</span> q2, q3 <span class="kw">in</span> <span class="bu">zip</span>(q2_revenue, q3_revenue)]</span>
<span id="cb7-77"><a href=""></a></span>
<span id="cb7-78"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Avg Q2 Growth: </span><span class="sc">{</span>np<span class="sc">.</span>mean(q2_growth)<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb7-79"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Avg Q3 Growth: </span><span class="sc">{</span>np<span class="sc">.</span>mean(q3_growth)<span class="sc">:.1f}</span><span class="ss">%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>BUSINESS BAR CHART ANALYSIS
===================================</code></pre>
</div>

<div class="cell-output cell-output-stdout">
<pre><code>Key Performance Insights:
  Top Performer: Sales ($8.0M)
  Needs Attention: Customer Service ($0.4M)
  Revenue Gap: $7.6M
  Avg Q2 Growth: 14.9%
  Avg Q3 Growth: -5.9%</code></pre>
</div>
</div>
<img data-src="Week08-lecture-slides_files/figure-revealjs/cell-4-output-2.png" class="r-stretch"></section>
<section id="scatter-plots-for-relationships" class="slide level2 smaller">
<h2>Scatter Plots for Relationships</h2>
<div id="ea644668" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href=""></a><span class="co"># Marketing spend vs. Sales relationship analysis</span></span>
<span id="cb10-2"><a href=""></a>marketing_campaigns <span class="op">=</span> pd.DataFrame({</span>
<span id="cb10-3"><a href=""></a>    <span class="st">'Campaign'</span>: [<span class="ss">f'Campaign_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">21</span>)],</span>
<span id="cb10-4"><a href=""></a>    <span class="st">'Marketing_Spend'</span>: np.random.uniform(<span class="dv">50000</span>, <span class="dv">500000</span>, <span class="dv">20</span>),</span>
<span id="cb10-5"><a href=""></a>    <span class="st">'Sales_Revenue'</span>: np.random.uniform(<span class="dv">200000</span>, <span class="dv">2000000</span>, <span class="dv">20</span>),</span>
<span id="cb10-6"><a href=""></a>    <span class="st">'Duration_Days'</span>: np.random.randint(<span class="dv">30</span>, <span class="dv">180</span>, <span class="dv">20</span>),</span>
<span id="cb10-7"><a href=""></a>    <span class="st">'Channel'</span>: np.random.choice([<span class="st">'Digital'</span>, <span class="st">'Traditional'</span>, <span class="st">'Social Media'</span>, <span class="st">'Email'</span>], <span class="dv">20</span>)</span>
<span id="cb10-8"><a href=""></a>})</span>
<span id="cb10-9"><a href=""></a></span>
<span id="cb10-10"><a href=""></a><span class="co"># Create realistic correlation between spend and revenue</span></span>
<span id="cb10-11"><a href=""></a>marketing_campaigns[<span class="st">'Sales_Revenue'</span>] <span class="op">=</span> (marketing_campaigns[<span class="st">'Marketing_Spend'</span>] <span class="op">*</span> <span class="fl">3.2</span> <span class="op">+</span> </span>
<span id="cb10-12"><a href=""></a>                                       np.random.normal(<span class="dv">0</span>, <span class="dv">100000</span>, <span class="dv">20</span>))</span>
<span id="cb10-13"><a href=""></a>marketing_campaigns[<span class="st">'Sales_Revenue'</span>] <span class="op">=</span> np.<span class="bu">abs</span>(marketing_campaigns[<span class="st">'Sales_Revenue'</span>])</span>
<span id="cb10-14"><a href=""></a></span>
<span id="cb10-15"><a href=""></a><span class="co"># Calculate ROI</span></span>
<span id="cb10-16"><a href=""></a>marketing_campaigns[<span class="st">'ROI'</span>] <span class="op">=</span> ((marketing_campaigns[<span class="st">'Sales_Revenue'</span>] <span class="op">-</span> marketing_campaigns[<span class="st">'Marketing_Spend'</span>]) <span class="op">/</span> </span>
<span id="cb10-17"><a href=""></a>                             marketing_campaigns[<span class="st">'Marketing_Spend'</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb10-18"><a href=""></a></span>
<span id="cb10-19"><a href=""></a><span class="bu">print</span>(<span class="st">"MARKETING ROI SCATTER ANALYSIS"</span>)</span>
<span id="cb10-20"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">35</span>)</span>
<span id="cb10-21"><a href=""></a></span>
<span id="cb10-22"><a href=""></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">7</span>))</span>
<span id="cb10-23"><a href=""></a></span>
<span id="cb10-24"><a href=""></a><span class="co"># Scatter plot 1: Marketing Spend vs Sales Revenue</span></span>
<span id="cb10-25"><a href=""></a>channels <span class="op">=</span> marketing_campaigns[<span class="st">'Channel'</span>].unique()</span>
<span id="cb10-26"><a href=""></a>colors <span class="op">=</span> [<span class="st">'#1f77b4'</span>, <span class="st">'#ff7f0e'</span>, <span class="st">'#2ca02c'</span>, <span class="st">'#d62728'</span>]</span>
<span id="cb10-27"><a href=""></a>channel_colors <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(channels, colors))</span>
<span id="cb10-28"><a href=""></a></span>
<span id="cb10-29"><a href=""></a><span class="cf">for</span> channel <span class="kw">in</span> channels:</span>
<span id="cb10-30"><a href=""></a>    channel_data <span class="op">=</span> marketing_campaigns[marketing_campaigns[<span class="st">'Channel'</span>] <span class="op">==</span> channel]</span>
<span id="cb10-31"><a href=""></a>    ax1.scatter(channel_data[<span class="st">'Marketing_Spend'</span>], channel_data[<span class="st">'Sales_Revenue'</span>], </span>
<span id="cb10-32"><a href=""></a>               s<span class="op">=</span>channel_data[<span class="st">'Duration_Days'</span>]<span class="op">*</span><span class="dv">2</span>,  <span class="co"># Size based on campaign duration</span></span>
<span id="cb10-33"><a href=""></a>               c<span class="op">=</span>channel_colors[channel], alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span>channel, edgecolors<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb10-34"><a href=""></a></span>
<span id="cb10-35"><a href=""></a><span class="co"># Add trendline</span></span>
<span id="cb10-36"><a href=""></a>z <span class="op">=</span> np.polyfit(marketing_campaigns[<span class="st">'Marketing_Spend'</span>], marketing_campaigns[<span class="st">'Sales_Revenue'</span>], <span class="dv">1</span>)</span>
<span id="cb10-37"><a href=""></a>p <span class="op">=</span> np.poly1d(z)</span>
<span id="cb10-38"><a href=""></a>ax1.plot(marketing_campaigns[<span class="st">'Marketing_Spend'</span>], p(marketing_campaigns[<span class="st">'Marketing_Spend'</span>]), </span>
<span id="cb10-39"><a href=""></a>         <span class="st">"r--"</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Trend Line'</span>)</span>
<span id="cb10-40"><a href=""></a></span>
<span id="cb10-41"><a href=""></a>ax1.set_title(<span class="st">'Marketing Spend vs Sales Revenue'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb10-42"><a href=""></a>ax1.set_xlabel(<span class="st">'Marketing Spend ($)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb10-43"><a href=""></a>ax1.set_ylabel(<span class="st">'Sales Revenue ($)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb10-44"><a href=""></a>ax1.legend(title<span class="op">=</span><span class="st">'Channel'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb10-45"><a href=""></a>ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb10-46"><a href=""></a></span>
<span id="cb10-47"><a href=""></a><span class="co"># Format axes</span></span>
<span id="cb10-48"><a href=""></a>ax1.xaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="op">/</span><span class="dv">1000</span><span class="sc">:.0f}</span><span class="ss">K'</span>))</span>
<span id="cb10-49"><a href=""></a>ax1.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M'</span>))</span>
<span id="cb10-50"><a href=""></a></span>
<span id="cb10-51"><a href=""></a><span class="co"># Scatter plot 2: ROI Analysis</span></span>
<span id="cb10-52"><a href=""></a><span class="co"># Color points by ROI performance</span></span>
<span id="cb10-53"><a href=""></a>roi_colors <span class="op">=</span> [<span class="st">'red'</span> <span class="cf">if</span> roi <span class="op">&lt;</span> <span class="dv">100</span> <span class="cf">else</span> <span class="st">'orange'</span> <span class="cf">if</span> roi <span class="op">&lt;</span> <span class="dv">200</span> <span class="cf">else</span> <span class="st">'green'</span> </span>
<span id="cb10-54"><a href=""></a>              <span class="cf">for</span> roi <span class="kw">in</span> marketing_campaigns[<span class="st">'ROI'</span>]]</span>
<span id="cb10-55"><a href=""></a></span>
<span id="cb10-56"><a href=""></a>scatter <span class="op">=</span> ax2.scatter(marketing_campaigns[<span class="st">'Marketing_Spend'</span>], marketing_campaigns[<span class="st">'ROI'</span>], </span>
<span id="cb10-57"><a href=""></a>                     s<span class="op">=</span>marketing_campaigns[<span class="st">'Duration_Days'</span>]<span class="op">*</span><span class="dv">3</span>, c<span class="op">=</span>roi_colors, </span>
<span id="cb10-58"><a href=""></a>                     alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolors<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb10-59"><a href=""></a></span>
<span id="cb10-60"><a href=""></a>ax2.set_title(<span class="st">'Marketing Spend vs ROI Performance'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb10-61"><a href=""></a>ax2.set_xlabel(<span class="st">'Marketing Spend ($)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb10-62"><a href=""></a>ax2.set_ylabel(<span class="st">'ROI (%)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb10-63"><a href=""></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb10-64"><a href=""></a></span>
<span id="cb10-65"><a href=""></a><span class="co"># Add ROI benchmark lines</span></span>
<span id="cb10-66"><a href=""></a>ax2.axhline(y<span class="op">=</span><span class="dv">100</span>, color<span class="op">=</span><span class="st">'orange'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Break-even (100%)'</span>)</span>
<span id="cb10-67"><a href=""></a>ax2.axhline(y<span class="op">=</span><span class="dv">200</span>, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Target ROI (200%)'</span>)</span>
<span id="cb10-68"><a href=""></a>ax2.legend()</span>
<span id="cb10-69"><a href=""></a></span>
<span id="cb10-70"><a href=""></a><span class="co"># Format x-axis</span></span>
<span id="cb10-71"><a href=""></a>ax2.xaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="op">/</span><span class="dv">1000</span><span class="sc">:.0f}</span><span class="ss">K'</span>))</span>
<span id="cb10-72"><a href=""></a></span>
<span id="cb10-73"><a href=""></a>plt.tight_layout()</span>
<span id="cb10-74"><a href=""></a>plt.show()</span>
<span id="cb10-75"><a href=""></a></span>
<span id="cb10-76"><a href=""></a><span class="co"># Calculate correlation</span></span>
<span id="cb10-77"><a href=""></a>correlation <span class="op">=</span> marketing_campaigns[<span class="st">'Marketing_Spend'</span>].corr(marketing_campaigns[<span class="st">'Sales_Revenue'</span>])</span>
<span id="cb10-78"><a href=""></a></span>
<span id="cb10-79"><a href=""></a><span class="bu">print</span>(<span class="st">"Marketing Analysis Results:"</span>)</span>
<span id="cb10-80"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Correlation (Spend vs Revenue): </span><span class="sc">{</span>correlation<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb10-81"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Average ROI: </span><span class="sc">{</span>marketing_campaigns[<span class="st">'ROI'</span>]<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb10-82"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Best ROI Campaign: </span><span class="sc">{</span>marketing_campaigns<span class="sc">.</span>loc[marketing_campaigns[<span class="st">'ROI'</span>].idxmax(), <span class="st">'Campaign'</span>]<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>marketing_campaigns[<span class="st">'ROI'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb10-83"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Worst ROI Campaign: </span><span class="sc">{</span>marketing_campaigns<span class="sc">.</span>loc[marketing_campaigns[<span class="st">'ROI'</span>].idxmin(), <span class="st">'Campaign'</span>]<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>marketing_campaigns[<span class="st">'ROI'</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb10-84"><a href=""></a></span>
<span id="cb10-85"><a href=""></a><span class="co"># High performers</span></span>
<span id="cb10-86"><a href=""></a>high_roi <span class="op">=</span> marketing_campaigns[marketing_campaigns[<span class="st">'ROI'</span>] <span class="op">&gt;</span> <span class="dv">200</span>]</span>
<span id="cb10-87"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  High-ROI Campaigns (&gt;200%): </span><span class="sc">{</span><span class="bu">len</span>(high_roi)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-88"><a href=""></a><span class="cf">if</span> <span class="bu">len</span>(high_roi) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb10-89"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"    Average Spend: $</span><span class="sc">{</span>high_roi[<span class="st">'Marketing_Spend'</span>]<span class="sc">.</span>mean()<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb10-90"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"    Dominant Channel: </span><span class="sc">{</span>high_roi[<span class="st">'Channel'</span>]<span class="sc">.</span>mode()[<span class="dv">0</span>] <span class="cf">if</span> <span class="bu">len</span>(high_roi[<span class="st">'Channel'</span>].mode()) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">'N/A'</span><span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MARKETING ROI SCATTER ANALYSIS
===================================</code></pre>
</div>

<div class="cell-output cell-output-stdout">
<pre><code>Marketing Analysis Results:
  Correlation (Spend vs Revenue): 0.965
  Average ROI: 240.5%
  Best ROI Campaign: Campaign_2 (410.0%)
  Worst ROI Campaign: Campaign_3 (167.2%)
  High-ROI Campaigns (&gt;200%): 16
    Average Spend: $255,706
    Dominant Channel: Social Media</code></pre>
</div>
</div>
<img data-src="Week08-lecture-slides_files/figure-revealjs/cell-5-output-2.png" class="r-stretch"></section>
<section id="histograms-for-distributions" class="slide level2 smaller">
<h2>Histograms for Distributions</h2>
<div id="75cff1d9" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href=""></a><span class="co"># Customer purchase behavior analysis</span></span>
<span id="cb13-2"><a href=""></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb13-3"><a href=""></a></span>
<span id="cb13-4"><a href=""></a><span class="co"># Generate realistic customer purchase data</span></span>
<span id="cb13-5"><a href=""></a>n_customers <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb13-6"><a href=""></a>customer_purchases <span class="op">=</span> {</span>
<span id="cb13-7"><a href=""></a>    <span class="st">'Age'</span>: np.random.normal(<span class="dv">42</span>, <span class="dv">12</span>, n_customers).astype(<span class="bu">int</span>),</span>
<span id="cb13-8"><a href=""></a>    <span class="st">'Annual_Income'</span>: np.random.lognormal(<span class="dv">11</span>, <span class="fl">0.5</span>, n_customers),</span>
<span id="cb13-9"><a href=""></a>    <span class="st">'Purchase_Amount'</span>: np.random.lognormal(<span class="dv">6</span>, <span class="fl">1.2</span>, n_customers),</span>
<span id="cb13-10"><a href=""></a>    <span class="st">'Time_on_Site'</span>: np.random.gamma(<span class="dv">2</span>, <span class="dv">3</span>, n_customers),</span>
<span id="cb13-11"><a href=""></a>    <span class="st">'Satisfaction_Score'</span>: np.random.beta(<span class="dv">8</span>, <span class="dv">2</span>, n_customers) <span class="op">*</span> <span class="dv">5</span>  <span class="co"># Scale to 1-5</span></span>
<span id="cb13-12"><a href=""></a>}</span>
<span id="cb13-13"><a href=""></a></span>
<span id="cb13-14"><a href=""></a><span class="co"># Clean the data</span></span>
<span id="cb13-15"><a href=""></a>customer_purchases[<span class="st">'Age'</span>] <span class="op">=</span> np.clip(customer_purchases[<span class="st">'Age'</span>], <span class="dv">18</span>, <span class="dv">80</span>)</span>
<span id="cb13-16"><a href=""></a>customer_purchases[<span class="st">'Annual_Income'</span>] <span class="op">=</span> np.clip(customer_purchases[<span class="st">'Annual_Income'</span>], <span class="dv">20000</span>, <span class="dv">500000</span>)</span>
<span id="cb13-17"><a href=""></a>customer_purchases[<span class="st">'Purchase_Amount'</span>] <span class="op">=</span> np.clip(customer_purchases[<span class="st">'Purchase_Amount'</span>], <span class="dv">10</span>, <span class="dv">10000</span>)</span>
<span id="cb13-18"><a href=""></a>customer_purchases[<span class="st">'Time_on_Site'</span>] <span class="op">=</span> np.clip(customer_purchases[<span class="st">'Time_on_Site'</span>], <span class="dv">1</span>, <span class="dv">60</span>)</span>
<span id="cb13-19"><a href=""></a></span>
<span id="cb13-20"><a href=""></a>df_customers <span class="op">=</span> pd.DataFrame(customer_purchases)</span>
<span id="cb13-21"><a href=""></a></span>
<span id="cb13-22"><a href=""></a><span class="bu">print</span>(<span class="st">"CUSTOMER BEHAVIOR DISTRIBUTION ANALYSIS"</span>)</span>
<span id="cb13-23"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">45</span>)</span>
<span id="cb13-24"><a href=""></a></span>
<span id="cb13-25"><a href=""></a>fig, ((ax1, ax2), (ax3, ax4)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">12</span>))</span>
<span id="cb13-26"><a href=""></a></span>
<span id="cb13-27"><a href=""></a><span class="co"># 1. Age Distribution</span></span>
<span id="cb13-28"><a href=""></a>ax1.hist(df_customers[<span class="st">'Age'</span>], bins<span class="op">=</span><span class="dv">20</span>, color<span class="op">=</span><span class="st">'skyblue'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb13-29"><a href=""></a>ax1.axvline(df_customers[<span class="st">'Age'</span>].mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb13-30"><a href=""></a>            label<span class="op">=</span><span class="ss">f'Mean: </span><span class="sc">{</span>df_customers[<span class="st">"Age"</span>]<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss">'</span>)</span>
<span id="cb13-31"><a href=""></a>ax1.axvline(df_customers[<span class="st">'Age'</span>].median(), color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb13-32"><a href=""></a>            label<span class="op">=</span><span class="ss">f'Median: </span><span class="sc">{</span>df_customers[<span class="st">"Age"</span>]<span class="sc">.</span>median()<span class="sc">:.1f}</span><span class="ss">'</span>)</span>
<span id="cb13-33"><a href=""></a>ax1.set_title(<span class="st">'Customer Age Distribution'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-34"><a href=""></a>ax1.set_xlabel(<span class="st">'Age (years)'</span>)</span>
<span id="cb13-35"><a href=""></a>ax1.set_ylabel(<span class="st">'Number of Customers'</span>)</span>
<span id="cb13-36"><a href=""></a>ax1.legend()</span>
<span id="cb13-37"><a href=""></a>ax1.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-38"><a href=""></a></span>
<span id="cb13-39"><a href=""></a><span class="co"># 2. Purchase Amount Distribution  </span></span>
<span id="cb13-40"><a href=""></a>ax2.hist(df_customers[<span class="st">'Purchase_Amount'</span>], bins<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span><span class="st">'lightcoral'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb13-41"><a href=""></a>ax2.axvline(df_customers[<span class="st">'Purchase_Amount'</span>].mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb13-42"><a href=""></a>            label<span class="op">=</span><span class="ss">f'Mean: $</span><span class="sc">{</span>df_customers[<span class="st">"Purchase_Amount"</span>]<span class="sc">.</span>mean()<span class="sc">:.0f}</span><span class="ss">'</span>)</span>
<span id="cb13-43"><a href=""></a>ax2.axvline(df_customers[<span class="st">'Purchase_Amount'</span>].median(), color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb13-44"><a href=""></a>            label<span class="op">=</span><span class="ss">f'Median: $</span><span class="sc">{</span>df_customers[<span class="st">"Purchase_Amount"</span>]<span class="sc">.</span>median()<span class="sc">:.0f}</span><span class="ss">'</span>)</span>
<span id="cb13-45"><a href=""></a>ax2.set_title(<span class="st">'Purchase Amount Distribution'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-46"><a href=""></a>ax2.set_xlabel(<span class="st">'Purchase Amount ($)'</span>)</span>
<span id="cb13-47"><a href=""></a>ax2.set_ylabel(<span class="st">'Number of Customers'</span>)</span>
<span id="cb13-48"><a href=""></a>ax2.legend()</span>
<span id="cb13-49"><a href=""></a>ax2.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-50"><a href=""></a></span>
<span id="cb13-51"><a href=""></a><span class="co"># 3. Annual Income Distribution (log scale)</span></span>
<span id="cb13-52"><a href=""></a>ax3.hist(df_customers[<span class="st">'Annual_Income'</span>], bins<span class="op">=</span><span class="dv">25</span>, color<span class="op">=</span><span class="st">'lightgreen'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb13-53"><a href=""></a>ax3.axvline(df_customers[<span class="st">'Annual_Income'</span>].mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb13-54"><a href=""></a>            label<span class="op">=</span><span class="ss">f'Mean: $</span><span class="sc">{</span>df_customers[<span class="st">"Annual_Income"</span>]<span class="sc">.</span>mean()<span class="sc">:.0f}</span><span class="ss">'</span>)</span>
<span id="cb13-55"><a href=""></a>ax3.axvline(df_customers[<span class="st">'Annual_Income'</span>].median(), color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb13-56"><a href=""></a>            label<span class="op">=</span><span class="ss">f'Median: $</span><span class="sc">{</span>df_customers[<span class="st">"Annual_Income"</span>]<span class="sc">.</span>median()<span class="sc">:.0f}</span><span class="ss">'</span>)</span>
<span id="cb13-57"><a href=""></a>ax3.set_title(<span class="st">'Annual Income Distribution'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-58"><a href=""></a>ax3.set_xlabel(<span class="st">'Annual Income ($)'</span>)</span>
<span id="cb13-59"><a href=""></a>ax3.set_ylabel(<span class="st">'Number of Customers'</span>)</span>
<span id="cb13-60"><a href=""></a>ax3.legend()</span>
<span id="cb13-61"><a href=""></a>ax3.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-62"><a href=""></a>ax3.xaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="op">/</span><span class="dv">1000</span><span class="sc">:.0f}</span><span class="ss">K'</span>))</span>
<span id="cb13-63"><a href=""></a></span>
<span id="cb13-64"><a href=""></a><span class="co"># 4. Satisfaction Score Distribution</span></span>
<span id="cb13-65"><a href=""></a>ax4.hist(df_customers[<span class="st">'Satisfaction_Score'</span>], bins<span class="op">=</span><span class="dv">20</span>, color<span class="op">=</span><span class="st">'gold'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb13-66"><a href=""></a>ax4.axvline(df_customers[<span class="st">'Satisfaction_Score'</span>].mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb13-67"><a href=""></a>            label<span class="op">=</span><span class="ss">f'Mean: </span><span class="sc">{</span>df_customers[<span class="st">"Satisfaction_Score"</span>]<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb13-68"><a href=""></a>ax4.axvline(df_customers[<span class="st">'Satisfaction_Score'</span>].median(), color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb13-69"><a href=""></a>            label<span class="op">=</span><span class="ss">f'Median: </span><span class="sc">{</span>df_customers[<span class="st">"Satisfaction_Score"</span>]<span class="sc">.</span>median()<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb13-70"><a href=""></a>ax4.set_title(<span class="st">'Customer Satisfaction Score Distribution'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-71"><a href=""></a>ax4.set_xlabel(<span class="st">'Satisfaction Score (1-5)'</span>)</span>
<span id="cb13-72"><a href=""></a>ax4.set_ylabel(<span class="st">'Number of Customers'</span>)</span>
<span id="cb13-73"><a href=""></a>ax4.legend()</span>
<span id="cb13-74"><a href=""></a>ax4.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-75"><a href=""></a></span>
<span id="cb13-76"><a href=""></a>plt.tight_layout()</span>
<span id="cb13-77"><a href=""></a>plt.show()</span>
<span id="cb13-78"><a href=""></a></span>
<span id="cb13-79"><a href=""></a><span class="co"># Statistical analysis</span></span>
<span id="cb13-80"><a href=""></a><span class="bu">print</span>(<span class="st">"Customer Segmentation Insights:"</span>)</span>
<span id="cb13-81"><a href=""></a></span>
<span id="cb13-82"><a href=""></a><span class="co"># Age segments</span></span>
<span id="cb13-83"><a href=""></a>young <span class="op">=</span> df_customers[df_customers[<span class="st">'Age'</span>] <span class="op">&lt;</span> <span class="dv">30</span>]</span>
<span id="cb13-84"><a href=""></a>middle <span class="op">=</span> df_customers[(df_customers[<span class="st">'Age'</span>] <span class="op">&gt;=</span> <span class="dv">30</span>) <span class="op">&amp;</span> (df_customers[<span class="st">'Age'</span>] <span class="op">&lt;</span> <span class="dv">50</span>)]</span>
<span id="cb13-85"><a href=""></a>senior <span class="op">=</span> df_customers[df_customers[<span class="st">'Age'</span>] <span class="op">&gt;=</span> <span class="dv">50</span>]</span>
<span id="cb13-86"><a href=""></a></span>
<span id="cb13-87"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Age Segments:"</span>)</span>
<span id="cb13-88"><a href=""></a><span class="bu">print</span>(<span class="ss">f"    Young (&lt;30): </span><span class="sc">{</span><span class="bu">len</span>(young)<span class="sc">:,}</span><span class="ss"> (</span><span class="sc">{</span><span class="bu">len</span>(young)<span class="op">/</span><span class="bu">len</span>(df_customers)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb13-89"><a href=""></a><span class="bu">print</span>(<span class="ss">f"    Middle (30-49): </span><span class="sc">{</span><span class="bu">len</span>(middle)<span class="sc">:,}</span><span class="ss"> (</span><span class="sc">{</span><span class="bu">len</span>(middle)<span class="op">/</span><span class="bu">len</span>(df_customers)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb13-90"><a href=""></a><span class="bu">print</span>(<span class="ss">f"    Senior (50+): </span><span class="sc">{</span><span class="bu">len</span>(senior)<span class="sc">:,}</span><span class="ss"> (</span><span class="sc">{</span><span class="bu">len</span>(senior)<span class="op">/</span><span class="bu">len</span>(df_customers)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb13-91"><a href=""></a></span>
<span id="cb13-92"><a href=""></a><span class="co"># Purchase behavior by age group</span></span>
<span id="cb13-93"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Average Purchase by Age Group:"</span>)</span>
<span id="cb13-94"><a href=""></a><span class="bu">print</span>(<span class="ss">f"    Young: $</span><span class="sc">{</span>young[<span class="st">'Purchase_Amount'</span>]<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb13-95"><a href=""></a><span class="bu">print</span>(<span class="ss">f"    Middle: $</span><span class="sc">{</span>middle[<span class="st">'Purchase_Amount'</span>]<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb13-96"><a href=""></a><span class="bu">print</span>(<span class="ss">f"    Senior: $</span><span class="sc">{</span>senior[<span class="st">'Purchase_Amount'</span>]<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb13-97"><a href=""></a></span>
<span id="cb13-98"><a href=""></a><span class="co"># High-value customers (top 20%)</span></span>
<span id="cb13-99"><a href=""></a>high_value_threshold <span class="op">=</span> df_customers[<span class="st">'Purchase_Amount'</span>].quantile(<span class="fl">0.8</span>)</span>
<span id="cb13-100"><a href=""></a>high_value_customers <span class="op">=</span> df_customers[df_customers[<span class="st">'Purchase_Amount'</span>] <span class="op">&gt;</span> high_value_threshold]</span>
<span id="cb13-101"><a href=""></a></span>
<span id="cb13-102"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  High-Value Customers (Top 20%):"</span>)</span>
<span id="cb13-103"><a href=""></a><span class="bu">print</span>(<span class="ss">f"    Minimum Purchase: $</span><span class="sc">{</span>high_value_threshold<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb13-104"><a href=""></a><span class="bu">print</span>(<span class="ss">f"    Average Age: </span><span class="sc">{</span>high_value_customers[<span class="st">'Age'</span>]<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss">"</span>)</span>
<span id="cb13-105"><a href=""></a><span class="bu">print</span>(<span class="ss">f"    Average Income: $</span><span class="sc">{</span>high_value_customers[<span class="st">'Annual_Income'</span>]<span class="sc">.</span>mean()<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb13-106"><a href=""></a><span class="bu">print</span>(<span class="ss">f"    Average Satisfaction: </span><span class="sc">{</span>high_value_customers[<span class="st">'Satisfaction_Score'</span>]<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CUSTOMER BEHAVIOR DISTRIBUTION ANALYSIS
=============================================</code></pre>
</div>

<div class="cell-output cell-output-stdout">
<pre><code>Customer Segmentation Insights:
  Age Segments:
    Young (&lt;30): 147 (14.7%)
    Middle (30-49): 610 (61.0%)
    Senior (50+): 243 (24.3%)
  Average Purchase by Age Group:
    Young: $753.74
    Middle: $788.81
    Senior: $843.09
  High-Value Customers (Top 20%):
    Minimum Purchase: $1076.73
    Average Age: 42.7
    Average Income: $70,050
    Average Satisfaction: 3.97</code></pre>
</div>
</div>
<img data-src="Week08-lecture-slides_files/figure-revealjs/cell-6-output-2.png" class="r-stretch"></section>
<section class="slide level2">

</section></section>
<section>
<section id="part-3-professional-customization" class="title-slide slide level1 smaller center">
<h1>Part 3: Professional Customization</h1>

</section>
<section id="styling-and-formatting" class="slide level2">
<h2>Styling and Formatting</h2>
<div id="e78fe0bc" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href=""></a><span class="co"># Professional business report styling</span></span>
<span id="cb16-2"><a href=""></a><span class="bu">print</span>(<span class="st">"PROFESSIONAL CHART STYLING"</span>)</span>
<span id="cb16-3"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">35</span>)</span>
<span id="cb16-4"><a href=""></a></span>
<span id="cb16-5"><a href=""></a><span class="co"># Create business performance data</span></span>
<span id="cb16-6"><a href=""></a>quarters <span class="op">=</span> [<span class="st">'Q1 2023'</span>, <span class="st">'Q2 2023'</span>, <span class="st">'Q3 2023'</span>, <span class="st">'Q4 2023'</span>, <span class="st">'Q1 2024'</span>, <span class="st">'Q2 2024'</span>]</span>
<span id="cb16-7"><a href=""></a>revenue <span class="op">=</span> [<span class="fl">4.2</span>, <span class="fl">4.8</span>, <span class="fl">4.5</span>, <span class="fl">5.2</span>, <span class="fl">5.8</span>, <span class="fl">6.1</span>]  <span class="co"># In millions</span></span>
<span id="cb16-8"><a href=""></a>profit_margin <span class="op">=</span> [<span class="fl">12.5</span>, <span class="fl">14.2</span>, <span class="fl">13.8</span>, <span class="fl">15.1</span>, <span class="fl">16.2</span>, <span class="fl">17.3</span>]  <span class="co"># Percentage</span></span>
<span id="cb16-9"><a href=""></a>customer_count <span class="op">=</span> [<span class="dv">15000</span>, <span class="dv">17200</span>, <span class="dv">16800</span>, <span class="dv">19500</span>, <span class="dv">22100</span>, <span class="dv">24300</span>]</span>
<span id="cb16-10"><a href=""></a></span>
<span id="cb16-11"><a href=""></a><span class="co"># Set up the figure with custom styling</span></span>
<span id="cb16-12"><a href=""></a>plt.style.use(<span class="st">'default'</span>)  <span class="co"># Reset to default</span></span>
<span id="cb16-13"><a href=""></a>fig, (ax1, ax2, ax3) <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">12</span>))</span>
<span id="cb16-14"><a href=""></a></span>
<span id="cb16-15"><a href=""></a><span class="co"># Define company colors</span></span>
<span id="cb16-16"><a href=""></a>primary_color <span class="op">=</span> <span class="st">'#2E86AB'</span>    <span class="co"># Professional blue</span></span>
<span id="cb16-17"><a href=""></a>secondary_color <span class="op">=</span> <span class="st">'#A23B72'</span>  <span class="co"># Accent purple  </span></span>
<span id="cb16-18"><a href=""></a>success_color <span class="op">=</span> <span class="st">'#F18F01'</span>    <span class="co"># Warning orange</span></span>
<span id="cb16-19"><a href=""></a>neutral_color <span class="op">=</span> <span class="st">'#C73E1D'</span>    <span class="co"># Alert red</span></span>
<span id="cb16-20"><a href=""></a></span>
<span id="cb16-21"><a href=""></a><span class="co"># Chart 1: Revenue Trend with Professional Styling</span></span>
<span id="cb16-22"><a href=""></a>ax1.plot(quarters, revenue, marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="dv">3</span>, markersize<span class="op">=</span><span class="dv">8</span>, </span>
<span id="cb16-23"><a href=""></a>         color<span class="op">=</span>primary_color, markerfacecolor<span class="op">=</span><span class="st">'white'</span>, markeredgewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb16-24"><a href=""></a>         markeredgecolor<span class="op">=</span>primary_color)</span>
<span id="cb16-25"><a href=""></a></span>
<span id="cb16-26"><a href=""></a><span class="co"># Add data labels</span></span>
<span id="cb16-27"><a href=""></a><span class="cf">for</span> i, v <span class="kw">in</span> <span class="bu">enumerate</span>(revenue):</span>
<span id="cb16-28"><a href=""></a>    ax1.annotate(<span class="ss">f'$</span><span class="sc">{</span>v<span class="sc">:.1f}</span><span class="ss">M'</span>, (i, v), textcoords<span class="op">=</span><span class="st">"offset points"</span>, </span>
<span id="cb16-29"><a href=""></a>                xytext<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">10</span>), ha<span class="op">=</span><span class="st">'center'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb16-30"><a href=""></a></span>
<span id="cb16-31"><a href=""></a>ax1.set_title(<span class="st">'Quarterly Revenue Performance'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb16-32"><a href=""></a>ax1.set_ylabel(<span class="st">'Revenue ($ Millions)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb16-33"><a href=""></a>ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb16-34"><a href=""></a>ax1.set_ylim(<span class="fl">3.5</span>, <span class="fl">6.5</span>)</span>
<span id="cb16-35"><a href=""></a></span>
<span id="cb16-36"><a href=""></a><span class="co"># Custom background color for better presentation</span></span>
<span id="cb16-37"><a href=""></a>ax1.set_facecolor(<span class="st">'#f8f9fa'</span>)</span>
<span id="cb16-38"><a href=""></a></span>
<span id="cb16-39"><a href=""></a><span class="co"># Chart 2: Profit Margin with Conditional Formatting</span></span>
<span id="cb16-40"><a href=""></a>colors <span class="op">=</span> [success_color <span class="cf">if</span> x <span class="op">&gt;=</span> <span class="dv">15</span> <span class="cf">else</span> secondary_color <span class="cf">if</span> x <span class="op">&gt;=</span> <span class="dv">13</span> <span class="cf">else</span> neutral_color </span>
<span id="cb16-41"><a href=""></a>          <span class="cf">for</span> x <span class="kw">in</span> profit_margin]</span>
<span id="cb16-42"><a href=""></a></span>
<span id="cb16-43"><a href=""></a>bars <span class="op">=</span> ax2.bar(quarters, profit_margin, color<span class="op">=</span>colors, alpha<span class="op">=</span><span class="fl">0.8</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-44"><a href=""></a></span>
<span id="cb16-45"><a href=""></a><span class="co"># Add value labels on bars</span></span>
<span id="cb16-46"><a href=""></a><span class="cf">for</span> bar, value <span class="kw">in</span> <span class="bu">zip</span>(bars, profit_margin):</span>
<span id="cb16-47"><a href=""></a>    height <span class="op">=</span> bar.get_height()</span>
<span id="cb16-48"><a href=""></a>    ax2.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="fl">2.</span>, height <span class="op">+</span> <span class="fl">0.2</span>,</span>
<span id="cb16-49"><a href=""></a>             <span class="ss">f'</span><span class="sc">{</span>value<span class="sc">:.1f}</span><span class="ss">%'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb16-50"><a href=""></a></span>
<span id="cb16-51"><a href=""></a><span class="co"># Add target line</span></span>
<span id="cb16-52"><a href=""></a>target_margin <span class="op">=</span> <span class="fl">15.0</span></span>
<span id="cb16-53"><a href=""></a>ax2.axhline(y<span class="op">=</span>target_margin, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb16-54"><a href=""></a>ax2.text(<span class="bu">len</span>(quarters)<span class="op">-</span><span class="dv">1</span>, target_margin<span class="op">+</span><span class="fl">0.3</span>, <span class="st">'Target: 15%'</span>, ha<span class="op">=</span><span class="st">'right'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, </span>
<span id="cb16-55"><a href=""></a>         fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb16-56"><a href=""></a></span>
<span id="cb16-57"><a href=""></a>ax2.set_title(<span class="st">'Quarterly Profit Margin Trends'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb16-58"><a href=""></a>ax2.set_ylabel(<span class="st">'Profit Margin (%)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb16-59"><a href=""></a>ax2.set_ylim(<span class="dv">10</span>, <span class="dv">19</span>)</span>
<span id="cb16-60"><a href=""></a>ax2.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb16-61"><a href=""></a>ax2.set_facecolor(<span class="st">'#f8f9fa'</span>)</span>
<span id="cb16-62"><a href=""></a></span>
<span id="cb16-63"><a href=""></a><span class="co"># Rotate x-axis labels for better readability</span></span>
<span id="cb16-64"><a href=""></a>plt.setp(ax2.xaxis.get_majorticklabels(), rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb16-65"><a href=""></a></span>
<span id="cb16-66"><a href=""></a><span class="co"># Chart 3: Customer Growth with Annotations</span></span>
<span id="cb16-67"><a href=""></a>ax3.plot(quarters, customer_count, marker<span class="op">=</span><span class="st">'s'</span>, linewidth<span class="op">=</span><span class="dv">3</span>, markersize<span class="op">=</span><span class="dv">8</span>, </span>
<span id="cb16-68"><a href=""></a>         color<span class="op">=</span>secondary_color, markerfacecolor<span class="op">=</span><span class="st">'white'</span>, markeredgewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb16-69"><a href=""></a>         markeredgecolor<span class="op">=</span>secondary_color)</span>
<span id="cb16-70"><a href=""></a></span>
<span id="cb16-71"><a href=""></a><span class="co"># Fill area under curve</span></span>
<span id="cb16-72"><a href=""></a>ax3.fill_between(quarters, customer_count, alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span>secondary_color)</span>
<span id="cb16-73"><a href=""></a></span>
<span id="cb16-74"><a href=""></a><span class="co"># Add annotations for significant points</span></span>
<span id="cb16-75"><a href=""></a>max_customers <span class="op">=</span> <span class="bu">max</span>(customer_count)</span>
<span id="cb16-76"><a href=""></a>max_quarter <span class="op">=</span> quarters[customer_count.index(max_customers)]</span>
<span id="cb16-77"><a href=""></a>ax3.annotate(<span class="ss">f'Peak: </span><span class="sc">{</span>max_customers<span class="sc">:,}</span><span class="ss"> customers'</span>, </span>
<span id="cb16-78"><a href=""></a>             xy<span class="op">=</span>(customer_count.index(max_customers), max_customers),</span>
<span id="cb16-79"><a href=""></a>             xytext<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>), textcoords<span class="op">=</span><span class="st">'offset points'</span>,</span>
<span id="cb16-80"><a href=""></a>             arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>, color<span class="op">=</span><span class="st">'black'</span>, lw<span class="op">=</span><span class="fl">1.5</span>),</span>
<span id="cb16-81"><a href=""></a>             fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb16-82"><a href=""></a>             bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round,pad=0.3'</span>, facecolor<span class="op">=</span><span class="st">'yellow'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>))</span>
<span id="cb16-83"><a href=""></a></span>
<span id="cb16-84"><a href=""></a>ax3.set_title(<span class="st">'Customer Base Growth'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb16-85"><a href=""></a>ax3.set_ylabel(<span class="st">'Number of Customers'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb16-86"><a href=""></a>ax3.set_xlabel(<span class="st">'Quarter'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb16-87"><a href=""></a>ax3.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb16-88"><a href=""></a>ax3.set_facecolor(<span class="st">'#f8f9fa'</span>)</span>
<span id="cb16-89"><a href=""></a></span>
<span id="cb16-90"><a href=""></a><span class="co"># Format y-axis with comma separators</span></span>
<span id="cb16-91"><a href=""></a>ax3.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'</span><span class="sc">{</span><span class="bu">int</span>(x)<span class="sc">:,}</span><span class="ss">'</span>))</span>
<span id="cb16-92"><a href=""></a></span>
<span id="cb16-93"><a href=""></a><span class="co"># Rotate x-axis labels</span></span>
<span id="cb16-94"><a href=""></a>plt.setp(ax3.xaxis.get_majorticklabels(), rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb16-95"><a href=""></a></span>
<span id="cb16-96"><a href=""></a><span class="co"># Overall figure formatting</span></span>
<span id="cb16-97"><a href=""></a>fig.suptitle(<span class="st">'Executive Dashboard - Business Performance Overview'</span>, </span>
<span id="cb16-98"><a href=""></a>             fontsize<span class="op">=</span><span class="dv">18</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">0.98</span>)</span>
<span id="cb16-99"><a href=""></a></span>
<span id="cb16-100"><a href=""></a><span class="co"># Add subtitle with reporting period</span></span>
<span id="cb16-101"><a href=""></a>fig.text(<span class="fl">0.5</span>, <span class="fl">0.94</span>, <span class="st">'Reporting Period: Q1 2023 - Q2 2024'</span>, </span>
<span id="cb16-102"><a href=""></a>         ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, style<span class="op">=</span><span class="st">'italic'</span>)</span>
<span id="cb16-103"><a href=""></a></span>
<span id="cb16-104"><a href=""></a><span class="co"># Adjust layout</span></span>
<span id="cb16-105"><a href=""></a>plt.tight_layout()</span>
<span id="cb16-106"><a href=""></a>plt.subplots_adjust(top<span class="op">=</span><span class="fl">0.90</span>)</span>
<span id="cb16-107"><a href=""></a>plt.show()</span>
<span id="cb16-108"><a href=""></a></span>
<span id="cb16-109"><a href=""></a><span class="co"># Calculate business insights</span></span>
<span id="cb16-110"><a href=""></a>revenue_growth <span class="op">=</span> ((revenue[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> revenue[<span class="dv">0</span>]) <span class="op">/</span> revenue[<span class="dv">0</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb16-111"><a href=""></a>customer_growth <span class="op">=</span> ((customer_count[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> customer_count[<span class="dv">0</span>]) <span class="op">/</span> customer_count[<span class="dv">0</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb16-112"><a href=""></a>margin_improvement <span class="op">=</span> profit_margin[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> profit_margin[<span class="dv">0</span>]</span>
<span id="cb16-113"><a href=""></a></span>
<span id="cb16-114"><a href=""></a><span class="bu">print</span>(<span class="st">"Executive Summary:"</span>)</span>
<span id="cb16-115"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Revenue Growth (5 quarters): </span><span class="sc">{</span>revenue_growth<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb16-116"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Customer Growth: </span><span class="sc">{</span>customer_growth<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb16-117"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Profit Margin Improvement: +</span><span class="sc">{</span>margin_improvement<span class="sc">:.1f}</span><span class="ss"> percentage points"</span>)</span>
<span id="cb16-118"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Current Quarterly Run Rate: $</span><span class="sc">{</span>revenue[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span><span class="dv">4</span><span class="sc">:.1f}</span><span class="ss">M annually"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PROFESSIONAL CHART STYLING
===================================</code></pre>
</div>

<div class="cell-output cell-output-stdout">
<pre><code>Executive Summary:
  Revenue Growth (5 quarters): 45.2%
  Customer Growth: 62.0%
  Profit Margin Improvement: +4.8 percentage points
  Current Quarterly Run Rate: $24.4M annually</code></pre>
</div>
</div>
<img data-src="Week08-lecture-slides_files/figure-revealjs/cell-7-output-2.png" class="r-stretch"></section>
<section class="slide level2">

</section></section>
<section>
<section id="part-4-multi-plot-dashboards" class="title-slide slide level1 smaller center">
<h1>Part 4: Multi-Plot Dashboards</h1>

</section>
<section id="comprehensive-business-dashboard" class="slide level2">
<h2>Comprehensive Business Dashboard</h2>
<div id="4b01a8fd" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href=""></a><span class="co"># Create a comprehensive business intelligence dashboard</span></span>
<span id="cb19-2"><a href=""></a><span class="bu">print</span>(<span class="st">"COMPREHENSIVE BUSINESS DASHBOARD"</span>)</span>
<span id="cb19-3"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">40</span>)</span>
<span id="cb19-4"><a href=""></a></span>
<span id="cb19-5"><a href=""></a><span class="co"># Generate comprehensive business data</span></span>
<span id="cb19-6"><a href=""></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb19-7"><a href=""></a>regions <span class="op">=</span> [<span class="st">'North America'</span>, <span class="st">'Europe'</span>, <span class="st">'Asia-Pacific'</span>, <span class="st">'Latin America'</span>]</span>
<span id="cb19-8"><a href=""></a>products <span class="op">=</span> [<span class="st">'Enterprise Software'</span>, <span class="st">'Cloud Services'</span>, <span class="st">'Consulting'</span>, <span class="st">'Support'</span>]</span>
<span id="cb19-9"><a href=""></a>months <span class="op">=</span> [<span class="st">'Jan'</span>, <span class="st">'Feb'</span>, <span class="st">'Mar'</span>, <span class="st">'Apr'</span>, <span class="st">'May'</span>, <span class="st">'Jun'</span>]</span>
<span id="cb19-10"><a href=""></a></span>
<span id="cb19-11"><a href=""></a><span class="co"># Sales data by region and month</span></span>
<span id="cb19-12"><a href=""></a>sales_data <span class="op">=</span> np.random.uniform(<span class="dv">100000</span>, <span class="dv">1000000</span>, (<span class="bu">len</span>(regions), <span class="bu">len</span>(months)))</span>
<span id="cb19-13"><a href=""></a>sales_data <span class="op">=</span> pd.DataFrame(sales_data, index<span class="op">=</span>regions, columns<span class="op">=</span>months)</span>
<span id="cb19-14"><a href=""></a></span>
<span id="cb19-15"><a href=""></a><span class="co"># Product performance data</span></span>
<span id="cb19-16"><a href=""></a>product_revenue <span class="op">=</span> [<span class="dv">2500000</span>, <span class="dv">1800000</span>, <span class="dv">1200000</span>, <span class="dv">800000</span>]</span>
<span id="cb19-17"><a href=""></a>product_margin <span class="op">=</span> [<span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">45</span>, <span class="dv">20</span>]  <span class="co"># Profit margins</span></span>
<span id="cb19-18"><a href=""></a>product_growth <span class="op">=</span> [<span class="dv">15</span>, <span class="dv">28</span>, <span class="op">-</span><span class="dv">5</span>, <span class="dv">12</span>]  <span class="co"># YoY growth</span></span>
<span id="cb19-19"><a href=""></a></span>
<span id="cb19-20"><a href=""></a><span class="co"># Customer satisfaction by region</span></span>
<span id="cb19-21"><a href=""></a>satisfaction_scores <span class="op">=</span> [<span class="fl">4.2</span>, <span class="fl">3.8</span>, <span class="fl">4.5</span>, <span class="fl">3.9</span>]</span>
<span id="cb19-22"><a href=""></a></span>
<span id="cb19-23"><a href=""></a><span class="co"># Create the dashboard</span></span>
<span id="cb19-24"><a href=""></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">14</span>))</span>
<span id="cb19-25"><a href=""></a>gs <span class="op">=</span> fig.add_gridspec(<span class="dv">3</span>, <span class="dv">3</span>, hspace<span class="op">=</span><span class="fl">0.3</span>, wspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb19-26"><a href=""></a></span>
<span id="cb19-27"><a href=""></a><span class="co"># Color scheme</span></span>
<span id="cb19-28"><a href=""></a>colors <span class="op">=</span> [<span class="st">'#1f77b4'</span>, <span class="st">'#ff7f0e'</span>, <span class="st">'#2ca02c'</span>, <span class="st">'#d62728'</span>, <span class="st">'#9467bd'</span>, <span class="st">'#8c564b'</span>]</span>
<span id="cb19-29"><a href=""></a></span>
<span id="cb19-30"><a href=""></a><span class="co"># 1. Regional Sales Heatmap (Top Left)</span></span>
<span id="cb19-31"><a href=""></a>ax1 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb19-32"><a href=""></a>im <span class="op">=</span> ax1.imshow(sales_data.values, cmap<span class="op">=</span><span class="st">'YlOrRd'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb19-33"><a href=""></a></span>
<span id="cb19-34"><a href=""></a><span class="co"># Add text annotations</span></span>
<span id="cb19-35"><a href=""></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(regions)):</span>
<span id="cb19-36"><a href=""></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(months)):</span>
<span id="cb19-37"><a href=""></a>        text <span class="op">=</span> ax1.text(j, i, <span class="ss">f'$</span><span class="sc">{</span>sales_data<span class="sc">.</span>iloc[i, j]<span class="op">/</span><span class="dv">1000</span><span class="sc">:.0f}</span><span class="ss">K'</span>,</span>
<span id="cb19-38"><a href=""></a>                       ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"center"</span>, color<span class="op">=</span><span class="st">"black"</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb19-39"><a href=""></a></span>
<span id="cb19-40"><a href=""></a>ax1.set_xticks(np.arange(<span class="bu">len</span>(months)))</span>
<span id="cb19-41"><a href=""></a>ax1.set_yticks(np.arange(<span class="bu">len</span>(regions)))</span>
<span id="cb19-42"><a href=""></a>ax1.set_xticklabels(months)</span>
<span id="cb19-43"><a href=""></a>ax1.set_yticklabels(regions)</span>
<span id="cb19-44"><a href=""></a>ax1.set_title(<span class="st">'Regional Sales Performance ($000s)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb19-45"><a href=""></a></span>
<span id="cb19-46"><a href=""></a><span class="co"># Add colorbar</span></span>
<span id="cb19-47"><a href=""></a>cbar <span class="op">=</span> plt.colorbar(im, ax<span class="op">=</span>ax1, shrink<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb19-48"><a href=""></a>cbar.set_label(<span class="st">'Sales Revenue'</span>, rotation<span class="op">=</span><span class="dv">270</span>, labelpad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb19-49"><a href=""></a></span>
<span id="cb19-50"><a href=""></a><span class="co"># 2. Product Portfolio Analysis (Top Middle)</span></span>
<span id="cb19-51"><a href=""></a>ax2 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb19-52"><a href=""></a></span>
<span id="cb19-53"><a href=""></a><span class="co"># Create bubble chart: Revenue vs Margin, sized by Growth</span></span>
<span id="cb19-54"><a href=""></a>sizes <span class="op">=</span> [(g <span class="op">+</span> <span class="dv">20</span>) <span class="op">*</span> <span class="dv">10</span> <span class="cf">for</span> g <span class="kw">in</span> product_growth]  <span class="co"># Ensure positive sizes</span></span>
<span id="cb19-55"><a href=""></a>colors_products <span class="op">=</span> [<span class="st">'red'</span> <span class="cf">if</span> g <span class="op">&lt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">'orange'</span> <span class="cf">if</span> g <span class="op">&lt;</span> <span class="dv">10</span> <span class="cf">else</span> <span class="st">'green'</span> <span class="cf">for</span> g <span class="kw">in</span> product_growth]</span>
<span id="cb19-56"><a href=""></a></span>
<span id="cb19-57"><a href=""></a>scatter <span class="op">=</span> ax2.scatter(product_margin, product_revenue, s<span class="op">=</span>sizes, c<span class="op">=</span>colors_products, </span>
<span id="cb19-58"><a href=""></a>                     alpha<span class="op">=</span><span class="fl">0.6</span>, edgecolors<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb19-59"><a href=""></a></span>
<span id="cb19-60"><a href=""></a><span class="co"># Add product labels</span></span>
<span id="cb19-61"><a href=""></a><span class="cf">for</span> i, product <span class="kw">in</span> <span class="bu">enumerate</span>(products):</span>
<span id="cb19-62"><a href=""></a>    ax2.annotate(product, (product_margin[i], product_revenue[i]), </span>
<span id="cb19-63"><a href=""></a>                xytext<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">5</span>), textcoords<span class="op">=</span><span class="st">'offset points'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb19-64"><a href=""></a></span>
<span id="cb19-65"><a href=""></a>ax2.set_xlabel(<span class="st">'Profit Margin (%)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb19-66"><a href=""></a>ax2.set_ylabel(<span class="st">'Revenue ($)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb19-67"><a href=""></a>ax2.set_title(<span class="st">'Product Portfolio Matrix</span><span class="ch">\n</span><span class="st">(Size = Growth Rate)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb19-68"><a href=""></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb19-69"><a href=""></a>ax2.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M'</span>))</span>
<span id="cb19-70"><a href=""></a></span>
<span id="cb19-71"><a href=""></a><span class="co"># Add quadrant lines</span></span>
<span id="cb19-72"><a href=""></a>ax2.axhline(y<span class="op">=</span>np.mean(product_revenue), color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb19-73"><a href=""></a>ax2.axvline(x<span class="op">=</span>np.mean(product_margin), color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb19-74"><a href=""></a></span>
<span id="cb19-75"><a href=""></a><span class="co"># 3. Customer Satisfaction by Region (Top Right)</span></span>
<span id="cb19-76"><a href=""></a>ax3 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">2</span>])</span>
<span id="cb19-77"><a href=""></a></span>
<span id="cb19-78"><a href=""></a>bars <span class="op">=</span> ax3.bar(regions, satisfaction_scores, color<span class="op">=</span>[<span class="st">'green'</span> <span class="cf">if</span> s <span class="op">&gt;=</span> <span class="fl">4.0</span> <span class="cf">else</span> <span class="st">'orange'</span> <span class="cf">if</span> s <span class="op">&gt;=</span> <span class="fl">3.5</span> <span class="cf">else</span> <span class="st">'red'</span> </span>
<span id="cb19-79"><a href=""></a>                                                   <span class="cf">for</span> s <span class="kw">in</span> satisfaction_scores], alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb19-80"><a href=""></a></span>
<span id="cb19-81"><a href=""></a><span class="co"># Add value labels</span></span>
<span id="cb19-82"><a href=""></a><span class="cf">for</span> bar, score <span class="kw">in</span> <span class="bu">zip</span>(bars, satisfaction_scores):</span>
<span id="cb19-83"><a href=""></a>    height <span class="op">=</span> bar.get_height()</span>
<span id="cb19-84"><a href=""></a>    ax3.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="fl">2.</span>, height <span class="op">+</span> <span class="fl">0.05</span>,</span>
<span id="cb19-85"><a href=""></a>             <span class="ss">f'</span><span class="sc">{</span>score<span class="sc">:.1f}</span><span class="ss">'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb19-86"><a href=""></a></span>
<span id="cb19-87"><a href=""></a>ax3.set_ylabel(<span class="st">'Satisfaction Score'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb19-88"><a href=""></a>ax3.set_title(<span class="st">'Customer Satisfaction by Region'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb19-89"><a href=""></a>ax3.set_ylim(<span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb19-90"><a href=""></a>ax3.axhline(y<span class="op">=</span><span class="fl">4.0</span>, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Target: 4.0'</span>)</span>
<span id="cb19-91"><a href=""></a>ax3.legend()</span>
<span id="cb19-92"><a href=""></a>plt.setp(ax3.xaxis.get_majorticklabels(), rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb19-93"><a href=""></a></span>
<span id="cb19-94"><a href=""></a><span class="co"># 4. Monthly Sales Trend (Middle Left - spanning 2 columns)</span></span>
<span id="cb19-95"><a href=""></a>ax4 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>, :<span class="dv">2</span>])</span>
<span id="cb19-96"><a href=""></a></span>
<span id="cb19-97"><a href=""></a>monthly_totals <span class="op">=</span> sales_data.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb19-98"><a href=""></a>cumulative_sales <span class="op">=</span> monthly_totals.cumsum()</span>
<span id="cb19-99"><a href=""></a></span>
<span id="cb19-100"><a href=""></a><span class="co"># Create combination chart</span></span>
<span id="cb19-101"><a href=""></a>ax4_twin <span class="op">=</span> ax4.twinx()</span>
<span id="cb19-102"><a href=""></a></span>
<span id="cb19-103"><a href=""></a><span class="co"># Bar chart for monthly sales</span></span>
<span id="cb19-104"><a href=""></a>bars <span class="op">=</span> ax4.bar(months, monthly_totals, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'steelblue'</span>, label<span class="op">=</span><span class="st">'Monthly Sales'</span>)</span>
<span id="cb19-105"><a href=""></a></span>
<span id="cb19-106"><a href=""></a><span class="co"># Line chart for cumulative sales</span></span>
<span id="cb19-107"><a href=""></a>line <span class="op">=</span> ax4_twin.plot(months, cumulative_sales, color<span class="op">=</span><span class="st">'red'</span>, marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="dv">3</span>, </span>
<span id="cb19-108"><a href=""></a>                     markersize<span class="op">=</span><span class="dv">8</span>, label<span class="op">=</span><span class="st">'Cumulative Sales'</span>)</span>
<span id="cb19-109"><a href=""></a></span>
<span id="cb19-110"><a href=""></a>ax4.set_ylabel(<span class="st">'Monthly Sales ($)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'steelblue'</span>)</span>
<span id="cb19-111"><a href=""></a>ax4_twin.set_ylabel(<span class="st">'Cumulative Sales ($)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb19-112"><a href=""></a>ax4.set_title(<span class="st">'Monthly Sales Performance &amp; Cumulative Growth'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb19-113"><a href=""></a></span>
<span id="cb19-114"><a href=""></a><span class="co"># Format axes</span></span>
<span id="cb19-115"><a href=""></a>ax4.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M'</span>))</span>
<span id="cb19-116"><a href=""></a>ax4_twin.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M'</span>))</span>
<span id="cb19-117"><a href=""></a></span>
<span id="cb19-118"><a href=""></a><span class="co"># Add grid and legends</span></span>
<span id="cb19-119"><a href=""></a>ax4.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb19-120"><a href=""></a>ax4.legend(loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb19-121"><a href=""></a>ax4_twin.legend(loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb19-122"><a href=""></a></span>
<span id="cb19-123"><a href=""></a><span class="co"># 5. Regional Distribution (Middle Right)</span></span>
<span id="cb19-124"><a href=""></a>ax5 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb19-125"><a href=""></a></span>
<span id="cb19-126"><a href=""></a>regional_totals <span class="op">=</span> sales_data.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb19-127"><a href=""></a>wedges, texts, autotexts <span class="op">=</span> ax5.pie(regional_totals, labels<span class="op">=</span>regions, autopct<span class="op">=</span><span class="st">'</span><span class="sc">%1.1f%%</span><span class="st">'</span>, </span>
<span id="cb19-128"><a href=""></a>                                  startangle<span class="op">=</span><span class="dv">90</span>, colors<span class="op">=</span>colors[:<span class="bu">len</span>(regions)])</span>
<span id="cb19-129"><a href=""></a></span>
<span id="cb19-130"><a href=""></a><span class="co"># Enhance text</span></span>
<span id="cb19-131"><a href=""></a><span class="cf">for</span> autotext <span class="kw">in</span> autotexts:</span>
<span id="cb19-132"><a href=""></a>    autotext.set_color(<span class="st">'white'</span>)</span>
<span id="cb19-133"><a href=""></a>    autotext.set_fontweight(<span class="st">'bold'</span>)</span>
<span id="cb19-134"><a href=""></a></span>
<span id="cb19-135"><a href=""></a>ax5.set_title(<span class="st">'Sales Distribution by Region'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb19-136"><a href=""></a></span>
<span id="cb19-137"><a href=""></a><span class="co"># 6. Performance Metrics Summary (Bottom - spanning all columns)</span></span>
<span id="cb19-138"><a href=""></a>ax6 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">2</span>, :])</span>
<span id="cb19-139"><a href=""></a></span>
<span id="cb19-140"><a href=""></a><span class="co"># Create metrics summary table</span></span>
<span id="cb19-141"><a href=""></a>metrics <span class="op">=</span> {</span>
<span id="cb19-142"><a href=""></a>    <span class="st">'Total Revenue'</span>: <span class="ss">f"$</span><span class="sc">{</span>sales_data<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">.</span><span class="bu">sum</span>()<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M"</span>,</span>
<span id="cb19-143"><a href=""></a>    <span class="st">'Best Region'</span>: <span class="ss">f"</span><span class="sc">{</span>regional_totals<span class="sc">.</span>idxmax()<span class="sc">}</span><span class="ss"> ($</span><span class="sc">{</span>regional_totals<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M)"</span>,</span>
<span id="cb19-144"><a href=""></a>    <span class="st">'Best Month'</span>: <span class="ss">f"</span><span class="sc">{</span>monthly_totals<span class="sc">.</span>idxmax()<span class="sc">}</span><span class="ss"> ($</span><span class="sc">{</span>monthly_totals<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M)"</span>,</span>
<span id="cb19-145"><a href=""></a>    <span class="st">'Avg Satisfaction'</span>: <span class="ss">f"</span><span class="sc">{</span>np<span class="sc">.</span>mean(satisfaction_scores)<span class="sc">:.2f}</span><span class="ss">/5.0"</span>,</span>
<span id="cb19-146"><a href=""></a>    <span class="st">'Top Product'</span>: <span class="ss">f"</span><span class="sc">{</span>products[np.argmax(product_revenue)]<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb19-147"><a href=""></a>    <span class="st">'Growth Leader'</span>: <span class="ss">f"</span><span class="sc">{</span>products[np.argmax(product_growth)]<span class="sc">}</span><span class="ss"> (+</span><span class="sc">{</span><span class="bu">max</span>(product_growth)<span class="sc">:.1f}</span><span class="ss">%)"</span></span>
<span id="cb19-148"><a href=""></a>}</span>
<span id="cb19-149"><a href=""></a></span>
<span id="cb19-150"><a href=""></a><span class="co"># Create a text-based summary</span></span>
<span id="cb19-151"><a href=""></a>summary_text <span class="op">=</span> <span class="st">"KEY PERFORMANCE INDICATORS</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">50</span> <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb19-152"><a href=""></a><span class="cf">for</span> i, (metric, value) <span class="kw">in</span> <span class="bu">enumerate</span>(metrics.items()):</span>
<span id="cb19-153"><a href=""></a>    <span class="cf">if</span> i <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb19-154"><a href=""></a>        summary_text <span class="op">+=</span> <span class="ss">f"</span><span class="sc">{</span>metric<span class="sc">:&lt;20}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">:&lt;20}</span><span class="ss">"</span></span>
<span id="cb19-155"><a href=""></a>    <span class="cf">else</span>:</span>
<span id="cb19-156"><a href=""></a>        summary_text <span class="op">+=</span> <span class="ss">f"</span><span class="sc">{</span>metric<span class="sc">:&lt;20}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb19-157"><a href=""></a></span>
<span id="cb19-158"><a href=""></a>ax6.text(<span class="fl">0.05</span>, <span class="fl">0.8</span>, summary_text, fontsize<span class="op">=</span><span class="dv">12</span>, fontfamily<span class="op">=</span><span class="st">'monospace'</span>, </span>
<span id="cb19-159"><a href=""></a>         transform<span class="op">=</span>ax6.transAxes, verticalalignment<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb19-160"><a href=""></a>         bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'lightblue'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb19-161"><a href=""></a></span>
<span id="cb19-162"><a href=""></a><span class="co"># Add trend indicators</span></span>
<span id="cb19-163"><a href=""></a>trend_text <span class="op">=</span> <span class="st">"TREND ANALYSIS</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">20</span> <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb19-164"><a href=""></a>revenue_trend <span class="op">=</span> ((monthly_totals.iloc[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> monthly_totals.iloc[<span class="dv">0</span>]) <span class="op">/</span> monthly_totals.iloc[<span class="dv">0</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb19-165"><a href=""></a>trend_text <span class="op">+=</span> <span class="ss">f"Monthly Growth: </span><span class="sc">{</span>revenue_trend<span class="sc">:+.1f}</span><span class="ss">%</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb19-166"><a href=""></a>trend_text <span class="op">+=</span> <span class="ss">f"Revenue Momentum: </span><span class="sc">{</span><span class="st">'📈 Positive'</span> <span class="cf">if</span> revenue_trend <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">'📉 Negative'</span><span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb19-167"><a href=""></a>trend_text <span class="op">+=</span> <span class="ss">f"Q2 Projection: $</span><span class="sc">{</span>monthly_totals<span class="sc">.</span>iloc[<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> <span class="dv">3</span> <span class="op">/</span> <span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M"</span></span>
<span id="cb19-168"><a href=""></a></span>
<span id="cb19-169"><a href=""></a>ax6.text(<span class="fl">0.55</span>, <span class="fl">0.8</span>, trend_text, fontsize<span class="op">=</span><span class="dv">12</span>, fontfamily<span class="op">=</span><span class="st">'monospace'</span>,</span>
<span id="cb19-170"><a href=""></a>         transform<span class="op">=</span>ax6.transAxes, verticalalignment<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb19-171"><a href=""></a>         bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'lightgreen'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb19-172"><a href=""></a></span>
<span id="cb19-173"><a href=""></a>ax6.set_xlim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb19-174"><a href=""></a>ax6.set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb19-175"><a href=""></a>ax6.axis(<span class="st">'off'</span>)</span>
<span id="cb19-176"><a href=""></a></span>
<span id="cb19-177"><a href=""></a><span class="co"># Overall dashboard formatting</span></span>
<span id="cb19-178"><a href=""></a>fig.suptitle(<span class="st">'Executive Business Intelligence Dashboard - Q2 2024'</span>, </span>
<span id="cb19-179"><a href=""></a>             fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">0.97</span>)</span>
<span id="cb19-180"><a href=""></a></span>
<span id="cb19-181"><a href=""></a><span class="co"># Add timestamp</span></span>
<span id="cb19-182"><a href=""></a>fig.text(<span class="fl">0.99</span>, <span class="fl">0.01</span>, <span class="ss">f'Generated: </span><span class="sc">{</span>pd<span class="sc">.</span>Timestamp<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M"</span>)<span class="sc">}</span><span class="ss">'</span>, </span>
<span id="cb19-183"><a href=""></a>         ha<span class="op">=</span><span class="st">'right'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, style<span class="op">=</span><span class="st">'italic'</span>)</span>
<span id="cb19-184"><a href=""></a></span>
<span id="cb19-185"><a href=""></a>plt.show()</span>
<span id="cb19-186"><a href=""></a></span>
<span id="cb19-187"><a href=""></a><span class="bu">print</span>(<span class="st">"Dashboard Analysis Complete:"</span>)</span>
<span id="cb19-188"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Total Revenue Analyzed: $</span><span class="sc">{</span>sales_data<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">.</span><span class="bu">sum</span>()<span class="op">/</span><span class="dv">1000000</span><span class="sc">:.1f}</span><span class="ss">M"</span>)</span>
<span id="cb19-189"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Regions Covered: </span><span class="sc">{</span><span class="bu">len</span>(regions)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-190"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Products Analyzed: </span><span class="sc">{</span><span class="bu">len</span>(products)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-191"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Time Period: </span><span class="sc">{</span><span class="bu">len</span>(months)<span class="sc">}</span><span class="ss"> months"</span>)</span>
<span id="cb19-192"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Best Performing Region: </span><span class="sc">{</span>regional_totals<span class="sc">.</span>idxmax()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-193"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Strongest Growth Product: </span><span class="sc">{</span>products[np.argmax(product_growth)]<span class="sc">}</span><span class="ss"> (+</span><span class="sc">{</span><span class="bu">max</span>(product_growth)<span class="sc">:.1f}</span><span class="ss">%)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>COMPREHENSIVE BUSINESS DASHBOARD
========================================</code></pre>
</div>

<div class="cell-output cell-output-stdout">
<pre><code>Dashboard Analysis Complete:
  Total Revenue Analyzed: $11.9M
  Regions Covered: 4
  Products Analyzed: 4
  Time Period: 6 months
  Best Performing Region: Europe
  Strongest Growth Product: Cloud Services (+28.0%)</code></pre>
</div>
</div>
<img data-src="Week08-lecture-slides_files/figure-revealjs/cell-8-output-2.png" class="r-stretch"></section>
<section class="slide level2">

</section></section>
<section>
<section id="part-5-integration-with-pandas" class="title-slide slide level1 smaller center">
<h1>Part 5: Integration with Pandas</h1>

</section>
<section id="direct-dataframe-plotting" class="slide level2">
<h2>Direct DataFrame Plotting</h2>
<div id="4caf8006" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href=""></a><span class="co"># Create comprehensive business dataset</span></span>
<span id="cb22-2"><a href=""></a>business_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb22-3"><a href=""></a>    <span class="st">'Date'</span>: pd.date_range(<span class="st">'2024-01-01'</span>, periods<span class="op">=</span><span class="dv">180</span>, freq<span class="op">=</span><span class="st">'D'</span>),</span>
<span id="cb22-4"><a href=""></a>    <span class="st">'Revenue'</span>: np.random.normal(<span class="dv">50000</span>, <span class="dv">10000</span>, <span class="dv">180</span>),</span>
<span id="cb22-5"><a href=""></a>    <span class="st">'Costs'</span>: np.random.normal(<span class="dv">35000</span>, <span class="dv">7000</span>, <span class="dv">180</span>),</span>
<span id="cb22-6"><a href=""></a>    <span class="st">'Customers'</span>: np.random.poisson(<span class="dv">200</span>, <span class="dv">180</span>),</span>
<span id="cb22-7"><a href=""></a>    <span class="st">'Satisfaction'</span>: np.random.beta(<span class="dv">8</span>, <span class="dv">2</span>, <span class="dv">180</span>) <span class="op">*</span> <span class="dv">5</span>,</span>
<span id="cb22-8"><a href=""></a>    <span class="st">'Region'</span>: np.random.choice([<span class="st">'North'</span>, <span class="st">'South'</span>, <span class="st">'East'</span>, <span class="st">'West'</span>], <span class="dv">180</span>)</span>
<span id="cb22-9"><a href=""></a>})</span>
<span id="cb22-10"><a href=""></a></span>
<span id="cb22-11"><a href=""></a><span class="co"># Ensure positive values</span></span>
<span id="cb22-12"><a href=""></a>business_data[<span class="st">'Revenue'</span>] <span class="op">=</span> np.<span class="bu">abs</span>(business_data[<span class="st">'Revenue'</span>])</span>
<span id="cb22-13"><a href=""></a>business_data[<span class="st">'Costs'</span>] <span class="op">=</span> np.<span class="bu">abs</span>(business_data[<span class="st">'Costs'</span>])</span>
<span id="cb22-14"><a href=""></a>business_data[<span class="st">'Profit'</span>] <span class="op">=</span> business_data[<span class="st">'Revenue'</span>] <span class="op">-</span> business_data[<span class="st">'Costs'</span>]</span>
<span id="cb22-15"><a href=""></a>business_data[<span class="st">'Profit_Margin'</span>] <span class="op">=</span> (business_data[<span class="st">'Profit'</span>] <span class="op">/</span> business_data[<span class="st">'Revenue'</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb22-16"><a href=""></a></span>
<span id="cb22-17"><a href=""></a><span class="co"># Add time-based features</span></span>
<span id="cb22-18"><a href=""></a>business_data[<span class="st">'Month'</span>] <span class="op">=</span> business_data[<span class="st">'Date'</span>].dt.month</span>
<span id="cb22-19"><a href=""></a>business_data[<span class="st">'WeekDay'</span>] <span class="op">=</span> business_data[<span class="st">'Date'</span>].dt.day_name()</span>
<span id="cb22-20"><a href=""></a>business_data[<span class="st">'Quarter'</span>] <span class="op">=</span> business_data[<span class="st">'Date'</span>].dt.quarter</span>
<span id="cb22-21"><a href=""></a></span>
<span id="cb22-22"><a href=""></a><span class="bu">print</span>(<span class="st">"PANDAS-MATPLOTLIB INTEGRATION"</span>)</span>
<span id="cb22-23"><a href=""></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">35</span>)</span>
<span id="cb22-24"><a href=""></a></span>
<span id="cb22-25"><a href=""></a><span class="co"># Create integrated analysis dashboard</span></span>
<span id="cb22-26"><a href=""></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">12</span>))</span>
<span id="cb22-27"><a href=""></a></span>
<span id="cb22-28"><a href=""></a><span class="co"># 1. Direct DataFrame plotting - Revenue over time</span></span>
<span id="cb22-29"><a href=""></a>business_data.set_index(<span class="st">'Date'</span>)[<span class="st">'Revenue'</span>].plot(ax<span class="op">=</span>axes[<span class="dv">0</span>,<span class="dv">0</span>], color<span class="op">=</span><span class="st">'blue'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-30"><a href=""></a>business_data.set_index(<span class="st">'Date'</span>)[<span class="st">'Revenue'</span>].rolling(window<span class="op">=</span><span class="dv">7</span>).mean().plot(ax<span class="op">=</span>axes[<span class="dv">0</span>,<span class="dv">0</span>], </span>
<span id="cb22-31"><a href=""></a>                                                                        color<span class="op">=</span><span class="st">'red'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb22-32"><a href=""></a>                                                                        label<span class="op">=</span><span class="st">'7-day Moving Average'</span>)</span>
<span id="cb22-33"><a href=""></a>axes[<span class="dv">0</span>,<span class="dv">0</span>].set_title(<span class="st">'Daily Revenue Trend with Moving Average'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-34"><a href=""></a>axes[<span class="dv">0</span>,<span class="dv">0</span>].set_ylabel(<span class="st">'Revenue ($)'</span>)</span>
<span id="cb22-35"><a href=""></a>axes[<span class="dv">0</span>,<span class="dv">0</span>].legend()</span>
<span id="cb22-36"><a href=""></a>axes[<span class="dv">0</span>,<span class="dv">0</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb22-37"><a href=""></a></span>
<span id="cb22-38"><a href=""></a><span class="co"># 2. Profit margin distribution by region</span></span>
<span id="cb22-39"><a href=""></a>business_data.boxplot(column<span class="op">=</span><span class="st">'Profit_Margin'</span>, by<span class="op">=</span><span class="st">'Region'</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb22-40"><a href=""></a>axes[<span class="dv">0</span>,<span class="dv">1</span>].set_title(<span class="st">'Profit Margin Distribution by Region'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-41"><a href=""></a>axes[<span class="dv">0</span>,<span class="dv">1</span>].set_xlabel(<span class="st">'Region'</span>)</span>
<span id="cb22-42"><a href=""></a>axes[<span class="dv">0</span>,<span class="dv">1</span>].set_ylabel(<span class="st">'Profit Margin (%)'</span>)</span>
<span id="cb22-43"><a href=""></a></span>
<span id="cb22-44"><a href=""></a><span class="co"># 3. Customer satisfaction scatter with revenue</span></span>
<span id="cb22-45"><a href=""></a>business_data.plot.scatter(x<span class="op">=</span><span class="st">'Satisfaction'</span>, y<span class="op">=</span><span class="st">'Revenue'</span>, c<span class="op">=</span><span class="st">'Profit_Margin'</span>, </span>
<span id="cb22-46"><a href=""></a>                          colormap<span class="op">=</span><span class="st">'RdYlGn'</span>, s<span class="op">=</span><span class="dv">50</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>,<span class="dv">2</span>])</span>
<span id="cb22-47"><a href=""></a>axes[<span class="dv">0</span>,<span class="dv">2</span>].set_title(<span class="st">'Revenue vs Satisfaction</span><span class="ch">\n</span><span class="st">(Color = Profit Margin)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-48"><a href=""></a>axes[<span class="dv">0</span>,<span class="dv">2</span>].set_xlabel(<span class="st">'Customer Satisfaction'</span>)</span>
<span id="cb22-49"><a href=""></a>axes[<span class="dv">0</span>,<span class="dv">2</span>].set_ylabel(<span class="st">'Revenue ($)'</span>)</span>
<span id="cb22-50"><a href=""></a></span>
<span id="cb22-51"><a href=""></a><span class="co"># 4. Monthly aggregation with pandas</span></span>
<span id="cb22-52"><a href=""></a>monthly_summary <span class="op">=</span> business_data.groupby(<span class="st">'Month'</span>).agg({</span>
<span id="cb22-53"><a href=""></a>    <span class="st">'Revenue'</span>: <span class="st">'sum'</span>,</span>
<span id="cb22-54"><a href=""></a>    <span class="st">'Costs'</span>: <span class="st">'sum'</span>, </span>
<span id="cb22-55"><a href=""></a>    <span class="st">'Customers'</span>: <span class="st">'sum'</span></span>
<span id="cb22-56"><a href=""></a>}).reset_index()</span>
<span id="cb22-57"><a href=""></a></span>
<span id="cb22-58"><a href=""></a>monthly_summary.plot(x<span class="op">=</span><span class="st">'Month'</span>, y<span class="op">=</span>[<span class="st">'Revenue'</span>, <span class="st">'Costs'</span>], kind<span class="op">=</span><span class="st">'bar'</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>,<span class="dv">0</span>], </span>
<span id="cb22-59"><a href=""></a>                    color<span class="op">=</span>[<span class="st">'green'</span>, <span class="st">'red'</span>], alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb22-60"><a href=""></a>axes[<span class="dv">1</span>,<span class="dv">0</span>].set_title(<span class="st">'Monthly Revenue vs Costs'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-61"><a href=""></a>axes[<span class="dv">1</span>,<span class="dv">0</span>].set_xlabel(<span class="st">'Month'</span>)</span>
<span id="cb22-62"><a href=""></a>axes[<span class="dv">1</span>,<span class="dv">0</span>].set_ylabel(<span class="st">'Amount ($)'</span>)</span>
<span id="cb22-63"><a href=""></a>axes[<span class="dv">1</span>,<span class="dv">0</span>].legend()</span>
<span id="cb22-64"><a href=""></a>axes[<span class="dv">1</span>,<span class="dv">0</span>].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb22-65"><a href=""></a></span>
<span id="cb22-66"><a href=""></a><span class="co"># 5. Regional performance comparison</span></span>
<span id="cb22-67"><a href=""></a>regional_summary <span class="op">=</span> business_data.groupby(<span class="st">'Region'</span>).agg({</span>
<span id="cb22-68"><a href=""></a>    <span class="st">'Revenue'</span>: <span class="st">'mean'</span>,</span>
<span id="cb22-69"><a href=""></a>    <span class="st">'Profit_Margin'</span>: <span class="st">'mean'</span>,</span>
<span id="cb22-70"><a href=""></a>    <span class="st">'Satisfaction'</span>: <span class="st">'mean'</span></span>
<span id="cb22-71"><a href=""></a>}).reset_index()</span>
<span id="cb22-72"><a href=""></a></span>
<span id="cb22-73"><a href=""></a>regional_summary.plot(x<span class="op">=</span><span class="st">'Region'</span>, y<span class="op">=</span><span class="st">'Revenue'</span>, kind<span class="op">=</span><span class="st">'bar'</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>,<span class="dv">1</span>], </span>
<span id="cb22-74"><a href=""></a>                     color<span class="op">=</span><span class="st">'steelblue'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb22-75"><a href=""></a>axes[<span class="dv">1</span>,<span class="dv">1</span>].set_title(<span class="st">'Average Revenue by Region'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-76"><a href=""></a>axes[<span class="dv">1</span>,<span class="dv">1</span>].set_ylabel(<span class="st">'Average Revenue ($)'</span>)</span>
<span id="cb22-77"><a href=""></a>axes[<span class="dv">1</span>,<span class="dv">1</span>].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb22-78"><a href=""></a></span>
<span id="cb22-79"><a href=""></a><span class="co"># 6. Correlation heatmap using matplotlib</span></span>
<span id="cb22-80"><a href=""></a>numeric_data <span class="op">=</span> business_data[[<span class="st">'Revenue'</span>, <span class="st">'Costs'</span>, <span class="st">'Profit'</span>, <span class="st">'Customers'</span>, <span class="st">'Satisfaction'</span>]]</span>
<span id="cb22-81"><a href=""></a>correlation_matrix <span class="op">=</span> numeric_data.corr()</span>
<span id="cb22-82"><a href=""></a></span>
<span id="cb22-83"><a href=""></a>im <span class="op">=</span> axes[<span class="dv">1</span>,<span class="dv">2</span>].imshow(correlation_matrix, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-84"><a href=""></a>axes[<span class="dv">1</span>,<span class="dv">2</span>].set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(correlation_matrix.columns)))</span>
<span id="cb22-85"><a href=""></a>axes[<span class="dv">1</span>,<span class="dv">2</span>].set_yticks(<span class="bu">range</span>(<span class="bu">len</span>(correlation_matrix.columns)))</span>
<span id="cb22-86"><a href=""></a>axes[<span class="dv">1</span>,<span class="dv">2</span>].set_xticklabels(correlation_matrix.columns, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb22-87"><a href=""></a>axes[<span class="dv">1</span>,<span class="dv">2</span>].set_yticklabels(correlation_matrix.columns)</span>
<span id="cb22-88"><a href=""></a></span>
<span id="cb22-89"><a href=""></a><span class="co"># Add correlation values</span></span>
<span id="cb22-90"><a href=""></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(correlation_matrix.columns)):</span>
<span id="cb22-91"><a href=""></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(correlation_matrix.columns)):</span>
<span id="cb22-92"><a href=""></a>        axes[<span class="dv">1</span>,<span class="dv">2</span>].text(j, i, <span class="ss">f'</span><span class="sc">{</span>correlation_matrix<span class="sc">.</span>iloc[i, j]<span class="sc">:.2f}</span><span class="ss">'</span>,</span>
<span id="cb22-93"><a href=""></a>                      ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-94"><a href=""></a></span>
<span id="cb22-95"><a href=""></a>axes[<span class="dv">1</span>,<span class="dv">2</span>].set_title(<span class="st">'Business Metrics Correlation'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-96"><a href=""></a></span>
<span id="cb22-97"><a href=""></a><span class="co"># Add colorbar</span></span>
<span id="cb22-98"><a href=""></a>cbar <span class="op">=</span> plt.colorbar(im, ax<span class="op">=</span>axes[<span class="dv">1</span>,<span class="dv">2</span>], shrink<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb22-99"><a href=""></a>cbar.set_label(<span class="st">'Correlation Coefficient'</span>, rotation<span class="op">=</span><span class="dv">270</span>, labelpad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb22-100"><a href=""></a></span>
<span id="cb22-101"><a href=""></a>plt.tight_layout()</span>
<span id="cb22-102"><a href=""></a>plt.suptitle(<span class="st">'Integrated Pandas-Matplotlib Business Analysis'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">0.98</span>)</span>
<span id="cb22-103"><a href=""></a>plt.subplots_adjust(top<span class="op">=</span><span class="fl">0.94</span>)</span>
<span id="cb22-104"><a href=""></a>plt.show()</span>
<span id="cb22-105"><a href=""></a></span>
<span id="cb22-106"><a href=""></a><span class="co"># Advanced pandas-matplotlib integration examples</span></span>
<span id="cb22-107"><a href=""></a><span class="bu">print</span>(<span class="st">"Advanced Integration Analysis:"</span>)</span>
<span id="cb22-108"><a href=""></a></span>
<span id="cb22-109"><a href=""></a><span class="co"># Time-based analysis with resampling</span></span>
<span id="cb22-110"><a href=""></a>weekly_data <span class="op">=</span> business_data.set_index(<span class="st">'Date'</span>).resample(<span class="st">'W'</span>).agg({</span>
<span id="cb22-111"><a href=""></a>    <span class="st">'Revenue'</span>: <span class="st">'sum'</span>,</span>
<span id="cb22-112"><a href=""></a>    <span class="st">'Profit_Margin'</span>: <span class="st">'mean'</span>,</span>
<span id="cb22-113"><a href=""></a>    <span class="st">'Customers'</span>: <span class="st">'sum'</span></span>
<span id="cb22-114"><a href=""></a>})</span>
<span id="cb22-115"><a href=""></a></span>
<span id="cb22-116"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Weekly Data Points: </span><span class="sc">{</span><span class="bu">len</span>(weekly_data)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-117"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Average Weekly Revenue: $</span><span class="sc">{</span>weekly_data[<span class="st">'Revenue'</span>]<span class="sc">.</span>mean()<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb22-118"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Best Week Revenue: $</span><span class="sc">{</span>weekly_data[<span class="st">'Revenue'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb22-119"><a href=""></a></span>
<span id="cb22-120"><a href=""></a><span class="co"># Regional performance insights</span></span>
<span id="cb22-121"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Regional Performance:"</span>)</span>
<span id="cb22-122"><a href=""></a><span class="cf">for</span> region <span class="kw">in</span> regional_summary[<span class="st">'Region'</span>]:</span>
<span id="cb22-123"><a href=""></a>    region_data <span class="op">=</span> regional_summary[regional_summary[<span class="st">'Region'</span>] <span class="op">==</span> region].iloc[<span class="dv">0</span>]</span>
<span id="cb22-124"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"    </span><span class="sc">{</span>region<span class="sc">}</span><span class="ss">: $</span><span class="sc">{</span>region_data[<span class="st">'Revenue'</span>]<span class="sc">:,.0f}</span><span class="ss"> avg, "</span></span>
<span id="cb22-125"><a href=""></a>          <span class="ss">f"</span><span class="sc">{</span>region_data[<span class="st">'Profit_Margin'</span>]<span class="sc">:.1f}</span><span class="ss">% margin, "</span></span>
<span id="cb22-126"><a href=""></a>          <span class="ss">f"</span><span class="sc">{</span>region_data[<span class="st">'Satisfaction'</span>]<span class="sc">:.2f}</span><span class="ss"> satisfaction"</span>)</span>
<span id="cb22-127"><a href=""></a></span>
<span id="cb22-128"><a href=""></a><span class="co"># Correlation insights</span></span>
<span id="cb22-129"><a href=""></a>strongest_correlation <span class="op">=</span> correlation_matrix.<span class="bu">abs</span>().unstack().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb22-130"><a href=""></a>strongest_correlation <span class="op">=</span> strongest_correlation[strongest_correlation <span class="op">&lt;</span> <span class="fl">1.0</span>]  <span class="co"># Remove self-correlations</span></span>
<span id="cb22-131"><a href=""></a></span>
<span id="cb22-132"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Strongest Business Correlation: </span><span class="sc">{</span>strongest_correlation<span class="sc">.</span>index[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>strongest_correlation<span class="sc">.</span>iloc[<span class="dv">0</span>]<span class="sc">:.3f}</span><span class="ss">)"</span>)</span>
<span id="cb22-133"><a href=""></a></span>
<span id="cb22-134"><a href=""></a><span class="co"># Profitability analysis</span></span>
<span id="cb22-135"><a href=""></a>profitable_days <span class="op">=</span> business_data[business_data[<span class="st">'Profit'</span>] <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb22-136"><a href=""></a>profit_rate <span class="op">=</span> <span class="bu">len</span>(profitable_days) <span class="op">/</span> <span class="bu">len</span>(business_data) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb22-137"><a href=""></a></span>
<span id="cb22-138"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Profitable Days: </span><span class="sc">{</span>profit_rate<span class="sc">:.1f}</span><span class="ss">% (</span><span class="sc">{</span><span class="bu">len</span>(profitable_days)<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span><span class="bu">len</span>(business_data)<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb22-139"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Average Daily Profit: $</span><span class="sc">{</span>business_data[<span class="st">'Profit'</span>]<span class="sc">.</span>mean()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PANDAS-MATPLOTLIB INTEGRATION
===================================</code></pre>
</div>

<div class="cell-output cell-output-stdout">
<pre><code>Advanced Integration Analysis:
  Weekly Data Points: 26
  Average Weekly Revenue: $344,335
  Best Week Revenue: $406,516
  Regional Performance:
    East: $49,483 avg, 22.7% margin, 3.88 satisfaction
    North: $49,010 avg, 25.8% margin, 3.92 satisfaction
    South: $48,458 avg, 23.1% margin, 3.95 satisfaction
    West: $51,498 avg, 28.5% margin, 3.96 satisfaction
  Strongest Business Correlation: ('Profit', 'Revenue') (0.821)
  Profitable Days: 86.7% (156/180)
  Average Daily Profit: $14,048.96</code></pre>
</div>
</div>
<img data-src="Week08-lecture-slides_files/figure-revealjs/cell-9-output-2.png" class="r-stretch"></section>
<section class="slide level2">

</section></section>
<section>
<section id="key-takeaways" class="title-slide slide level1 smaller center">
<h1>Key Takeaways</h1>

</section>
<section id="what-youve-mastered-this-week" class="slide level2 scrollable">
<h2>What You’ve Mastered This Week</h2>
<ol type="1">
<li class="fragment"><strong>Matplotlib Fundamentals</strong>: Object-oriented plotting for professional results</li>
<li class="fragment"><strong>Business Chart Types</strong>: Bar charts, scatter plots, histograms, pie charts</li>
<li class="fragment"><strong>Professional Styling</strong>: Colors, fonts, annotations, and layouts</li>
<li class="fragment"><strong>Multi-Plot Dashboards</strong>: Comprehensive business intelligence displays</li>
<li class="fragment"><strong>Pandas Integration</strong>: Seamless workflow from data analysis to visualization</li>
<li class="fragment"><strong>Business Communication</strong>: Charts that tell compelling data stories</li>
<li class="fragment"><strong>Best Practices</strong>: Professional standards for business presentations</li>
</ol>
<div class="fragment">
<h3 id="next-week-preview">Next Week Preview</h3>
<p>We’ll explore <strong>Descriptive Statistics</strong> - adding statistical rigor to your data analysis and visualizations!</p>
</div>
</section>
<section id="data-visualization-best-practices" class="slide level2 smaller">
<h2>Data Visualization Best Practices</h2>
<h3 id="professional-guidelines-for-business-charts">Professional Guidelines for Business Charts</h3>
<ul>
<li class="fragment"><strong>Know Your Audience</strong>: Tailor complexity to stakeholders</li>
<li class="fragment"><strong>Choose Appropriate Charts</strong>: Bar for comparisons, line for trends, scatter for relationships</li>
<li class="fragment"><strong>Emphasize Key Messages</strong>: Use color and annotations strategically</li>
<li class="fragment"><strong>Maintain Consistency</strong>: Standardize colors, fonts, and formatting</li>
<li class="fragment"><strong>Avoid Chart Junk</strong>: Minimize unnecessary elements</li>
<li class="fragment"><strong>Tell a Story</strong>: Guide viewers through your insights</li>
<li class="fragment"><strong>Test Accessibility</strong>: Ensure colorblind-friendly palettes</li>
<li class="fragment"><strong>Update Regularly</strong>: Keep visualizations current and relevant</li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Great visualizations don’t just show data - they reveal insights that drive business decisions!</p>
</div>
</div>
</div>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="questions" class="title-slide slide level1 center">
<h1>Questions?</h1>

</section>
<section id="resources-for-this-week" class="slide level2">
<h2>Resources for This Week</h2>
<ul>
<li><strong>TechTrends Visualization Project</strong>: Comprehensive charting assignment</li>
<li><strong>Executive Dashboard Examples</strong>: Real-world business intelligence</li>
<li><strong>Practice Problems</strong>: Chart creation and customization exercises</li>
<li><strong>Office Hours</strong>: Available for help with complex visualizations</li>
</ul>
<h3 id="coming-up">Coming Up</h3>
<ul>
<li><strong>Week 9</strong>: Descriptive Statistics with statistical visualizations</li>
<li><strong>Week 10</strong>: Inferential Statistics and hypothesis testing</li>
<li><strong>Integration</strong>: Statistics + Visualization for complete analysis</li>
</ul>
<h3 id="contact-information">Contact Information</h3>
<ul>
<li>Email: smith515@usf.edu</li>
<li>Office Hours: See Canvas for current schedule</li>
</ul>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>ISM4641 Python for Business ©️2025 Tim Smith</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Week08-lecture-slides_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Week08-lecture-slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Week08-lecture-slides_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Week08-lecture-slides_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Week08-lecture-slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Week08-lecture-slides_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="Week08-lecture-slides_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Week08-lecture-slides_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Week08-lecture-slides_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Week08-lecture-slides_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Week08-lecture-slides_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
    scrollable: true,
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

<script src="../js/reveal-scroll.js"></script>
</body></html>